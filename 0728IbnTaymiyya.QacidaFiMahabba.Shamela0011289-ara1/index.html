<html dir="rtl" lang="ar">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta http-equiv="Content-Security-Policy" https:=""/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script crossorigin="anonymous" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js"></script>
<link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" rel="stylesheet"/>
<link href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Amiri&amp;display=swap" rel="stylesheet"/>
<!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css"
        integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous"> -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css" rel="stylesheet"/>
<link crossorigin="anonymous" href="../css/stylev2.css" rel="stylesheet" type="text/css"/>
<script crossorigin="anonymous" src="../js/CollapsibleLists.js" type="application/javascript"></script>
<!-- <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/alpheios-components@latest/dist/style/style-components.min.css" /> -->
<script type="text/javascript">
</script>
</head>
<body>
<div id="loading">
<img alt="Loading..." id="loading-image" src="../img/spinner1.gif"/>
</div>
<div class="page-wrapper toggled" id="wrapper">
<div id="sidebar-wrapper">
<html><body><div class="card-header title-heading">فصول الكتاب</div><ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head0">فصل في الحب والبغض</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head1">المحبة ms002 التي أمر الله بها هي عبادته وحده</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head2">أهل الطبع المتفلسفة لايشهدون الحكمة الغائية من المخلوقات</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head3">أهل الكلام ينكرون طبائع ms013 الموجودات وما فيها من القوى والأسباب</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head4">المحبة والإرادة أصل كل دين، معاني كلمة الدين</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head5">لابد لكل طائفة من بني آدم دين يجمعهم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head6">الدين هو التعاهد والتعاقد</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head7">الدين الحق هو طاعة الله وعبادته</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head8">كل دين سوى الإسلام باطل</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head9">ذم الله التفرق والاختلاف في الكتاب والسنة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head10">يقول بعض المتفلسفة إن المقصود بالدين مجرد المصلحة الدنيوية</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head11">فصل الحب أصل كل عمل والتصديق بالمحبة هو أصل الإيمان</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head12">تأويل طوائف من المسلمين للمحبة تأويلات خاطئة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head13">تنازع الناس في لفظ العشق </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head14">منكرو لفظ العشق لهم من جهة اللفظ مأخذان ومن جهة المعنى مأخذان، المأخذ الأول من جهة اللفظ</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head15">المأخذ الثاني</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head16">المأخذ المعنوي قيل إن العشق فساد في الحب والإرادة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head17">وقيل إن العشق فساد في الإدراك والتخيل والمعرفة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head18">فصل:كل محبة وبغضة يتبعها لذة وألم، للذات ثلاثة أجناس،الأول: اللذة الحسية والثاني: اللذة الوهمية</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head19">الثالث: اللذة العقلية</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head20">شرع الله من اللذات ما فيه صلاح حال الإنسان وجعل اللذة التامة في الآخرة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head21">غلط المتفلسفة ومن اتبعهم في أمر اللذات</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head22">ضل النصارى كذلك في أمر اللذات، اليهود أعلم لكنهم غواة قساة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head23">نفصيل مقالة الفلاسفة في اللذة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head24">فصل: حب الله أصل التوحيد العملي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head25">أصل الإشراك العملي بالله الإشراك في المحبة، المؤمنون يحبون لله ويبغضون لله</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head26">محبة الله مستلزمة لمحبة ما يحبه، الذنوب تنقص من محبة الله</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head27">مراتب العشق، ذكر الله العشق في القرآن عن المشركين</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head28">المتولون لشيطان هم الذين يحبون ما يحبه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head29">عباد الله المخلصون ليس للشيطان عليهم سلطان</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head30">العشاق يتولون الشيطان ويشركون به</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head31">يوقع الشيطان العدواة بين المؤمنين بالعشق</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head32">أصل العبادة المحبة والشرك فيها أصل الشرك</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head33">الفتنة جنس تحته أنواع من الشبهات</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head34">فصل: محبة الله توجب المجاه\ة في سبيله، موادة عدو الله تنافي المحبة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head35">محبة الله ورسوله درجتين: زاجبة ومستحبة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head36">المحبة الواجبة وهب محبة المقتصدين، المحبة المستحبة وهي محبة السابقين</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head37">ترك الجهاد لعدم المحبة التامة وهو دليل النفاق</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head38">انقسام الناس إلى أربعة أقسام</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head39">العبادة تجمع كمال المحبة وكمال الذل</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head40">من أحب شسئا كما يحب الله أو عظمه كما يعظم الله فقد أشرك</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head41">الإنسان لا يفعل الحرام إلا لضعف إيمانه ومحبته </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head42">تزيين الشيطان لكثير من الناس أنواعا من الحرام ضاهوا بها الحلال</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head43">موقف المؤمن من الشرور والخيرات وما يجب عليه حيالها</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head44">بنو آدم لايمكن عيشهم إلا بالتعاقد والتحالف</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head45">التحالف يكون وفقا لشريعة منزلة أو شريعة غير منزلة أو سياسة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head46">المسلمون على شروطهم إلا شرطا أحل حراما أو حرم حلالا</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head47">فصل، المقصود الأول من كل عمل هو التنعم واللذة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head48">النعيم التام هو في الدين الحق</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head49">من الخطأ الظن بأن نعيم الدنيا لايكون إلا لأهل الكفر والفجور</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head50">المؤمن يطلب نعيم الدنيا والنعيم التام في الآخرة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head51">من الخظأ الاعتقاد أن الله ينصر الكفار في الدنيا ولا ينصر المؤمنين</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head52">الأصل الثاني: التنعم إما بالأمو الدنيوية وإما بالأمور</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head53">الدينية، </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head54">فصل</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head55">تنازع الناس فيما ينال الكافر في الدنيا من التنعم هل هو نعمة في حقه أم لا</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head56">رأي ابن تيمية</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head57">حال الإنسان عند السراء والضراء</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head58">حال المؤمن عندهما</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head59">لذات أهل البر أعظم من لذات أهل الفجور</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head60">لما خاض الناس في مسائل القدر ابتد طوائف منهم مقالات مخالفة للكتاب والسنة، بدع القدرية</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head61">بدع طائفة من أهل الإثبات</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head62">المقالة الصحيحة لأهل السنة والجماعة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head63">رفع الله الحرج عن المؤمنين</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head64">الإيمان والطاعة خير من الكفر والمعصية للعبد في الدنيا والآخرة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head65">معنى المجيء إلى الرسول صلى الله عليه وسلم بعد مماته</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head66">على المؤمن أن يحب ما أحب الله ويبغض ما أبغضه الله ويرضى بما قدره الله</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head67"></a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head68">فصل</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head69">فصل</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head70">أصل الموالاة الحب وأصل المعادة البغض</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head71">فصل، تقسيم العلم إلى فعلي وانفعالي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head72">علم الرب بأفعال عباده الصالحة والسيئة يستلزم حبه للحسنات وبغضه للسيئات</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head73">الإرادة والمحبة ينقسمان أيضا إلى فعليتين وانفعاليتين</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head74">الحب يتبع الإحساس والإحساس يكون بموجود لابمعدوم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head75">الأمور الغائبة لاتعرف ولاتحب ولا تبغض إلا بنوع من القياس والتمثيل</a>
</li>
</ul>
</body></html></div>
<div class="book body-inner" lang="ara">
<nav class="navbar navbar-expand-lg navbar-light bg-light sticky-top border-bottom" style="direction: ltr;">
<div class="mr-auto d-flex justify-content-left">
<a class="navbar-brand ms-2" href="http://www.kitab-project.org" target="_blank">
<img class="d-inline-block align-top" src="https://cdn.jsdelivr.net/gh/sohailmerchant/kitab-cdn@main/img/kitab-logo.png" width="60px"/>
</a>
</div>
<div class="navbar-nav mx-auto btn-toolbar" style="direction: rtl;">
<div class="d-flex justify-content-center">
<form class="row" id="nav-form" style="margin-bottom: 0px;">
<span class="btn col justify-content-center">ج:</span>
<select class="col form-select pull-left" id="vol-select"></select>
<span class="btn col justify-content-center">ص:</span>
<select class="col form-select pull-left" id="page-select"></select>
<button class="btn col pull-right mx-3" id="nav-submdit-btn" style="width: 100px;" type="submit" value="Go">Go</button>
</form>
</div>
</div>
<div class="btn-toolbar navbar-nav ml-auto d-flex justify-content-right">
<div class="btn-group">
<a class="nav-link pull-right" title="Go to top">
<i class="btn bi bi-arrow-up-circle" id="back-to-top"></i>
</a>
<a class="nav-link pull-right" title="Increase fonts">
<i class="btn bi bi-fonts font-default pull-left"></i>
</a>
<a class="nav-link pull-right" title="Turn light off">
<i class="btn bi bi-lightbulb-off"></i>
</a>
<div class="nav-link pull-right dropdown">
<a aria-expanded="false" aria-haspopup="true" class="" data-bs-toggle="dropdown" id="dropdownMenuButton" role="button" title="Book Metadata">
<i class="btn bi bi-info"></i>
</a>
<div aria-labelledby="dropdownMenuButton" class="dropdown-menu">
<div class="col-12" id="metadata-content"><label>char_length: 148787</label><label>author_lat_full_name: </label><label>author_lat_shuhra: </label><label>author_from_uri: Ibn Taymiyya</label><label>tags: CENT0800 :: _AKHLAQ :: _IBNTAYMIYYA :: _SULUK :: _TAZKIYA :: GAL@literature-islamic :: GAL@hanbalis :: GAL@dogmatics :: GAL@period-postmongol :: GAL@period-mamluk :: GAL@1258-1517CE :: GAL@period-decline :: GAL@theology :: GAL@egypt :: GAL@fiqh :: GAL@syria :: Shamela@كتب ابن تيمية</label><label>url: https://raw.githubusercontent.com/OpenITI/0750AH/master/data/0728IbnTaymiyya/0728IbnTaymiyya.QacidaFiMahabba/0728IbnTaymiyya.QacidaFiMahabba.Shamela0011289-ara1</label><label>tok_length: 35230</label><label>status: sec</label><label>id: Shamela0011289</label><label>ed_info: محمد رشاد سالم :: مكتبة التراث الإسلامي، القاهرة، مصر</label><label>title_lat: Qacida Fi Mahabba</label><label>title_ar: قاعدة في المحبة</label><label>book: 0728IbnTaymiyya.QacidaFiMahabba</label><label>author_lat: Ibn Taymiyya</label><label>author_ar: تقي الدين أبو العباس أحمد بن عبد الحليم بن عبد السلام بن عبد الله بن أبي القاسم بن محمد ابن تيمية الحراني الحنبلي الدمشقي (المتوفى: 728هـ)</label><label>date: 0728</label><label>versionUri: 0728IbnTaymiyya.QacidaFiMahabba.Shamela0011289-ara1</label>
</div>
</div>
</div>
<a class="nav-link pull-right" href="#menu-toggle" id="menu-toggle" title="Book Chapters">
<i class="btn bi bi-list"></i></a>
</div>
</div>
</nav>
<div class="book-body fixed pt-5">
<div class="row">
<div class="col-12">
<div class="row top-heading-panel content-outer-spacing">
</div>
</div>
<div class="col-12" id="meta">
</div>
</div>
<div class="row justify-content-md-center" id="book-main">
<div class="col-lg-8 col-sm-12" id="content">
</div>
</div>
<div class="row mt-5" id="footer">
<div class="col-md-12">
            The KITAB project is based at the Institute for the Study of Muslim Civilizations (ISMC) at Aga Khan
            University, London, and has received funding from the European Research Council (ERC) under the European
            Union's
            Horizon 2020 research and innovation programme (Grant agreement No. 772989)

          </div>
<div class="col-md-12">
<img alt="Logos" height="50" id="logos" src="../img/AKU-EU-ERC-three-logos.jpg"/>
</div>
</div>
</div>
</div>
</div>
<script>

    var pageSel = document.getElementById("page-select");
    var volSel = document.getElementById("vol-select");
    var thisVolume = "01";
    var volPages = {"01": ["000", "007", "008", "009", "010", "011", "012", "013", "014", "015", "016", "017", "018", "019", "020", "021", "022", "023", "024", "025", "026", "027", "028", "029", "030", "031", "032", "033", "034", "035", "036", "037", "038", "039", "040", "041", "042", "043", "044", "045", "046", "047", "048", "049", "050", "051", "052", "053", "054", "055", "056", "057", "058", "059", "060", "061", "062", "063", "064", "065", "066", "067", "068", "069", "070", "071", "072", "073", "074", "075", "076", "077", "078", "079", "080", "081", "082", "083", "084", "085", "086", "087", "088", "089", "090", "091", "092", "093", "094", "095", "096", "097", "098", "099", "100", "101", "102", "103", "104", "105", "106", "107", "108", "109", "110", "111", "112", "113", "114", "115", "116", "117", "118", "119", "120", "121", "122", "123", "124", "125", "126", "127", "128", "129", "130", "131", "132", "133", "134", "135", "136", "137", "138", "139", "140", "141", "142", "143", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "162", "163", "164", "165", "166", "167", "168", "169", "170", "171", "172", "173", "174", "175", "176", "177", "178", "179", "180", "181", "182", "183", "184", "185", "186", "187", "189", "190", "191", "192", "193", "194", "195", "196", "197", "198", "199", "200", "201", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214", "215"]}; /*loaded by html_builder*/

    function goToAnchor(vol, anchorId) {
      if (vol != window.thisVolume) {
        loadVolume(vol, false).then(res => {
          console.log("Volume loaded");
          console.log("Go to anchor " + anchorId);
          /*move the volume page to the element with id=anchorId*/
          /*var targetAnchor = document.getElementById(anchorId);
          targetAnchor.scrollIntoView({block: 'nearest'});  // this does not always work...
          console.log(targetAnchor);*/
          /*window.location.hash = "";
          window.location.hash = anchorId;
          window.location.hash = anchorId;
          console.log("#"+anchorId);*/
          /*//This approach does not work at all: scrolls only main window.
          var targetAnchor = $("#"+anchorId);
          //$("#content").animate(
          $("html, body").animate(
            {scrollTop: targetAnchor.offset().top},
            1000
          );*/
          /*//This approach does not work at all: scrolls only main window.
          var targetAnchor = document.getElementById(anchorId);
          var rect = targetAnchor.getBoundingClientRect();
          console.log(targetAnchor);
          console.log(rect);
          var viewHeight=Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
          window.scroll({
            top: rect.top + rect.height / 2 - viewHeight /2,
            behavior: 'smooth'
          });*/
          /*var targetAnchor = document.getElementById(anchorId);
          var contentDiv = document.getElementsByClassName("book-body")[0];
          var topPos = contentDiv.offsetTop;
          var windowSize = $(window).height();
          console.log("topPos: " + topPos);
          console.log("targetPos: " + targetAnchor.offsetTop);
          console.log("windowSize:" + windowSize)
          console.log("targetAnchor.offsetTop-windowSize/3 = " + (targetAnchor.offsetTop - topPos - windowSize / 2));
          contentDiv.scrollTop = targetAnchor.offsetTop - topPos - windowSize / 2;*/
          var targetAnchor = document.getElementById(anchorId);
          targetAnchor.scrollIntoView({"block": "start"});
        });
      } else {
        /*move the volume page to the element with id=anchorId*/
        /*var targetAnchor = document.getElementById(anchorId);
        targetAnchor.scrollIntoView({block: 'nearest'});  // this does not always work...
        console.log(targetAnchor);*/
        /*window.location.hash = "";
        window.location.hash = anchorId;
        window.location.hash = anchorId;
        console.log("#"+anchorId);*/
        /*//This approach does not work at all: scrolls only main window.
        var targetAnchor = $("#"+anchorId);
        //$("#content").animate(
        $("html, body").animate(
          {scrollTop: targetAnchor.offset().top},
          1000
        );*/
        /*//This approach does not work at all: scrolls only main window.
        var targetAnchor = document.getElementById(anchorId);
        var rect = targetAnchor.getBoundingClientRect();
        console.log(targetAnchor);
        console.log(rect);
        var viewHeight=Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
        window.scroll({
          top: rect.top + rect.height / 2 - viewHeight /2,
          behavior: 'smooth'
        });*/
        /*var targetAnchor = document.getElementById(anchorId);
        var contentDiv = document.getElementsByClassName("book-body")[0];
        var topPos = contentDiv.offsetTop;
        var windowSize = $(window).height();
        console.log("topPos: " + topPos);
        console.log("targetPos: " + targetAnchor.offsetTop);
        console.log("windowSize:" + windowSize)
        console.log("targetAnchor.offsetTop-windowSize/3 = " + (targetAnchor.offsetTop - topPos - windowSize / 2));
        contentDiv.scrollTop = targetAnchor.offsetTop - topPos - windowSize / 2;*/
        var targetAnchor = document.getElementById(anchorId);
        targetAnchor.scrollIntoView({"block": "start"});
      }
    }

    CollapsibleLists.apply();
    console.log("Applied CollapsibleLists");

    $(document).ready(function () {
      console.log("Load initial volume " + thisVolume);
      loadVolume(thisVolume).then(res => {
        console.log("Initial volume loaded");
        $('#loading').hide();
        $('#loading').fadeOut("slow");
      });
      $(window).scroll(function () {
        if ($(this).scrollTop() > 50) {
          $('#back-to-top').fadeIn();
        } else {
          $('#back-to-top').fadeOut();
        }
      });
      // scroll body to 0px on click
      $('#back-to-top').click(function () {
        $('body,html').animate({
          scrollTop: 0
        }, 400);
        return false;
      });
      $("#menu-toggle").click(function (e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled");
      });

      $(".font-default").click(function () {

        $('#wrapper').toggleClass("font-increase", "font-default");
      });

      $(".bi-lightbulb-off").click(function () {
        $('.bi-lightbulb-off').toggleClass("bi-lightbulb", "bi-lightbulb-off");
        $('.page-wrapper').toggleClass("night-mode", "");
        $('.navbar-light').toggleClass("night-mode", "");
        console.log(this);

      });
      $('.toc-item').click(function (event) {
        /*console.log('toc item clicked');*/
        event.preventDefault();
        var clickedElement = event.target;
        /*console.log(clickedElement);*/
        var href = clickedElement.getAttribute("href");
        /*console.log('href: '+href);*/
        var vol = href.substring(0, 2);
        var head = href.split('head').pop();
        var anchorId = "head" + head;
        goToAnchor(vol, anchorId);
        return false;
      });
    });

    function loadPageNumbers(vol, page) {
      /*var pageSel = document.getElementById("page-select");*/
      pageSel.innerHTML = '';
      volPages[vol].forEach(function (p, index) {
        pageSel.options[pageSel.options.length] = new Option(p, p);
      });
      if (page) {
        pageSel.value = page;
      }
    }

    function loadVolumeNumbers(vol) {
      /*var volSel = document.getElementById("vol-select");*/
      volSel.innerHTML = '';
      /*console.log(Object.keys(volPages));*/
      /*console.log(Object.keys(volPages).sort());*/

      Object.keys(volPages).sort().forEach(function (v, index) {
        /*console.log(v);*/
        volSel.options[volSel.options.length] = new Option(v, v);
      });
      volSel.value = vol;
    }

    async function loadVolume(vol) {
      /*Load volume json */
      var page = pageSel.value;
      $('#loading').show();
      console.log("loading volume " + vol);
      await $.getJSON(vol + ".json", function (json) {
        console.log(json)
        $('#content').empty().append(json["content"]);
        /*console.log("json loaded");*/
        window.thisVolume = vol;
        $('#loading').hide();
        $('#loading').fadeOut("slow");
        /*Load volume and page numbers in page-nav form:*/
        loadVolumeNumbers(vol);
        loadPageNumbers(vol, page);
        return true;
      });
    }


    function padWithZeros(number, width) {
      number = number + "";
      if (number.length >= width) {
        return number;
      } else {
        return new Array(width - number.length + 1).join("0") + number;
      }
    }
    document.getElementById("nav-form").addEventListener("submit", function (event) {
      event.preventDefault();
      /*console.log("Clicked Go");*/
      var vol = volSel.value;
      console.log("vol: " + vol);
      /*var targetPage = parseInt(pageSel.value, 10);
      if (page >= 1) {
        page = page-1; //page number is at bottom of page
      }
      var anchor = "v"+vol+"p"+padWithZeros(targetPage, 3);*/
      var targetPage = pageSel.value;
      var pages = volPages[vol];
      var index = pages.indexOf(targetPage);
      if (index > 0) {
        targetPage = pages[index-1];
      }

      console.log("targetPage: " + targetPage);
      var anchor = "v" + vol + "p" + targetPage;
      goToAnchor(vol, anchor);
      return false;
    });

    /*Adapt the page numbers list when the volume number changes:*/
    volSel.addEventListener("change", function (event) {
      var vol = this.value;
      var page = pageSel.value;
      loadPageNumbers(vol, page);
    });


  </script>
</body>
</html>
