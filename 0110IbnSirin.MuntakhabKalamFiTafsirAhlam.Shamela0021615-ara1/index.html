<html dir="rtl" lang="ar">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta http-equiv="Content-Security-Policy" https:=""/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script crossorigin="anonymous" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js"></script>
<link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" rel="stylesheet"/>
<link href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Amiri&amp;display=swap" rel="stylesheet"/>
<!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css"
        integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous"> -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css" rel="stylesheet"/>
<link crossorigin="anonymous" href="../css/stylev2.css" rel="stylesheet" type="text/css"/>
<script crossorigin="anonymous" src="../js/CollapsibleLists.js" type="application/javascript"></script>
<!-- <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/alpheios-components@latest/dist/style/style-components.min.css" /> -->
<script type="text/javascript">
</script>
</head>
<body>
<div id="loading">
<img alt="Loading..." id="loading-image" src="../img/spinner1.gif"/>
</div>
<div class="page-wrapper toggled" id="wrapper">
<div id="sidebar-wrapper">
<html><body><div class="card-header title-heading">فصول الكتاب</div><ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head0">[مقدمة عن الرؤيا]</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head1">[مقدمة الأستاذ أبو سعيد الواعظ رضي الله عنه]</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head2">(الباب الأول) في تأويل رؤيا العبد نفسه بين يدي ربه عز وجل في منامه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head3">(الباب الثاني) في رؤيا الأنبياء والمرسلين عموما ورؤيا محمد صلى الله عليه وسلم خصوصا</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head4">(الباب الثالث) في رؤية الملائكة عليهم السلام</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head5">(الباب الرابع) في رؤية الصحابة والتابعين في المنام رضي الله عنهم وأرضاهم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head6">(الباب الخامس) في تأويل سور القرآن العزيز</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head7">(الباب السادس) في تأويل رؤيا ms047 الإسلام</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head8">(الباب السابع) في تأويل السلام والمصافحة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head9">(الباب الثامن) في تأويل الرؤيا الطهارة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head10">(الباب التاسع) في تأويل رؤيا الأذان والإقامه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head11">(الباب العاشر) في تأويل رؤيا الصلاة وأركانها</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head12">الباب الحادي عشر في تأويل رؤيا المسجد والمحراب والمنارة ومجالس الذكر</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head13">الباب الثاني عشر في تأويل رؤيا الزكاة والصدقة والإطعام وزكاة الفطر</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head14">الباب الثالث عشر في تأويل الصوم والفطر</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head15">الباب الرابع عشر في تأويل رؤيا الحج والعمرة والكعبة والحجر الأسود والمقام وزمزم وما يتصل به والأضاحي والقربايات؟؟</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head16">الباب الخامس عشر في رؤيا الجهاد</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head17">الباب السادس عشر في تأويل رؤيا الموت والأموات والمقابر والأكفان وما يتصل به من البكاء والنوح وغير ذلك</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head18">الباب السابع عشر في رؤيا القيامة والحساب والميزان والصحائف والصراط وما يتصل بذلك</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head19">الباب الثامن عشر في تأويل رؤيا جهنم نعوذ بالله منها</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head20">الباب التاسع عشر في الجنة وخزنتها وحورها وقصورها وأنهارها وثمارها</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head21">الباب العشرون في تأويل رؤيا الجن والشياطين</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head22">الباب الحادي والعشرون في رؤيا الناس الشيخ منهم والشاب والفتاة والعجوز والأطفال والمعروف والمجهول</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head23">الباب الثاني والعشرون في تأويل اختلاف الإنسان وأعضائه واحدا واحدا على الترتيب</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head24">الباب الثالث والعشرون في تأويل الأشياء الخارجة من الانسان وسائر الحيوان من المياه والألبان والدماء وما يتصل بذلك من الأصوات والصفات</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head25">الباب الرابع والعشرون في أصوات الحيوانات وكلامها</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head26">الباب الخامس والعشرون في رؤيا الأمراض والأوجاع والعاهات التي تبدو على أعضاء الإنسان</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head27">الباب السادس والعشرون في المعالجات والأدوية والأشربة والحجامة والفصد</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head28">الباب السابع والعشرون في الأطعمة والحلوى واللحمان وما يتصل به من القدر والمائدة والسفرة والقصاع والمعرفة والاثفية</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head29">الباب الثامن والعشرون في مجالس الخمر وما فيها من المعازف والأواني واللعب والملاهي والعطر وما أشبه والضيافة والدعوات</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head30">الباب التاسع والعشرون في الكساوي واختلاف ألوانها وأجناسها</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head31">الباب الثلاثون في السلاطين والملوك وحشمهم وأعوانهم ومن يصحبهم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head32">الباب الحادي والثلاثون في الحرب وحالتها والأسلحة وآلتها والقتل والصلب والحبس والقيد وأشباه ذلك</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head33">الباب الثاني والثلاثون في الصناع وأصحاب الحرف والعملة والفعلة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head34">الباب الثالث والثلاثون في الخيل والدواب وسائر البهائم والأنعام</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head35">الباب الرابع والثلاثون في الوحش والسباع</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head36">الباب الخامس والثلاثون في الطيور الوحشية والأهلية والمائية وسائر ذوات الأجنحة وصيد البحر ودوابه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head37">الباب السادس والثلاثون في أدوات الصيد والشباك والفخاخ والشصوص والمصايد وقوس البندق</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head0">الباب السابع والثلاثون في الهوام والحشرات ودواب الأرض</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head1">الباب الثامن والثلاثون في تأويل السماء والهواء والليل والنهار والرياح والأمطار والسيول والخسف والزلازل والبرق والرعد وقوس قزح والوحل والشمس والقمر والكواكب والحساب والبرد والثلج والجمد</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head2">الباب التاسع والثلاثون في الأرض وجبالها وترابها وبلادها وقراها ودورها وأبنيتها وقصورها وحصونها ومرافقها ومفاوزها وسرابها ms278 ورمالها وتلالها وحماماتها وأرحيتها وأسواقها وحوانيتها وسقوفها وأبوابها وطرقها وسجونها وبيوتها وكنائسها وبيوت نيرانها ونواويسها وما</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head3">الباب الأربعون في الذهب والفضة وألوان الحلى والجواهر وسائر ما يستخرج من المعادن مثل الرصاص والنحاس والكحل والنفط والصفر والزجاج والحديد والقار وأشباهها</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head4">الباب الحادي والأربعون في البحر وأحواله والسفينة والغرق والأنهار والآبار والمياه وظروفها من الدلاء والخوابي والجرار والكيزان</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head5">الباب الثاني والأربعون في رؤيا النار وأدواتها من الزند والحطب والفحم والتنور والكانون والسراج والشمع والقنديل وما اتصل بذلك</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head6">الباب الثالث والأربعون في رؤيا الأشجار المثمرة وثمارها والأشجار التي لا تثمر وتأويل البستان والكرم والربيع.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head7">الباب الرابع والأربعون في الحبوب والزروع والرياحين والنبات والبقول والروضة والبطيخ والخيار والقثاء وأشباهها وما شاكلها</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head8">الباب الخامس والأربعون في القلم والدواة والنقش والمداد والورق والكتابة والشعر وما أشبهه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head9">الباب السادس والأربعون في الصنم وأهل الملل الزائغة والردة وما أشبه ذلك</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head10">الباب السابع والأربعون في البسط والفرش والسرادقات والفساطيط والأسرة والشراع والستور وما أشبهها</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head11">الباب الثامن والأربعون في أوقات الركبان والفرسان مثل السرج والآكاف والمركب واللجام والثغر واللبب والسوط والرحالة والحزام الزمام والصولجان والكرة والمقود والغاشية والهودج</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head12">الباب التاسع والأربعون في أثاث البيت وأدواته وأمتعته وأدوات الصناع سوى ما تضمن ذكره الأبواب المتقدمة والغزل والحبال وفتلها</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head13">الباب الخمسون في النوم والاستلقاء على القفا والانتباه ms420 والعجوز والمرأة والجارية</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head14">الباب الحادي والخمسون في العطش والشرب والري والجوع والأكل وأكل الإنسان لحم نفسه أو لحم جنسه ومضغ العلك والطبخ بالنار</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head15">الباب الثاني والخمسون في ذكر أنواع من البلايا من اليأس واليتم والوجع والكد والفزع والعثور والعبوس والعري والعزل والطرد والسرقة والسفه والذلة والخسران والخيانة والحبس والحمل الثقيل والبؤس أو الطغيان والضلالة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head16">الباب الثالث والخمسون في بعض الأضداد كالصعود والهبوط والبخل والإنفاق والهبة واللجاجة والمصالحة والكبر والتواضع والكذب والصدق والفقر والغنى والخوف والأمن والغم والفرح والجحود والإقرار والإحسان والإساءة والذنب والتوبة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head17">الباب الرابع والخمسون في النكاح وما يتصل به من المباشرة والطلاق والغيرة والسمن وشراء الجارية والزنا واللواط والجمع بين الناس بالفساد وتشبه المرأة بالرجل والتخنث ونظر الفرج</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head18">الباب الخامس والخمسون في السفر والقفز والمشي والوثوب والهرولة والقصد في المشي والغيبة في الأرض والطيران والركوب والرجوع من السفر</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head19">الباب السادس والخمسون في أنواع المعاملات الجارية بين الناس كالبيع والرهن والإجارة والشركة والوديعة والعارية والقرض والضمان والكفالة وقضاء الدين وأداء الحق والإمهال</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head20">الباب السابع والخمسون في رؤيا المنازعات والمخاصمات وما يتصل بها من البغي والبغض والتهدد والجور والحسد والخداع والخصومة والنقب والرفس والضرب والخدش والرضخ والرجم والسب والسخرية والصفع والعداوة والغيبة والغيظ والغلبة واللطم والمقارعة والمصارعة والذبح</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head21">الباب الثامن والخمسون في ذكر أنواع شتى في التأويل لايشاكل بعضها بعضا</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head22">الباب التاسع والخمسون في ذكر حكايات مسندة في رؤيا بعض الصالحين لبعض رضي الله عنهم</a>
</li>
</ul>
</body></html></div>
<div class="book body-inner" lang="ara">
<nav class="navbar navbar-expand-lg navbar-light bg-light sticky-top border-bottom" style="direction: ltr;">
<div class="mr-auto d-flex justify-content-left">
<a class="navbar-brand ms-2" href="http://www.kitab-project.org" target="_blank">
<img class="d-inline-block align-top" src="https://cdn.jsdelivr.net/gh/sohailmerchant/kitab-cdn@main/img/kitab-logo.png" width="60px"/>
</a>
</div>
<div class="navbar-nav mx-auto btn-toolbar" style="direction: rtl;">
<div class="d-flex justify-content-center">
<form class="row" id="nav-form" style="margin-bottom: 0px;">
<span class="btn col justify-content-center">ج:</span>
<select class="col form-select pull-left" id="vol-select"></select>
<span class="btn col justify-content-center">ص:</span>
<select class="col form-select pull-left" id="page-select"></select>
<button class="btn col pull-right mx-3" id="nav-submdit-btn" style="width: 100px;" type="submit" value="Go">Go</button>
</form>
</div>
</div>
<div class="btn-toolbar navbar-nav ml-auto d-flex justify-content-right">
<div class="btn-group">
<a class="nav-link pull-right" title="Go to top">
<i class="btn bi bi-arrow-up-circle" id="back-to-top"></i>
</a>
<a class="nav-link pull-right" title="Increase fonts">
<i class="btn bi bi-fonts font-default pull-left"></i>
</a>
<a class="nav-link pull-right" title="Turn light off">
<i class="btn bi bi-lightbulb-off"></i>
</a>
<div class="nav-link pull-right dropdown">
<a aria-expanded="false" aria-haspopup="true" class="" data-bs-toggle="dropdown" id="dropdownMenuButton" role="button" title="Book Metadata">
<i class="btn bi bi-info"></i>
</a>
<div aria-labelledby="dropdownMenuButton" class="dropdown-menu">
<div class="col-12" id="metadata-content"><label>char_length: 600714</label><label>author_lat_full_name: </label><label>author_lat_shuhra: </label><label>author_from_uri: Ibn Sirin</label><label>tags: CENT0100 :: CENT0200 :: _AHLAM :: _CHRONOMULTIPLE :: _MISC :: _TAFSIR :: GAL@literature-arabic :: GAL@literature-national :: GAL@writing :: GAL@prose :: Shamela@علوم أخرى</label><label>url: https://raw.githubusercontent.com/OpenITI/0125AH/master/data/0110IbnSirin/0110IbnSirin.MuntakhabKalamFiTafsirAhlam/0110IbnSirin.MuntakhabKalamFiTafsirAhlam.Shamela0021615-ara1</label><label>tok_length: 149198</label><label>status: sec</label><label>id: Shamela0021615</label><label>ed_info: شركة مكتبة ومطبعة مصطفى البابي الحلبي وأولاده</label><label>title_lat: Muntakhab Kalam Fi Tafsir Ahlam</label><label>title_ar: تفسير الأحلام = منتخب الكلام في تفسير الأحلام (مطبوع بهامش تعطير الأنام في تعبير المنام للنابلسي)</label><label>book: 0110IbnSirin.MuntakhabKalamFiTafsirAhlam</label><label>author_lat: Ibn Sirin</label><label>author_ar: ينسب لمحمد بن سيرين (المتوفى: 110هـ) ولا تصح نسبته له</label><label>date: 0110</label><label>versionUri: 0110IbnSirin.MuntakhabKalamFiTafsirAhlam.Shamela0021615-ara1</label>
</div>
</div>
</div>
<a class="nav-link pull-right" href="#menu-toggle" id="menu-toggle" title="Book Chapters">
<i class="btn bi bi-list"></i></a>
</div>
</div>
</nav>
<div class="book-body fixed pt-5">
<div class="row">
<div class="col-12">
<div class="row top-heading-panel content-outer-spacing">
</div>
</div>
<div class="col-12" id="meta">
</div>
</div>
<div class="row justify-content-md-center" id="book-main">
<div class="col-lg-8 col-sm-12" id="content">
</div>
</div>
<div class="row mt-5" id="footer">
<div class="col-md-12">
            The KITAB project is based at the Institute for the Study of Muslim Civilizations (ISMC) at Aga Khan
            University, London, and has received funding from the European Research Council (ERC) under the European
            Union's
            Horizon 2020 research and innovation programme (Grant agreement No. 772989)

          </div>
<div class="col-md-12">
<img alt="Logos" height="50" id="logos" src="../img/AKU-EU-ERC-three-logos.jpg"/>
</div>
</div>
</div>
</div>
</div>
<script>

    var pageSel = document.getElementById("page-select");
    var volSel = document.getElementById("vol-select");
    var thisVolume = "01";
    var volPages = {"01": ["000", "002", "003", "004", "005", "006", "007", "008", "009", "010", "011", "012", "013", "014", "015", "016", "017", "018", "019", "020", "021", "022", "023", "024", "025", "026", "027", "028", "029", "030", "031", "032", "033", "034", "035", "036", "037", "038", "039", "040", "041", "042", "043", "044", "045", "046", "047", "048", "049", "050", "051", "052", "053", "054", "055", "056", "057", "058", "059", "060", "061", "062", "063", "064", "065", "066", "067", "068", "069", "070", "071", "072", "073", "074", "075", "076", "077", "078", "079", "080", "081", "082", "083", "084", "085", "086", "087", "088", "089", "090", "091", "092", "093", "094", "095", "096", "097", "098", "099", "100", "101", "102", "103", "104", "105", "106", "107", "108", "109", "110", "111", "112", "113", "114", "115", "116", "117", "118", "119", "120", "121", "122", "123", "124", "125", "126", "127", "128", "129", "130", "131", "132", "133", "134", "135", "136", "137", "138", "139", "140", "141", "142", "143", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "162", "163", "164", "165", "166", "167", "168", "169", "170", "171", "172", "173", "174", "175", "176", "177", "178", "179", "180", "181", "182", "183", "184", "185", "186", "187", "188", "189", "190", "191", "192", "193", "194", "195", "196", "197", "198", "199", "200", "201", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214", "215", "216", "217", "218", "219", "220", "221", "222", "223", "224", "225", "226", "227", "228", "229", "230", "231", "232", "233", "234", "235", "236", "237", "238", "239", "240", "241", "242", "243", "244", "245", "246", "247", "248", "249", "250", "251", "252", "253", "254", "255", "256", "257", "258", "259", "260", "261", "262", "263", "264", "265", "266", "267", "268", "269", "270", "271", "272", "273", "274", "275", "276", "277", "278", "279", "280", "281", "282", "283", "284", "285", "286", "287", "288", "289", "290", "291", "292", "293", "294", "295", "296", "297", "298", "299", "300", "301", "302", "303", "304", "305", "306", "307", "308", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321", "322", "323", "324", "325", "326", "327", "328", "329", "330", "331", "332", "333", "334", "335", "336", "337", "338", "339", "340", "341", "342", "343", "344", "345", "346", "347", "348", "349", "350", "351", "352", "353", "354", "355", "356", "357", "358", "359", "360", "361", "362", "363", "364", "365", "366", "367", "368", "369", "370", "371", "372", "373", "374", "375", "376", "377", "378", "379", "380", "381", "382", "383", "384", "385", "386", "387", "388", "389", "390", "391", "392", "393", "394", "395", "396", "397", "398", "399", "400", "401", "402", "403", "404", "405", "406", "407", "408", "409", "410", "411", "412", "413", "414", "415", "416"], "02": ["002", "003", "004", "005", "006", "007", "008", "009", "010", "011", "012", "013", "014", "015", "016", "017", "018", "019", "020", "021", "022", "023", "024", "025", "026", "027", "028", "029", "030", "031", "032", "033", "034", "035", "036", "037", "038", "039", "040", "041", "042", "043", "044", "045", "046", "047", "048", "049", "050", "051", "052", "053", "054", "055", "056", "057", "058", "059", "060", "061", "062", "063", "064", "065", "066", "067", "068", "069", "070", "071", "072", "073", "074", "075", "076", "077", "078", "079", "080", "081", "082", "083", "084", "085", "086", "087", "088", "089", "090", "091", "092", "093", "094", "095", "096", "097", "098", "099", "100", "101", "102", "103", "104", "105", "106", "107", "108", "109", "110", "111", "112", "113", "114", "115", "116", "117", "118", "119", "120", "121", "122", "123", "124", "125", "126", "127", "128", "129", "130", "131", "132", "133", "134", "135", "136", "137", "138", "139", "140", "141", "142", "143", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "162", "163", "164", "165", "166", "167", "168", "169", "170", "171", "172", "173", "174", "175", "176", "177", "178", "179", "180", "181", "182", "183", "184", "185", "186", "187", "188", "189", "190", "191", "192", "193", "194", "195", "196", "197", "198", "199", "200", "201", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214", "215", "216", "217", "218", "219", "220", "221", "222", "223", "224", "225", "226", "227", "228", "229", "230", "231", "232", "233", "234", "235", "236", "237", "238", "239", "240", "241", "242", "243", "244", "245", "246", "247", "248", "249", "250", "251", "252", "253", "254", "255", "256", "257", "258", "259", "260", "261", "262", "263", "264", "265", "266", "267", "268", "269", "270", "271", "272", "273", "274", "275", "276", "277", "278", "279", "280", "281", "282", "283", "284", "285", "286", "287", "288", "289", "290", "291", "292", "293", "294", "295", "296", "297", "298", "299", "300", "301", "302", "303", "304", "305", "306", "307", "308", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321", "322", "323", "324", "325", "326", "327", "328", "329", "330", "331", "332", "333", "334", "335", "336", "337", "338", "339", "340", "341", "342", "343", "344", "345", "346", "347", "348", "349", "350", "351", "352", "353", "354", "355", "356", "357", "358", "359", "360", "361", "362", "363", "364", "365", "366", "367", "368", "369", "370", "371", "372", "373", "374", "375", "376", "377", "378", "379", "380", "381", "382", "383", "384", "385", "386", "387", "388", "389", "390", "391", "392", "393", "394", "395", "396", "397", "398", "399", "400", "401", "402", "403", "404", "405", "406", "407", "408", "409", "410", "411", "412", "413", "414", "415", "416"]}; /*loaded by html_builder*/

    function goToAnchor(vol, anchorId) {
      if (vol != window.thisVolume) {
        loadVolume(vol, false).then(res => {
          console.log("Volume loaded");
          console.log("Go to anchor " + anchorId);
          /*move the volume page to the element with id=anchorId*/
          /*var targetAnchor = document.getElementById(anchorId);
          targetAnchor.scrollIntoView({block: 'nearest'});  // this does not always work...
          console.log(targetAnchor);*/
          /*window.location.hash = "";
          window.location.hash = anchorId;
          window.location.hash = anchorId;
          console.log("#"+anchorId);*/
          /*//This approach does not work at all: scrolls only main window.
          var targetAnchor = $("#"+anchorId);
          //$("#content").animate(
          $("html, body").animate(
            {scrollTop: targetAnchor.offset().top},
            1000
          );*/
          /*//This approach does not work at all: scrolls only main window.
          var targetAnchor = document.getElementById(anchorId);
          var rect = targetAnchor.getBoundingClientRect();
          console.log(targetAnchor);
          console.log(rect);
          var viewHeight=Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
          window.scroll({
            top: rect.top + rect.height / 2 - viewHeight /2,
            behavior: 'smooth'
          });*/
          /*var targetAnchor = document.getElementById(anchorId);
          var contentDiv = document.getElementsByClassName("book-body")[0];
          var topPos = contentDiv.offsetTop;
          var windowSize = $(window).height();
          console.log("topPos: " + topPos);
          console.log("targetPos: " + targetAnchor.offsetTop);
          console.log("windowSize:" + windowSize)
          console.log("targetAnchor.offsetTop-windowSize/3 = " + (targetAnchor.offsetTop - topPos - windowSize / 2));
          contentDiv.scrollTop = targetAnchor.offsetTop - topPos - windowSize / 2;*/
          var targetAnchor = document.getElementById(anchorId);
          targetAnchor.scrollIntoView({"block": "start"});
        });
      } else {
        /*move the volume page to the element with id=anchorId*/
        /*var targetAnchor = document.getElementById(anchorId);
        targetAnchor.scrollIntoView({block: 'nearest'});  // this does not always work...
        console.log(targetAnchor);*/
        /*window.location.hash = "";
        window.location.hash = anchorId;
        window.location.hash = anchorId;
        console.log("#"+anchorId);*/
        /*//This approach does not work at all: scrolls only main window.
        var targetAnchor = $("#"+anchorId);
        //$("#content").animate(
        $("html, body").animate(
          {scrollTop: targetAnchor.offset().top},
          1000
        );*/
        /*//This approach does not work at all: scrolls only main window.
        var targetAnchor = document.getElementById(anchorId);
        var rect = targetAnchor.getBoundingClientRect();
        console.log(targetAnchor);
        console.log(rect);
        var viewHeight=Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
        window.scroll({
          top: rect.top + rect.height / 2 - viewHeight /2,
          behavior: 'smooth'
        });*/
        /*var targetAnchor = document.getElementById(anchorId);
        var contentDiv = document.getElementsByClassName("book-body")[0];
        var topPos = contentDiv.offsetTop;
        var windowSize = $(window).height();
        console.log("topPos: " + topPos);
        console.log("targetPos: " + targetAnchor.offsetTop);
        console.log("windowSize:" + windowSize)
        console.log("targetAnchor.offsetTop-windowSize/3 = " + (targetAnchor.offsetTop - topPos - windowSize / 2));
        contentDiv.scrollTop = targetAnchor.offsetTop - topPos - windowSize / 2;*/
        var targetAnchor = document.getElementById(anchorId);
        targetAnchor.scrollIntoView({"block": "start"});
      }
    }

    CollapsibleLists.apply();
    console.log("Applied CollapsibleLists");

    $(document).ready(function () {
      console.log("Load initial volume " + thisVolume);
      loadVolume(thisVolume).then(res => {
        console.log("Initial volume loaded");
        $('#loading').hide();
        $('#loading').fadeOut("slow");
      });
      $(window).scroll(function () {
        if ($(this).scrollTop() > 50) {
          $('#back-to-top').fadeIn();
        } else {
          $('#back-to-top').fadeOut();
        }
      });
      // scroll body to 0px on click
      $('#back-to-top').click(function () {
        $('body,html').animate({
          scrollTop: 0
        }, 400);
        return false;
      });
      $("#menu-toggle").click(function (e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled");
      });

      $(".font-default").click(function () {

        $('#wrapper').toggleClass("font-increase", "font-default");
      });

      $(".bi-lightbulb-off").click(function () {
        $('.bi-lightbulb-off').toggleClass("bi-lightbulb", "bi-lightbulb-off");
        $('.page-wrapper').toggleClass("night-mode", "");
        $('.navbar-light').toggleClass("night-mode", "");
        console.log(this);

      });
      $('.toc-item').click(function (event) {
        /*console.log('toc item clicked');*/
        event.preventDefault();
        var clickedElement = event.target;
        /*console.log(clickedElement);*/
        var href = clickedElement.getAttribute("href");
        /*console.log('href: '+href);*/
        var vol = href.substring(0, 2);
        var head = href.split('head').pop();
        var anchorId = "head" + head;
        goToAnchor(vol, anchorId);
        return false;
      });
    });

    function loadPageNumbers(vol, page) {
      /*var pageSel = document.getElementById("page-select");*/
      pageSel.innerHTML = '';
      volPages[vol].forEach(function (p, index) {
        pageSel.options[pageSel.options.length] = new Option(p, p);
      });
      if (page) {
        pageSel.value = page;
      }
    }

    function loadVolumeNumbers(vol) {
      /*var volSel = document.getElementById("vol-select");*/
      volSel.innerHTML = '';
      /*console.log(Object.keys(volPages));*/
      /*console.log(Object.keys(volPages).sort());*/

      Object.keys(volPages).sort().forEach(function (v, index) {
        /*console.log(v);*/
        volSel.options[volSel.options.length] = new Option(v, v);
      });
      volSel.value = vol;
    }

    async function loadVolume(vol) {
      /*Load volume json */
      var page = pageSel.value;
      $('#loading').show();
      console.log("loading volume " + vol);
      await $.getJSON(vol + ".json", function (json) {
        console.log(json)
        $('#content').empty().append(json["content"]);
        /*console.log("json loaded");*/
        window.thisVolume = vol;
        $('#loading').hide();
        $('#loading').fadeOut("slow");
        /*Load volume and page numbers in page-nav form:*/
        loadVolumeNumbers(vol);
        loadPageNumbers(vol, page);
        return true;
      });
    }


    function padWithZeros(number, width) {
      number = number + "";
      if (number.length >= width) {
        return number;
      } else {
        return new Array(width - number.length + 1).join("0") + number;
      }
    }
    document.getElementById("nav-form").addEventListener("submit", function (event) {
      event.preventDefault();
      /*console.log("Clicked Go");*/
      var vol = volSel.value;
      console.log("vol: " + vol);
      /*var targetPage = parseInt(pageSel.value, 10);
      if (page >= 1) {
        page = page-1; //page number is at bottom of page
      }
      var anchor = "v"+vol+"p"+padWithZeros(targetPage, 3);*/
      var targetPage = pageSel.value;
      var pages = volPages[vol];
      var index = pages.indexOf(targetPage);
      if (index > 0) {
        targetPage = pages[index-1];
      }

      console.log("targetPage: " + targetPage);
      var anchor = "v" + vol + "p" + targetPage;
      goToAnchor(vol, anchor);
      return false;
    });

    /*Adapt the page numbers list when the volume number changes:*/
    volSel.addEventListener("change", function (event) {
      var vol = this.value;
      var page = pageSel.value;
      loadPageNumbers(vol, page);
    });


  </script>
</body>
</html>
