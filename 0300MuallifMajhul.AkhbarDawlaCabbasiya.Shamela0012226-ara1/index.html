<html dir="rtl" lang="ar">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta http-equiv="Content-Security-Policy" https:=""/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script crossorigin="anonymous" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js"></script>
<link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" rel="stylesheet"/>
<link href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Amiri&amp;display=swap" rel="stylesheet"/>
<!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css"
        integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous"> -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css" rel="stylesheet"/>
<link crossorigin="anonymous" href="../css/stylev2.css" rel="stylesheet" type="text/css"/>
<script crossorigin="anonymous" src="../js/CollapsibleLists.js" type="application/javascript"></script>
<!-- <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/alpheios-components@latest/dist/style/style-components.min.css" /> -->
<script type="text/javascript">
</script>
</head>
<body>
<div id="loading">
<img alt="Loading..." id="loading-image" src="../img/spinner1.gif"/>
</div>
<div class="page-wrapper toggled" id="wrapper">
<div id="sidebar-wrapper">
<html><body><div class="card-header title-heading">فصول الكتاب</div><ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head0">موت العباس بن عبد المطلب [1] رضي الله عنه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head1">أخبار عبد الله بن العباس [1] ودعاء النبي صلى الله عليه وسلم له</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head2">ومن أخبار عبد الله مع النبي صلى الله عليه وسلم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head3">علم عبد الله</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head4">خبر عبد الله بن عباس يوم الحكمين</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head5">خبر عبد الله يوم الخوارج</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head6">أخبار عبد الله مع معاوية</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head7">ومن أخباره مع يزيد بن معاوية</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head8">أخبار عبد الله بن العباس مع عمرو بن العاص</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head9">ومن أخبار عبد الله بن عباس مع ابن الزبير</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head10">ولد عبد الله بن العباس</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head11">ومن أخبار عبد الله بن العباس المنثورة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head12">وصية عبد الله بن عباس عند موته [58 ب] رحمة الله عليه ورضوانه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head13">موت عبد الله بن عباس رحمه الله</a>
</li>
</ul>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head14">أخبار علي بن عبد الله بن العباس [1]</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head15">صفة علي بن عبد الله</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head16">رؤيا علي بن عبد الله</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head17">ومن أخبار علي بن عبد الله مع الوليد بن عبد الملك</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head18">ومن أخباره مع سليمان بن عبد الملك وهشام</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head19">جلالة علي بن عبد الله</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head20">جود علي بن عبد الله</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head21">صلاة علي بن عبد الله</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head22">ومما كان يتمثل به علي بن عبد الله</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head23">ولد علي بن عبد الله [4]</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head24">خبر [1] سليط بن عبد الله بن عباس مع علي بن عبد الله</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head25">ملتقطات أخبار علي بن عبد الله</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head26">أخبار علي بن عبد الله مع عبد الملك</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head27">خبر عبد الملك وخطبته الشقراء [5]</a>
</li>
</ul>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head28">أخبار محمد بن علي بن عبد الله بن العباس</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head29">صفة محمد بن علي بن عبد الله</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head30">علم وفقه محمد بن علي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head31">حلم محمد بن علي بن عبد الله</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head32">أخبار الإمامة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head33">خبر محمد بن علي مع هشام وابن رأس الجالوت [8]</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head34">أخبار محمد بن علي مع أبي هاشم عبد الله بن محمد</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head35">خبر الصحيفة الصفراء</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head36">عهد أبي هاشم إلى محمد بن علي [1]</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head37">أول ديوان شيعة بني العباس</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head38">توجيه ms122 أبي عكرمة إلى خراسان</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head39">جمع بكير الشيعة واختياره رجال الدعوة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head40">تسمية نظراء النقباء</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head41">تسمية السبعين وهم الدعاة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head42">تسمية دعاة الدعاة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head43">رجع إلى خبر بكير والبيعة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head44">خبر أبي مسلم مع محمد بن علي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head45">خبر صاحب الدين مع محمد</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head46">خبر أم الحكم بنت عبد الله بن الحارث مع محمد بن علي [1]</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head47">ملتقطات أخبار محمد بن علي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head48">خبر زيد بن علي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head49">حديث بكير مع نصر بن سيار</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head50">ولد ms142 محمد بن علي بن عبد الله</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head51">وصية محمد بن علي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head52">موت محمد بن علي</a>
</li>
</ul>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head53">أخبار إبراهيم بن محمد بن علي الإمام</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head54">خبر يحيى بن زيد</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head55">ذكر السواد</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head56">رجع الحديث إلى ذكر أبي سلمة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head57">موت أبي هاشم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head58">رجع الخبر إلى أمر خراسان والدعاة</a>
</li>
</ul>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head59">خبر ابى مسلم وابتداء أمره</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head60">وهذا خبر آخر من أخبار ms160 أبي مسلم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head61">خروج أبي سلمة إلى خراسان وأبي مسلم معه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head62">حديث سليمان بن كثير مع أبي مسلم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head63">ظهور أبي مسلم بخراسان</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head64">مراسلة نصر بن سيار أبا مسلم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head65">تدبير أبي مسلم ونصر في محاربة بعضهم بعضا</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head66">الموادعة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head67">بدء الحرب بين أبي مسلم ونصر بن سيار</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head68">فتح مرو</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head69">غلبة أبي مسلم على مرو وهرب نصر [1]</a>
</li>
</ul>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head70">مسير قحطبة بن شبيب بالجنود إلى العراق</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head71">فتح سرخس</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head72">فتح طوس</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head73">فتح نيسابور</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head74">فتح جرجان</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head75">فتح قومس</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head76">فتح طبرستان</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head77">فتح الخوار والري وموت نصر</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head78">فتح أبهر [1]</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head79">فتح همدان</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head80">حصار نهاوند</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head81">فتح قم [3]</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head82">فتح أصبهان</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head83">وقعة جابلق [9]</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head84">دخول الهاشمية نهاوند</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head85">دخول قحطبة قرماسين</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head86">فتح شهرزور [4]</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head87">شخوص ابن هبيرة إلى جلولاء</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head88">شخوص قحطبة نحو الكوفة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head89">خلع محمد بن خالد القسري</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head90">خطبة محمد بن خالد القسري</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head91">وقعة قحطبة مع أهل الشام وغرق قحطبة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head92">موت قحطبة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head93">فتح الكوفة</a>
</li>
</ul>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head94">ظهور أبي سلمة بالكوفة</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head95">خطبة أبي سلمة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head96">تولية أبي سلمة العمال</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head97">جود إبراهيم الإمام</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head98">خبر مقتل إبراهيم بن محمد الإمام</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head99">افتراق الناس بعد إبراهيم الإمام</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head100">ولد إبراهيم بن محمد</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head101">مراثي قيلت في إبراهيم الإمام</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head102">وصول وصية إبراهيم إلى أبي العباس</a>
</li>
</ul>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head103">[203 أ] تواريخ الخلفاء من بني أمية [4]</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head104">[203 ب] تواريخ الخلفاء من بني العباس رضي الله عنهم</a>
</li>
</ul>
</body></html></div>
<div class="book body-inner" lang="ara">
<nav class="navbar navbar-expand-lg navbar-light bg-light sticky-top border-bottom" style="direction: ltr;">
<div class="mr-auto d-flex justify-content-left">
<a class="navbar-brand ms-2" href="http://www.kitab-project.org" target="_blank">
<img class="d-inline-block align-top" src="https://cdn.jsdelivr.net/gh/sohailmerchant/kitab-cdn@main/img/kitab-logo.png" width="60px"/>
</a>
</div>
<div class="navbar-nav mx-auto btn-toolbar" style="direction: rtl;">
<div class="d-flex justify-content-center">
<form class="row" id="nav-form" style="margin-bottom: 0px;">
<span class="btn col justify-content-center">ج:</span>
<select class="col form-select pull-left" id="vol-select"></select>
<span class="btn col justify-content-center">ص:</span>
<select class="col form-select pull-left" id="page-select"></select>
<button class="btn col pull-right mx-3" id="nav-submdit-btn" style="width: 100px;" type="submit" value="Go">Go</button>
</form>
</div>
</div>
<div class="btn-toolbar navbar-nav ml-auto d-flex justify-content-right">
<div class="btn-group">
<a class="nav-link pull-right" title="Go to top">
<i class="btn bi bi-arrow-up-circle" id="back-to-top"></i>
</a>
<a class="nav-link pull-right" title="Increase fonts">
<i class="btn bi bi-fonts font-default pull-left"></i>
</a>
<a class="nav-link pull-right" title="Turn light off">
<i class="btn bi bi-lightbulb-off"></i>
</a>
<div class="nav-link pull-right dropdown">
<a aria-expanded="false" aria-haspopup="true" class="" data-bs-toggle="dropdown" id="dropdownMenuButton" role="button" title="Book Metadata">
<i class="btn bi bi-info"></i>
</a>
<div aria-labelledby="dropdownMenuButton" class="dropdown-menu">
<div class="col-12" id="metadata-content"><label>char_length: 309064</label><label>author_lat_full_name: </label><label>author_lat_shuhra: </label><label>author_from_uri: Muallif Majhul</label><label>tags: COMPLETED :: CENT0300 :: PPE :: _TARIKH :: GAL@nodata :: Shamela@التاريخ</label><label>url: https://raw.githubusercontent.com/OpenITI/0300AH/master/data/0300MuallifMajhul/0300MuallifMajhul.AkhbarDawlaCabbasiya/0300MuallifMajhul.AkhbarDawlaCabbasiya.Shamela0012226-ara1.completed</label><label>tok_length: 76966</label><label>status: pri</label><label>id: Shamela0012226</label><label>ed_info: عبد العزيز الدوري، عبد الجبار المطلبي :: دار الطليعة، بيروت :: http://www.worldcat.org/oclc/949611695</label><label>title_lat: Akhbar Dawla Cabbasiya</label><label>title_ar: أخبار الدولة العباسية وفيه أخبار العباس وولده</label><label>book: 0300MuallifMajhul.AkhbarDawlaCabbasiya</label><label>author_lat: Muallif Majhul</label><label>author_ar: مؤلف أخبار الدولة العباسية - مجهول (المتوفى: ق 3هـ)</label><label>date: 0300</label><label>versionUri: 0300MuallifMajhul.AkhbarDawlaCabbasiya.Shamela0012226-ara1</label>
</div>
</div>
</div>
<a class="nav-link pull-right" href="#menu-toggle" id="menu-toggle" title="Book Chapters">
<i class="btn bi bi-list"></i></a>
</div>
</div>
</nav>
<div class="book-body fixed pt-5">
<div class="row">
<div class="col-12">
<div class="row top-heading-panel content-outer-spacing">
</div>
</div>
<div class="col-12" id="meta">
</div>
</div>
<div class="row justify-content-md-center" id="book-main">
<div class="col-lg-8 col-sm-12" id="content">
</div>
</div>
<div class="row mt-5" id="footer">
<div class="col-md-12">
            The KITAB project is based at the Institute for the Study of Muslim Civilizations (ISMC) at Aga Khan
            University, London, and has received funding from the European Research Council (ERC) under the European
            Union's
            Horizon 2020 research and innovation programme (Grant agreement No. 772989)

          </div>
<div class="col-md-12">
<img alt="Logos" height="50" id="logos" src="../img/AKU-EU-ERC-three-logos.jpg"/>
</div>
</div>
</div>
</div>
</div>
<script>

    var pageSel = document.getElementById("page-select");
    var volSel = document.getElementById("vol-select");
    var thisVolume = "01";
    var volPages = {"01": ["000", "007", "008", "009", "010", "011", "012", "013", "014", "015", "016", "017", "018", "019", "020", "021", "022", "023", "024", "025", "026", "027", "028", "029", "030", "031", "032", "033", "034", "035", "036", "037", "038", "039", "040", "041", "042", "043", "044", "045", "046", "047", "048", "049", "050", "051", "052", "053", "054", "055", "056", "057", "058", "059", "060", "061", "062", "063", "064", "065", "066", "067", "068", "069", "070", "071", "072", "073", "074", "075", "076", "077", "078", "079", "080", "081", "082", "083", "084", "085", "086", "087", "088", "089", "090", "091", "092", "093", "094", "095", "096", "097", "098", "099", "100", "101", "102", "103", "104", "105", "106", "107", "108", "109", "110", "111", "112", "113", "114", "115", "116", "117", "118", "119", "120", "121", "122", "123", "124", "125", "126", "127", "128", "129", "130", "131", "132", "133", "134", "135", "136", "137", "138", "139", "140", "141", "142", "143", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "162", "163", "164", "165", "166", "167", "168", "169", "170", "171", "172", "173", "174", "175", "176", "177", "178", "179", "180", "181", "182", "183", "184", "185", "186", "187", "188", "189", "190", "191", "192", "193", "194", "195", "196", "197", "198", "199", "200", "201", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214", "215", "216", "217", "218", "219", "220", "221", "222", "223", "224", "225", "226", "227", "228", "229", "230", "231", "232", "233", "234", "235", "236", "237", "238", "239", "240", "241", "242", "243", "244", "245", "246", "247", "248", "249", "250", "251", "252", "253", "254", "255", "256", "257", "258", "259", "260", "261", "262", "263", "264", "265", "266", "267", "268", "269", "270", "271", "272", "273", "274", "275", "276", "277", "278", "279", "280", "281", "282", "283", "284", "285", "286", "287", "288", "289", "290", "291", "292", "293", "294", "295", "296", "297", "298", "299", "300", "301", "302", "303", "304", "305", "306", "307", "308", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321", "322", "323", "324", "325", "326", "327", "328", "329", "330", "331", "332", "333", "334", "335", "336", "337", "338", "339", "340", "341", "342", "343", "344", "345", "346", "347", "348", "349", "350", "351", "352", "353", "354", "355", "356", "357", "358", "359", "360", "361", "362", "363", "364", "365", "366", "367", "368", "369", "370", "371", "372", "373", "374", "375", "376", "377", "378", "379", "380", "381", "382", "383", "384", "385", "386", "387", "388", "389", "390", "391", "392", "393", "394", "395", "396", "397", "398", "399", "400", "401", "402", "403", "404", "405", "406", "407", "408", "409", "410", "411", "412", "413", "414"]}; /*loaded by html_builder*/

    function goToAnchor(vol, anchorId) {
      if (vol != window.thisVolume) {
        loadVolume(vol, false).then(res => {
          console.log("Volume loaded");
          console.log("Go to anchor " + anchorId);
          /*move the volume page to the element with id=anchorId*/
          /*var targetAnchor = document.getElementById(anchorId);
          targetAnchor.scrollIntoView({block: 'nearest'});  // this does not always work...
          console.log(targetAnchor);*/
          /*window.location.hash = "";
          window.location.hash = anchorId;
          window.location.hash = anchorId;
          console.log("#"+anchorId);*/
          /*//This approach does not work at all: scrolls only main window.
          var targetAnchor = $("#"+anchorId);
          //$("#content").animate(
          $("html, body").animate(
            {scrollTop: targetAnchor.offset().top},
            1000
          );*/
          /*//This approach does not work at all: scrolls only main window.
          var targetAnchor = document.getElementById(anchorId);
          var rect = targetAnchor.getBoundingClientRect();
          console.log(targetAnchor);
          console.log(rect);
          var viewHeight=Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
          window.scroll({
            top: rect.top + rect.height / 2 - viewHeight /2,
            behavior: 'smooth'
          });*/
          /*var targetAnchor = document.getElementById(anchorId);
          var contentDiv = document.getElementsByClassName("book-body")[0];
          var topPos = contentDiv.offsetTop;
          var windowSize = $(window).height();
          console.log("topPos: " + topPos);
          console.log("targetPos: " + targetAnchor.offsetTop);
          console.log("windowSize:" + windowSize)
          console.log("targetAnchor.offsetTop-windowSize/3 = " + (targetAnchor.offsetTop - topPos - windowSize / 2));
          contentDiv.scrollTop = targetAnchor.offsetTop - topPos - windowSize / 2;*/
          var targetAnchor = document.getElementById(anchorId);
          targetAnchor.scrollIntoView({"block": "start"});
        });
      } else {
        /*move the volume page to the element with id=anchorId*/
        /*var targetAnchor = document.getElementById(anchorId);
        targetAnchor.scrollIntoView({block: 'nearest'});  // this does not always work...
        console.log(targetAnchor);*/
        /*window.location.hash = "";
        window.location.hash = anchorId;
        window.location.hash = anchorId;
        console.log("#"+anchorId);*/
        /*//This approach does not work at all: scrolls only main window.
        var targetAnchor = $("#"+anchorId);
        //$("#content").animate(
        $("html, body").animate(
          {scrollTop: targetAnchor.offset().top},
          1000
        );*/
        /*//This approach does not work at all: scrolls only main window.
        var targetAnchor = document.getElementById(anchorId);
        var rect = targetAnchor.getBoundingClientRect();
        console.log(targetAnchor);
        console.log(rect);
        var viewHeight=Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
        window.scroll({
          top: rect.top + rect.height / 2 - viewHeight /2,
          behavior: 'smooth'
        });*/
        /*var targetAnchor = document.getElementById(anchorId);
        var contentDiv = document.getElementsByClassName("book-body")[0];
        var topPos = contentDiv.offsetTop;
        var windowSize = $(window).height();
        console.log("topPos: " + topPos);
        console.log("targetPos: " + targetAnchor.offsetTop);
        console.log("windowSize:" + windowSize)
        console.log("targetAnchor.offsetTop-windowSize/3 = " + (targetAnchor.offsetTop - topPos - windowSize / 2));
        contentDiv.scrollTop = targetAnchor.offsetTop - topPos - windowSize / 2;*/
        var targetAnchor = document.getElementById(anchorId);
        targetAnchor.scrollIntoView({"block": "start"});
      }
    }

    CollapsibleLists.apply();
    console.log("Applied CollapsibleLists");

    $(document).ready(function () {
      console.log("Load initial volume " + thisVolume);
      loadVolume(thisVolume).then(res => {
        console.log("Initial volume loaded");
        $('#loading').hide();
        $('#loading').fadeOut("slow");
      });
      $(window).scroll(function () {
        if ($(this).scrollTop() > 50) {
          $('#back-to-top').fadeIn();
        } else {
          $('#back-to-top').fadeOut();
        }
      });
      // scroll body to 0px on click
      $('#back-to-top').click(function () {
        $('body,html').animate({
          scrollTop: 0
        }, 400);
        return false;
      });
      $("#menu-toggle").click(function (e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled");
      });

      $(".font-default").click(function () {

        $('#wrapper').toggleClass("font-increase", "font-default");
      });

      $(".bi-lightbulb-off").click(function () {
        $('.bi-lightbulb-off').toggleClass("bi-lightbulb", "bi-lightbulb-off");
        $('.page-wrapper').toggleClass("night-mode", "");
        $('.navbar-light').toggleClass("night-mode", "");
        console.log(this);

      });
      $('.toc-item').click(function (event) {
        /*console.log('toc item clicked');*/
        event.preventDefault();
        var clickedElement = event.target;
        /*console.log(clickedElement);*/
        var href = clickedElement.getAttribute("href");
        /*console.log('href: '+href);*/
        var vol = href.substring(0, 2);
        var head = href.split('head').pop();
        var anchorId = "head" + head;
        goToAnchor(vol, anchorId);
        return false;
      });
    });

    function loadPageNumbers(vol, page) {
      /*var pageSel = document.getElementById("page-select");*/
      pageSel.innerHTML = '';
      volPages[vol].forEach(function (p, index) {
        pageSel.options[pageSel.options.length] = new Option(p, p);
      });
      if (page) {
        pageSel.value = page;
      }
    }

    function loadVolumeNumbers(vol) {
      /*var volSel = document.getElementById("vol-select");*/
      volSel.innerHTML = '';
      /*console.log(Object.keys(volPages));*/
      /*console.log(Object.keys(volPages).sort());*/

      Object.keys(volPages).sort().forEach(function (v, index) {
        /*console.log(v);*/
        volSel.options[volSel.options.length] = new Option(v, v);
      });
      volSel.value = vol;
    }

    async function loadVolume(vol) {
      /*Load volume json */
      var page = pageSel.value;
      $('#loading').show();
      console.log("loading volume " + vol);
      await $.getJSON(vol + ".json", function (json) {
        console.log(json)
        $('#content').empty().append(json["content"]);
        /*console.log("json loaded");*/
        window.thisVolume = vol;
        $('#loading').hide();
        $('#loading').fadeOut("slow");
        /*Load volume and page numbers in page-nav form:*/
        loadVolumeNumbers(vol);
        loadPageNumbers(vol, page);
        return true;
      });
    }


    function padWithZeros(number, width) {
      number = number + "";
      if (number.length >= width) {
        return number;
      } else {
        return new Array(width - number.length + 1).join("0") + number;
      }
    }
    document.getElementById("nav-form").addEventListener("submit", function (event) {
      event.preventDefault();
      /*console.log("Clicked Go");*/
      var vol = volSel.value;
      console.log("vol: " + vol);
      /*var targetPage = parseInt(pageSel.value, 10);
      if (page >= 1) {
        page = page-1; //page number is at bottom of page
      }
      var anchor = "v"+vol+"p"+padWithZeros(targetPage, 3);*/
      var targetPage = pageSel.value;
      var pages = volPages[vol];
      var index = pages.indexOf(targetPage);
      if (index > 0) {
        targetPage = pages[index-1];
      }

      console.log("targetPage: " + targetPage);
      var anchor = "v" + vol + "p" + targetPage;
      goToAnchor(vol, anchor);
      return false;
    });

    /*Adapt the page numbers list when the volume number changes:*/
    volSel.addEventListener("change", function (event) {
      var vol = this.value;
      var page = pageSel.value;
      loadPageNumbers(vol, page);
    });


  </script>
</body>
</html>
