<html dir="rtl" lang="ar">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta http-equiv="Content-Security-Policy" https:=""/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script crossorigin="anonymous" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js"></script>
<link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" rel="stylesheet"/>
<link href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Amiri&amp;display=swap" rel="stylesheet"/>
<!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css"
        integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous"> -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css" rel="stylesheet"/>
<link crossorigin="anonymous" href="../css/stylev2.css" rel="stylesheet" type="text/css"/>
<script crossorigin="anonymous" src="../js/CollapsibleLists.js" type="application/javascript"></script>
<!-- <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/alpheios-components@latest/dist/style/style-components.min.css" /> -->
<script type="text/javascript">
</script>
</head>
<body>
<div id="loading">
<img alt="Loading..." id="loading-image" src="../img/spinner1.gif"/>
</div>
<div class="page-wrapper toggled" id="wrapper">
<div id="sidebar-wrapper">
<html><body><div class="card-header title-heading">فصول الكتاب</div><ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head0">الفصل الأول</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head1">الفصل الثاني</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head2">الفصل الثالث</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head3">المقام الأول مقام التوكل</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head4">المقام الثاني في أن الزهد لا ينافي كون المال في اليدين</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head5">الفصل الرابع</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head6">الفصل الخامس</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head7">الفصل السادس</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head8">الفصل السابع</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head9">الفصل الثامن</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head10">الفصل التاسع</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head11">الفصل العاشر</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head12">القاضي عبد الوهاب</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head13">ابن مالك</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head14">النضر بن شميل</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head15">الاخفش الصغير</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head16">التلعفري</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head17">الترمذي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head18">يحيى بن علي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head19">الابيوردي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head20">الشنتريني</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head21">العز</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head22">السهروردي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head23">الحافظ عبد الغني</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head24">محمد بن عبد الرزاق</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head25">الخليل</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head26">أبو الطيب الطبري</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head27">أبو عثمان</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head28">المازني</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head29">السيرافي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head30">نجم الدين</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head31">الأنماطي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head32">بدر الدين بن مالك</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head33">العفيف التلمساني</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head34">الحريري</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head35">القطب الشيرازي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head36">ابن دريد</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head37">يحيى بن اكتم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head38">محمد بن علي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head39">القاضي الرفيع</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head40">البدر التستري</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head41">أبو عبيدة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head42">ابن هانئ</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head43">صاعد</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head44">ابن النحاس</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head45">أبو الحسن</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head46">التاج المراكشي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head47">العلم الاصفوني</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head48">الفخر الفارسي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head49">الشيخ خضر الكردي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head50">ابن الخشاب</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head51">ابن بري</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head52">الباجي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head53">الحافظ المزي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head54">أبو جعفر</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head55">مروان بن أبي حفصة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head56">محمد بن داود</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head57">الحسن بن سفيان</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head58">بشر بن غياث</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head59">واصل بن عطاء المعتزلي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head60">أبو حاتم الرازي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head61">سيبويه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head62">شريك</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head63">ابن يونس</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head64">أبو بكر النيسابوري</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head65">محمد شمس الدين</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head66">ابن حزم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head67">أبو الحسن</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head68">أبو حاتم السجستاني</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head69">ابن الجبان الأصفهاني</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head70">السهيلي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head71">ابن دحية الكلبي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head72">المسعودي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head73">الشاطبي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head74">القاضي الفاضل</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head75">ابن طارق</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head76">ابن بيان</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head77">ابن بصيلة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head78">شميم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head79">الجزلي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head80">التاج الكندي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head81">ياقوت</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head82">ابن معطي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head83">أبو حامد الاسفرايني</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head84">ابن عنين</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head85">ابن حموية اليزدي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head86">نفطويه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head87">إمام الأئمة ابن خزيمة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head88">أبو عمر غلام ثعلب</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head89">أبو الوقت السجزي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head90">ابن نباتة السعدي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head91">الزبيدي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head92">أبو النجيب السهر وردي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head93">الميداني</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head94">أبو العلاء الهمذاني</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head95">ابن مكتوم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head96">ابن خالويه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head97">ابن الجصاص</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head98">الأديب أبو بكر بن بقي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head99">أبو الحسن</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head100">الصولي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head101">ابن ظفر</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head102">ابن السكيت</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head103">الأديب أبو جعفر</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head104">الإمام أبو سهل الصعلوكي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head105">الغزي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head106">الفارابي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head107">الهروي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head108">ابن فارس اللغوي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head109">ابن الخياط</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head110">الحافظ أبو الفضل</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head111">ابن المنير</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head112">النفيس</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head113">أبو الصلت</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head114">مبرمان</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head115">أبو الحسن الربعي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head116">القالي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head117">البيهقي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head118">أبو سعيد الإصطرخي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head119">السيد ركن الدين</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head120">أبو هفان</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head121">الرياشي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head122">ابن بانشاذ</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head123">عبد الرحمن</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head124">الواحدي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head125">ابن البرهان</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head126">الحريري</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head127">أبو العباس</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head128">الفصل الحادي عشر</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head129">محيي الدين النواوي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head130">السهروردي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head131">والحسن بن العباس السرخسي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head132">إبراهيم بن إسحاق</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head133">ابن الأنباري</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head134">عزيزي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head135">المبارك</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head136">مالك ابن أنس</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head137">أبو الحنيفة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head138">الإمام أحمد بن حنبل</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head139">البويطي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head140">البخاري</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head141">النسائي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head142">أبو عمرو</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head143">محمد بن الزيات</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head144">ابن الدهان</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head145">ابن عطاء</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head146">ابن شنبود</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head147">ابن مقلة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head148">الفصل الثاني عشر</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head149">الفصل الثالث عشر</a>
</li>
</ul>
</body></html></div>
<div class="book body-inner" lang="ara">
<nav class="navbar navbar-expand-lg navbar-light bg-light sticky-top border-bottom" style="direction: ltr;">
<div class="mr-auto d-flex justify-content-left">
<a class="navbar-brand ms-2" href="http://www.kitab-project.org" target="_blank">
<img class="d-inline-block align-top" src="https://cdn.jsdelivr.net/gh/sohailmerchant/kitab-cdn@main/img/kitab-logo.png" width="60px"/>
</a>
</div>
<div class="navbar-nav mx-auto btn-toolbar" style="direction: rtl;">
<div class="d-flex justify-content-center">
<form class="row" id="nav-form" style="margin-bottom: 0px;">
<span class="btn col justify-content-center">ج:</span>
<select class="col form-select pull-left" id="vol-select"></select>
<span class="btn col justify-content-center">ص:</span>
<select class="col form-select pull-left" id="page-select"></select>
<button class="btn col pull-right mx-3" id="nav-submdit-btn" style="width: 100px;" type="submit" value="Go">Go</button>
</form>
</div>
</div>
<div class="btn-toolbar navbar-nav ml-auto d-flex justify-content-right">
<div class="btn-group">
<a class="nav-link pull-right" title="Go to top">
<i class="btn bi bi-arrow-up-circle" id="back-to-top"></i>
</a>
<a class="nav-link pull-right" title="Increase fonts">
<i class="btn bi bi-fonts font-default pull-left"></i>
</a>
<a class="nav-link pull-right" title="Turn light off">
<i class="btn bi bi-lightbulb-off"></i>
</a>
<div class="nav-link pull-right dropdown">
<a aria-expanded="false" aria-haspopup="true" class="" data-bs-toggle="dropdown" id="dropdownMenuButton" role="button" title="Book Metadata">
<i class="btn bi bi-info"></i>
</a>
<div aria-labelledby="dropdownMenuButton" class="dropdown-menu">
<div class="col-12" id="metadata-content"><label>char_length: 176727</label><label>author_lat_full_name: </label><label>author_lat_shuhra: </label><label>author_from_uri: Shihab Din Dalji</label><label>tags: CENT0900 :: _ADAB :: _BALAGHA :: GAL@1799-1882CE :: GAL@literature-islamic :: GAL@period-decline :: GAL@period-ottoman :: GAL@shafiis :: GAL@egypt :: GAL@fiqh :: Shamela@الأدب والبلاغة</label><label>url: https://raw.githubusercontent.com/OpenITI/0850AH/master/data/0838ShihabDinDalji/0838ShihabDinDalji.Falaka/0838ShihabDinDalji.Falaka.Shamela0036075-ara1</label><label>tok_length: 40519</label><label>status: pri</label><label>id: Shamela0036075</label><label>ed_info: 1322 هـ :: مطبعة الشعب، مصر</label><label>title_lat: Falaka</label><label>title_ar: الفلاكة والمفلوكون</label><label>book: 0838ShihabDinDalji.Falaka</label><label>author_lat: Shihab Din Dalji</label><label>author_ar: أحمد بن علي بن عبد الله، شهاب الدين الدلجي المصري (المتوفى: 838هـ)</label><label>date: 0838</label><label>versionUri: 0838ShihabDinDalji.Falaka.Shamela0036075-ara1</label>
</div>
</div>
</div>
<a class="nav-link pull-right" href="#menu-toggle" id="menu-toggle" title="Book Chapters">
<i class="btn bi bi-list"></i></a>
</div>
</div>
</nav>
<div class="book-body fixed pt-5">
<div class="row">
<div class="col-12">
<div class="row top-heading-panel content-outer-spacing">
</div>
</div>
<div class="col-12" id="meta">
</div>
</div>
<div class="row justify-content-md-center" id="book-main">
<div class="col-lg-8 col-sm-12" id="content">
</div>
</div>
<div class="row mt-5" id="footer">
<div class="col-md-12">
            The KITAB project is based at the Institute for the Study of Muslim Civilizations (ISMC) at Aga Khan
            University, London, and has received funding from the European Research Council (ERC) under the European
            Union's
            Horizon 2020 research and innovation programme (Grant agreement No. 772989)

          </div>
<div class="col-md-12">
<img alt="Logos" height="50" id="logos" src="../img/AKU-EU-ERC-three-logos.jpg"/>
</div>
</div>
</div>
</div>
</div>
<script>

    var pageSel = document.getElementById("page-select");
    var volSel = document.getElementById("vol-select");
    var thisVolume = "01";
    var volPages = {"01": ["000", "001", "002", "003", "004", "005", "006", "007", "008", "009", "010", "011", "012", "013", "014", "015", "016", "017", "018", "019", "020", "021", "022", "023", "024", "025", "026", "027", "028", "029", "030", "031", "032", "033", "034", "035", "036", "037", "038", "039", "040", "041", "042", "043", "044", "045", "046", "047", "048", "049", "050", "051", "052", "053", "054", "055", "056", "057", "058", "059", "060", "061", "062", "063", "064", "065", "066", "067", "068", "069", "070", "071", "072", "073", "074", "075", "076", "077", "078", "079", "080", "081", "082", "083", "084", "085", "086", "087", "088", "089", "090", "091", "092", "093", "094", "095", "096", "097", "098", "099", "100", "101", "102", "103", "104", "105", "106", "107", "108", "109", "110", "111", "112", "113", "114", "115", "116", "117", "118", "119", "120", "121", "122", "123", "124", "125", "126", "127", "128", "129", "130", "131", "132", "133", "134", "135", "136", "137", "138", "139", "140", "141", "142", "143", "144", "145"]}; /*loaded by html_builder*/

    function goToAnchor(vol, anchorId) {
      if (vol != window.thisVolume) {
        loadVolume(vol, false).then(res => {
          console.log("Volume loaded");
          console.log("Go to anchor " + anchorId);
          /*move the volume page to the element with id=anchorId*/
          /*var targetAnchor = document.getElementById(anchorId);
          targetAnchor.scrollIntoView({block: 'nearest'});  // this does not always work...
          console.log(targetAnchor);*/
          /*window.location.hash = "";
          window.location.hash = anchorId;
          window.location.hash = anchorId;
          console.log("#"+anchorId);*/
          /*//This approach does not work at all: scrolls only main window.
          var targetAnchor = $("#"+anchorId);
          //$("#content").animate(
          $("html, body").animate(
            {scrollTop: targetAnchor.offset().top},
            1000
          );*/
          /*//This approach does not work at all: scrolls only main window.
          var targetAnchor = document.getElementById(anchorId);
          var rect = targetAnchor.getBoundingClientRect();
          console.log(targetAnchor);
          console.log(rect);
          var viewHeight=Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
          window.scroll({
            top: rect.top + rect.height / 2 - viewHeight /2,
            behavior: 'smooth'
          });*/
          /*var targetAnchor = document.getElementById(anchorId);
          var contentDiv = document.getElementsByClassName("book-body")[0];
          var topPos = contentDiv.offsetTop;
          var windowSize = $(window).height();
          console.log("topPos: " + topPos);
          console.log("targetPos: " + targetAnchor.offsetTop);
          console.log("windowSize:" + windowSize)
          console.log("targetAnchor.offsetTop-windowSize/3 = " + (targetAnchor.offsetTop - topPos - windowSize / 2));
          contentDiv.scrollTop = targetAnchor.offsetTop - topPos - windowSize / 2;*/
          var targetAnchor = document.getElementById(anchorId);
          targetAnchor.scrollIntoView({"block": "start"});
        });
      } else {
        /*move the volume page to the element with id=anchorId*/
        /*var targetAnchor = document.getElementById(anchorId);
        targetAnchor.scrollIntoView({block: 'nearest'});  // this does not always work...
        console.log(targetAnchor);*/
        /*window.location.hash = "";
        window.location.hash = anchorId;
        window.location.hash = anchorId;
        console.log("#"+anchorId);*/
        /*//This approach does not work at all: scrolls only main window.
        var targetAnchor = $("#"+anchorId);
        //$("#content").animate(
        $("html, body").animate(
          {scrollTop: targetAnchor.offset().top},
          1000
        );*/
        /*//This approach does not work at all: scrolls only main window.
        var targetAnchor = document.getElementById(anchorId);
        var rect = targetAnchor.getBoundingClientRect();
        console.log(targetAnchor);
        console.log(rect);
        var viewHeight=Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
        window.scroll({
          top: rect.top + rect.height / 2 - viewHeight /2,
          behavior: 'smooth'
        });*/
        /*var targetAnchor = document.getElementById(anchorId);
        var contentDiv = document.getElementsByClassName("book-body")[0];
        var topPos = contentDiv.offsetTop;
        var windowSize = $(window).height();
        console.log("topPos: " + topPos);
        console.log("targetPos: " + targetAnchor.offsetTop);
        console.log("windowSize:" + windowSize)
        console.log("targetAnchor.offsetTop-windowSize/3 = " + (targetAnchor.offsetTop - topPos - windowSize / 2));
        contentDiv.scrollTop = targetAnchor.offsetTop - topPos - windowSize / 2;*/
        var targetAnchor = document.getElementById(anchorId);
        targetAnchor.scrollIntoView({"block": "start"});
      }
    }

    CollapsibleLists.apply();
    console.log("Applied CollapsibleLists");

    $(document).ready(function () {
      console.log("Load initial volume " + thisVolume);
      loadVolume(thisVolume).then(res => {
        console.log("Initial volume loaded");
        $('#loading').hide();
        $('#loading').fadeOut("slow");
      });
      $(window).scroll(function () {
        if ($(this).scrollTop() > 50) {
          $('#back-to-top').fadeIn();
        } else {
          $('#back-to-top').fadeOut();
        }
      });
      // scroll body to 0px on click
      $('#back-to-top').click(function () {
        $('body,html').animate({
          scrollTop: 0
        }, 400);
        return false;
      });
      $("#menu-toggle").click(function (e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled");
      });

      $(".font-default").click(function () {

        $('#wrapper').toggleClass("font-increase", "font-default");
      });

      $(".bi-lightbulb-off").click(function () {
        $('.bi-lightbulb-off').toggleClass("bi-lightbulb", "bi-lightbulb-off");
        $('.page-wrapper').toggleClass("night-mode", "");
        $('.navbar-light').toggleClass("night-mode", "");
        console.log(this);

      });
      $('.toc-item').click(function (event) {
        /*console.log('toc item clicked');*/
        event.preventDefault();
        var clickedElement = event.target;
        /*console.log(clickedElement);*/
        var href = clickedElement.getAttribute("href");
        /*console.log('href: '+href);*/
        var vol = href.substring(0, 2);
        var head = href.split('head').pop();
        var anchorId = "head" + head;
        goToAnchor(vol, anchorId);
        return false;
      });
    });

    function loadPageNumbers(vol, page) {
      /*var pageSel = document.getElementById("page-select");*/
      pageSel.innerHTML = '';
      volPages[vol].forEach(function (p, index) {
        pageSel.options[pageSel.options.length] = new Option(p, p);
      });
      if (page) {
        pageSel.value = page;
      }
    }

    function loadVolumeNumbers(vol) {
      /*var volSel = document.getElementById("vol-select");*/
      volSel.innerHTML = '';
      /*console.log(Object.keys(volPages));*/
      /*console.log(Object.keys(volPages).sort());*/

      Object.keys(volPages).sort().forEach(function (v, index) {
        /*console.log(v);*/
        volSel.options[volSel.options.length] = new Option(v, v);
      });
      volSel.value = vol;
    }

    async function loadVolume(vol) {
      /*Load volume json */
      var page = pageSel.value;
      $('#loading').show();
      console.log("loading volume " + vol);
      await $.getJSON(vol + ".json", function (json) {
        console.log(json)
        $('#content').empty().append(json["content"]);
        /*console.log("json loaded");*/
        window.thisVolume = vol;
        $('#loading').hide();
        $('#loading').fadeOut("slow");
        /*Load volume and page numbers in page-nav form:*/
        loadVolumeNumbers(vol);
        loadPageNumbers(vol, page);
        return true;
      });
    }


    function padWithZeros(number, width) {
      number = number + "";
      if (number.length >= width) {
        return number;
      } else {
        return new Array(width - number.length + 1).join("0") + number;
      }
    }
    document.getElementById("nav-form").addEventListener("submit", function (event) {
      event.preventDefault();
      /*console.log("Clicked Go");*/
      var vol = volSel.value;
      console.log("vol: " + vol);
      /*var targetPage = parseInt(pageSel.value, 10);
      if (page >= 1) {
        page = page-1; //page number is at bottom of page
      }
      var anchor = "v"+vol+"p"+padWithZeros(targetPage, 3);*/
      var targetPage = pageSel.value;
      var pages = volPages[vol];
      var index = pages.indexOf(targetPage);
      if (index > 0) {
        targetPage = pages[index-1];
      }

      console.log("targetPage: " + targetPage);
      var anchor = "v" + vol + "p" + targetPage;
      goToAnchor(vol, anchor);
      return false;
    });

    /*Adapt the page numbers list when the volume number changes:*/
    volSel.addEventListener("change", function (event) {
      var vol = this.value;
      var page = pageSel.value;
      loadPageNumbers(vol, page);
    });


  </script>
</body>
</html>
