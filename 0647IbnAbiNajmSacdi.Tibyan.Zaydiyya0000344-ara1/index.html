<html dir="rtl" lang="ar">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta http-equiv="Content-Security-Policy" https:=""/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script crossorigin="anonymous" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js"></script>
<link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" rel="stylesheet"/>
<link href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Amiri&amp;display=swap" rel="stylesheet"/>
<!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css"
        integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous"> -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css" rel="stylesheet"/>
<link crossorigin="anonymous" href="../css/stylev2.css" rel="stylesheet" type="text/css"/>
<script crossorigin="anonymous" src="../js/CollapsibleLists.js" type="application/javascript"></script>
<!-- <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/alpheios-components@latest/dist/style/style-components.min.css" /> -->
<script type="text/javascript">
</script>
</head>
<body>
<div id="loading">
<img alt="Loading..." id="loading-image" src="../img/spinner1.gif"/>
</div>
<div class="page-wrapper toggled" id="wrapper">
<div id="sidebar-wrapper">
<html><body><div class="card-header title-heading">فصول الكتاب</div><ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head0">CHECK [التبيان في الناسخ والمنسوخ في القرآن المجيد - ابن ابي النجم</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head1">AUTO بسم الله الرحمن الرحيم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head2">AUTO القسم الأول: الدراسة ((ما قبل النص))</a>
</li>
</ul>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head3">AUTO [مقدمة المؤلف]</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head4">AUTO (1) فصل [تعريف النسخ وبعض الأحكام المتعلقة به]</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head5">AUTO اعلم أنه لا بد لكل ms022 من أراد معرفة ناسخ القرآن، ومنسوخه من</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head6">AUTO قلنا: شرعي؛ لأن النسخ بدلالة العقل لا يجوز(1) قلنا: مع</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head7">AUTO [2] مسألة: &lt;
            <li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head8">AUTO [حكم نسخ الشرائع السابقة للإسلام](1)</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head9">AUTO وإذا جاز النسخ في شريعة ابراهيم، جاز في شريعة موسى، وقد صحت</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head10">AUTO وذهب بعضهم إلى أنه لا يجوز النسخ إلا بتقدم &lt;
            <li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head11">AUTO [حكم نسخ الأشق بالأخف والمساوي]</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head12">AUTO [6] مسألة: نسخ الأشق بالأخف &lt;&gt;(1) جائز إجماعا(2)،</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head13">AUTO [حكم نسخ الإخبار]</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head14">AUTO [8] مسألة: يجوز &lt;&gt;(1) الأخبار، إذا كانت مما يجوز تغير</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head15">AUTO [حكم نسخ الحكم دون التلاوة]</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head16">AUTO [حكم نسخ الشيء قبل مرور إمكان فعله]</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head17">AUTO [حكم الزيادة على النص]</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head18">AUTO [12] مسألة: قال الإمام المنصور بالله سلام الله عليه(1) في</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head19">AUTO [حكم نسخ الكتاب بالكتاب]</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head20">AUTO وأمثاله كثيرة &lt;&gt;(1) المقصود بهذا الكتاب، وسيأتي ذكرها</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head21">AUTO - أن يكون الآمر الناهي واحدا، أو المأمور المنهي واحدا،</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head22">AUTO &lt;
            <li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head23">AUTO والظاهر من مذهب الهادي(1)، وأخيه عبدالله(2) -عليهما السلام-</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head24">AUTO ويجوز نسخ أفعاله بأقواله -صلى الله عليه وآله وسلم- وأقواله</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head25">AUTO [5] نسخ الكتاب المسح على الخفين واستقبال [11-أ] بيت المقدس،</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head26">AUTO [18] مسألة: لا يجوز النسخ بالقياس(3) ولا نسخه، ولا يجوز نسخ</a>
</li>
</a></li></a></li></a></li></ul>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head27">AUTO [الطريق التي يعلم بها الناسخ ناسخا والمنسوخ منسوخا]</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head28">AUTO [[7]] ((إن الله قد أعطى كل ذي حق حقه ألا لا وصية</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head29">AUTO [ذكر السور على نسق المصحف الشريف]</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head30">AUTO ولنرجع إلى ذكر السور على النسق إن شاء الله تعالى.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head31">AUTO مرة أخرى، ليس فيها ناسخ ولا منسوخ، لأن أولها ثناء وآخرها دعاء.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head32">AUTO [(3) سورة آل عمران]</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head33">AUTO قال ms036 مقاتل: ليس [33-أ] في آل عمران منسوخ سواها(3) وقال أبو</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head34">AUTO [(5) سورة المائدة]</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head35">AUTO [(6) سورة الأنعام]</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head36">AUTO قيل: منسوخة بآية السيف، وقد نسخت آية السيف مائة وأربعا</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head37">AUTO ذكره الإمام المنصور بالله -عليه السلام-(1) ورواه عن ابن</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head38">AUTO وقد كان في الدولة الأموية والعباسية، ملكت بلاد الإسلام،</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head39">AUTO قال الحسن والأصم(2): نزلت الآية قبل أن يؤمر بقتال المشركين</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head40">AUTO ذكر أبو القاسم هبة الله(2) أن هذه الآيات نسخت بآية</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head41">AUTO قيل: نسخت بآية السيف ولم يذكر ذلك شيخنا [59-أ] الحاكم(1)</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head42">AUTO سورة يوسف -عليه السلام- مكية(2) ليس فيها ناسخ ولا</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head43">AUTO قيل: نسخت بآية السيف.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head44">AUTO [(15) سورة الحجر]</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head45">AUTO وقيل: أعرض عن مجاوبتهم إذا آذوك عن أبي علي(2) ولا نسخ فيه.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head46">AUTO [(17) سورة الإسراء "بني اسرائيل"]</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head47">AUTO قيل: وكيلا تمنعهم من الكفر قهرا، وقيل: حفيظا(5) وقيل: هي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head48">AUTO [(19) سورة مريم عليها السلام]</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head49">AUTO قيل: نسخت بآية السيف، وقيل: ليس فيها نسخ، والمراد: لا تعجل</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head50">AUTO قيل: نسخت بآية القتال، وقيل لا نسخ فيها، والمراد: بالصبر</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head51">AUTO [(22) سورة الحج]</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head52">AUTO قيل: نسختها آية السيف، والله أعلم.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head53">AUTO [(24) سورة النور]</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head54">AUTO قيل: الإستئذان(3) منسوخ، وقيل: هو ثابت [16أ-ب] عن</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head55">AUTO وقد أكد -صلى الله عليه وآله وسلم- تصحيح التوبة في خطبة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head56">AUTO [(27) سورة النمل]</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head57">AUTO قيل: منسوخة بآية السيف، والأولى أنها لا نسخ فيها إذ ليس</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head58">AUTO منسوخة بآية السيف، والأقرب أنها غير منسوخة، لأنه لا تعارض</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head59">AUTO قيل: نسخت بآية السيف عن قتادة، ومقاتل(2).</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head60">AUTO &lt;&gt;(3).</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head61">AUTO قيل: نسخت بآية السيف، ولم يذكره الحاكم -رحمه الله-</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head62">AUTO قيل: نسخت بآية السيف، ولم يذكره الحاكم(5) -رحمه الله-.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head63">AUTO [1] قوله تعالى: {ولا تطع الكافرين والمنافقين ودع أذاهم}</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head64">AUTO نسخت بآية السيف، &lt;
                <li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head65">AUTO [(36) سورة (يس)]</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head66">AUTO سورة (يس) مكية لا منسوخ فيها(1).</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head67">AUTO [(38) سورة ص~]</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head68">AUTO سورة ص~ مكية &lt;&lt;17أ ب&gt;&gt;(1) ليس فيها ناسخ ولا منسوخ.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head69">AUTO قيل: نسخ ذلك بآية السيف، والأقرب أنه لا نسخ فيه، إذ لا</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head70">AUTO قيل: نسخ ذلك بآية السيف، وهو تعبد، إذ ليس بين الآيتين تعارض.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head71">AUTO قيل: نسخت بآية السيف، والأقرب أنها غير منسوخة، والدفع</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head72">AUTO قيل: نسخت بآية السيف، &lt;
                <li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head73">AUTO وقيل الآية الأولى تهديد، وليس فيها نسخ.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head74">AUTO قيل: ارتقب النصر(1) وقيل: نسخت بآية السيف، &lt;
                <li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head75">AUTO قيل: نسخت بآية القتال(1) عن القرضي، والسدي(2)، وغيرهما.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head76">AUTO قيل: نسخت بآية الفتح(1)، وقيل: ما أدري ما يفعل بي ولا بكم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head77">AUTO نسخ بآية السيف.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head78">AUTO [1] قوله تعالى: {ولولا رجال مؤمنون} [الفتح: 25] [76-أ].</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head79">AUTO سورة الحجرات مدنية. لا ناسخ فيها ولا منسوخ(4).</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head80">AUTO [(51) سورة الذاريات]</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head81">AUTO ومنهم من جعل [الناسخ] آية السيف، وقيل: تول ساعة، وتذكر</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head82">AUTO [(53) سورة النجم]</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head83">AUTO قيل: أعرض عن مكافأتهم بالسب، وقيل: نسخت بآية السيف.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head84">AUTO سورة القمر نزلت بمكة. ليس فيها ناسخ ولا منسوخ(3).</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head85">AUTO [(56) سورة الواقعة]</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head86">AUTO سورة الواقعة مكية. ليس فيها ناسخ ولا منسوخ(1).</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head87">AUTO سورة الحديد ليس فيها ناسخ ولا منسوخ، واختلف في تنزيلها،</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head88">AUTO نسخت بقوله تعالى: {أأشفقتم أن تقدموا بين يدي نجواكم صدقات</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head89">AUTO [(60) سورة الإمتحان "الممتحنة"]</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head90">AUTO قوله: {وإن فاتكم شيء من أزواجكم} قيل: نزلت في عياض ابن</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head91">AUTO سورة الصف مدنية. ليس فيها ناسخ ولا منسوخ(4).</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head92">AUTO [(63) سورة المنافقين]</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head93">AUTO سورة المنافقين مدنية. ولا منسوخ فيها(1).</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head94">AUTO سورة التغابن مدنية. ولا منسوخ فيها(2).</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head95">AUTO سورة الطلاق مدنية. ولا منسوخ فيها(3).</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head96">AUTO سورة التحريم مدنية. ولا ناسخ فيها ولا منسوخ(4).</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head97">AUTO سورة الملك مكية. وكذلك(5).</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head98">AUTO سورة ن~ مكية(6).</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head99">AUTO [(70) سورة المعارج]</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head100">AUTO قيل: تهديد، وقيل: نسخ بآية السيف.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head101">AUTO سورة نوح -عليه السلام- مكية، ولا ناسخ فيها ولا منسوخ(3).</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head102">AUTO سورة الجن مكية، ولا ناسخ فيها ولا منسوخ(4).</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head103">AUTO يعني المستهزئين من قريش، وذلك تهديد قائم، وقيل بل أمر،</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head104">AUTO [(75) سورة القيامة]</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head105">AUTO سورة القيامة مكية، ولا ناسخ فيها ولا منسوخ(1).</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head106">AUTO [سورة هل أتى على الإنسان حين من الدهر الأقرب أنه لا منسوخ</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head107">AUTO سورة المرسلات [83-أ] مكية، لا ناسخ فيها ولا منسوخ.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head108">AUTO [(80) سورة عبس]</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head109">AUTO سورة عبس مختلف فيها لا ناسخ فيها ولا منسوخ(1).</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head110">AUTO وكذلك التكوير مكية، لا ناسخ فيها ولا منسوخ(2).</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head111">AUTO وكذلك الإنفطار، والمطففين، والإنشقاق، والبروج(3).</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head112">AUTO قيل: نسخت بآية السيف.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head113">AUTO سورة سبح مكية. ولا منسوخ فيها(5).</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head114">AUTO قيل: نسخت بآية السيف، وقال قوم: معناها لست عليهم بمسلط،</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head115">AUTO سورة الفجر مكية. ليس فيها ناسخ ولا منسوخ(1).</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head116">AUTO قيل: نسخت بآية السيف.</a>
</li>
</a></li></a></li></a></li></ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</body></html></div>
<div class="book body-inner" lang="ara">
<nav class="navbar navbar-expand-lg navbar-light bg-light sticky-top border-bottom" style="direction: ltr;">
<div class="mr-auto d-flex justify-content-left">
<a class="navbar-brand ms-2" href="http://www.kitab-project.org" target="_blank">
<img class="d-inline-block align-top" src="https://cdn.jsdelivr.net/gh/sohailmerchant/kitab-cdn@main/img/kitab-logo.png" width="60px"/>
</a>
</div>
<div class="navbar-nav mx-auto btn-toolbar" style="direction: rtl;">
<div class="d-flex justify-content-center">
<form class="row" id="nav-form" style="margin-bottom: 0px;">
<span class="btn col justify-content-center">ج:</span>
<select class="col form-select pull-left" id="vol-select"></select>
<span class="btn col justify-content-center">ص:</span>
<select class="col form-select pull-left" id="page-select"></select>
<button class="btn col pull-right mx-3" id="nav-submdit-btn" style="width: 100px;" type="submit" value="Go">Go</button>
</form>
</div>
</div>
<div class="btn-toolbar navbar-nav ml-auto d-flex justify-content-right">
<div class="btn-group">
<a class="nav-link pull-right" title="Go to top">
<i class="btn bi bi-arrow-up-circle" id="back-to-top"></i>
</a>
<a class="nav-link pull-right" title="Increase fonts">
<i class="btn bi bi-fonts font-default pull-left"></i>
</a>
<a class="nav-link pull-right" title="Turn light off">
<i class="btn bi bi-lightbulb-off"></i>
</a>
<div class="nav-link pull-right dropdown">
<a aria-expanded="false" aria-haspopup="true" class="" data-bs-toggle="dropdown" id="dropdownMenuButton" role="button" title="Book Metadata">
<i class="btn bi bi-info"></i>
</a>
<div aria-labelledby="dropdownMenuButton" class="dropdown-menu">
<div class="col-12" id="metadata-content"><label>char_length: 177687</label><label>author_lat_full_name: </label><label>author_lat_shuhra: </label><label>author_from_uri: Ibn Abi Najm Sacdi</label><label>tags:  :: Zaydiyya@التفسير وعلوم القرآن</label><label>url: https://raw.githubusercontent.com/OpenITI/0650AH/master/data/0647IbnAbiNajmSacdi/0647IbnAbiNajmSacdi.Tibyan/0647IbnAbiNajmSacdi.Tibyan.Zaydiyya0000344-ara1</label><label>tok_length: 41346</label><label>status: pri</label><label>id: Zaydiyya0000344</label><label>ed_info: عبدالله عبدالله بن أحمد الحوثي</label><label>title_lat: Tibyan</label><label>title_ar: التبيان في الناسخ والمنسوخ في القرآن المجيد</label><label>book: 0647IbnAbiNajmSacdi.Tibyan</label><label>author_lat: Ibn Abi Najm Sacdi</label><label>author_ar: عبدالله بن محمد بن عبدالله بن حمزة بن أبي النجم الصعدي(... - 647ه)</label><label>date: 0647</label><label>versionUri: 0647IbnAbiNajmSacdi.Tibyan.Zaydiyya0000344-ara1</label>
</div>
</div>
</div>
<a class="nav-link pull-right" href="#menu-toggle" id="menu-toggle" title="Book Chapters">
<i class="btn bi bi-list"></i></a>
</div>
</div>
</nav>
<div class="book-body fixed pt-5">
<div class="row">
<div class="col-12">
<div class="row top-heading-panel content-outer-spacing">
</div>
</div>
<div class="col-12" id="meta">
</div>
</div>
<div class="row justify-content-md-center" id="book-main">
<div class="col-lg-8 col-sm-12" id="content">
</div>
</div>
<div class="row mt-5" id="footer">
<div class="col-md-12">
            The KITAB project is based at the Institute for the Study of Muslim Civilizations (ISMC) at Aga Khan
            University, London, and has received funding from the European Research Council (ERC) under the European
            Union's
            Horizon 2020 research and innovation programme (Grant agreement No. 772989)

          </div>
<div class="col-md-12">
<img alt="Logos" height="50" id="logos" src="../img/AKU-EU-ERC-three-logos.jpg"/>
</div>
</div>
</div>
</div>
</div>
<script>

    var pageSel = document.getElementById("page-select");
    var volSel = document.getElementById("vol-select");
    var thisVolume = "01";
    var volPages = {"01": ["001", "001", "002", "003", "004", "004", "005", "006", "007", "008", "009", "010", "011", "012", "013", "014", "015", "016", "017", "018", "019", "020", "021", "022", "023", "024", "025", "026", "027", "027", "028", "029", "030", "031", "032", "033", "034", "035", "036", "037", "038", "039", "040", "041", "042", "043", "044", "045", "046", "047", "048", "049", "050", "051", "052", "053", "054", "055", "056", "057", "058", "059", "060", "061", "062", "063", "064", "065", "066", "067", "068", "069", "070", "071", "072", "073", "074", "075", "076", "077", "078", "079", "080", "081", "082", "083", "084", "085", "086", "087", "088", "089", "090", "091", "092", "093", "094", "095", "096", "097", "098", "099", "100", "101", "102", "103", "104", "105", "106", "107", "108", "109", "110", "111", "112", "113", "114", "115", "116", "117", "118", "119", "120", "121", "122", "123", "124", "125", "126", "127", "128", "129", "130", "131", "132", "133", "134", "135", "136", "137", "138", "139", "140", "141", "142", "143", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "162", "163", "164", "165", "166", "167", "168", "005", "007", "012", "013", "027", "028", "029", "030", "031", "032", "033", "034", "035", "036", "037", "038", "039", "040", "041", "042", "043", "044", "045", "046", "047", "048", "049", "050", "051", "052", "053", "054", "055", "056", "057", "058", "059", "060", "061", "062", "063", "064", "065", "066", "067", "068", "069", "070", "071", "072", "073", "074", "075", "076", "077", "078", "079", "080", "081", "082", "083", "084", "085", "086", "087", "088", "089", "090", "091", "092", "093", "094", "095", "096", "097", "098", "099", "100", "101", "102", "103", "104", "105", "106", "107", "108", "109", "110", "111", "112", "113", "114", "115", "116", "117", "118", "119", "120", "121", "122", "123", "124", "125", "126", "127", "128", "129", "130", "131", "132", "133", "134", "135", "136", "137", "138", "139", "140", "141", "142", "143", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "162", "163", "164", "165", "166", "167"]}; /*loaded by html_builder*/

    function goToAnchor(vol, anchorId) {
      if (vol != window.thisVolume) {
        loadVolume(vol, false).then(res => {
          console.log("Volume loaded");
          console.log("Go to anchor " + anchorId);
          /*move the volume page to the element with id=anchorId*/
          /*var targetAnchor = document.getElementById(anchorId);
          targetAnchor.scrollIntoView({block: 'nearest'});  // this does not always work...
          console.log(targetAnchor);*/
          /*window.location.hash = "";
          window.location.hash = anchorId;
          window.location.hash = anchorId;
          console.log("#"+anchorId);*/
          /*//This approach does not work at all: scrolls only main window.
          var targetAnchor = $("#"+anchorId);
          //$("#content").animate(
          $("html, body").animate(
            {scrollTop: targetAnchor.offset().top},
            1000
          );*/
          /*//This approach does not work at all: scrolls only main window.
          var targetAnchor = document.getElementById(anchorId);
          var rect = targetAnchor.getBoundingClientRect();
          console.log(targetAnchor);
          console.log(rect);
          var viewHeight=Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
          window.scroll({
            top: rect.top + rect.height / 2 - viewHeight /2,
            behavior: 'smooth'
          });*/
          /*var targetAnchor = document.getElementById(anchorId);
          var contentDiv = document.getElementsByClassName("book-body")[0];
          var topPos = contentDiv.offsetTop;
          var windowSize = $(window).height();
          console.log("topPos: " + topPos);
          console.log("targetPos: " + targetAnchor.offsetTop);
          console.log("windowSize:" + windowSize)
          console.log("targetAnchor.offsetTop-windowSize/3 = " + (targetAnchor.offsetTop - topPos - windowSize / 2));
          contentDiv.scrollTop = targetAnchor.offsetTop - topPos - windowSize / 2;*/
          var targetAnchor = document.getElementById(anchorId);
          targetAnchor.scrollIntoView({"block": "start"});
        });
      } else {
        /*move the volume page to the element with id=anchorId*/
        /*var targetAnchor = document.getElementById(anchorId);
        targetAnchor.scrollIntoView({block: 'nearest'});  // this does not always work...
        console.log(targetAnchor);*/
        /*window.location.hash = "";
        window.location.hash = anchorId;
        window.location.hash = anchorId;
        console.log("#"+anchorId);*/
        /*//This approach does not work at all: scrolls only main window.
        var targetAnchor = $("#"+anchorId);
        //$("#content").animate(
        $("html, body").animate(
          {scrollTop: targetAnchor.offset().top},
          1000
        );*/
        /*//This approach does not work at all: scrolls only main window.
        var targetAnchor = document.getElementById(anchorId);
        var rect = targetAnchor.getBoundingClientRect();
        console.log(targetAnchor);
        console.log(rect);
        var viewHeight=Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
        window.scroll({
          top: rect.top + rect.height / 2 - viewHeight /2,
          behavior: 'smooth'
        });*/
        /*var targetAnchor = document.getElementById(anchorId);
        var contentDiv = document.getElementsByClassName("book-body")[0];
        var topPos = contentDiv.offsetTop;
        var windowSize = $(window).height();
        console.log("topPos: " + topPos);
        console.log("targetPos: " + targetAnchor.offsetTop);
        console.log("windowSize:" + windowSize)
        console.log("targetAnchor.offsetTop-windowSize/3 = " + (targetAnchor.offsetTop - topPos - windowSize / 2));
        contentDiv.scrollTop = targetAnchor.offsetTop - topPos - windowSize / 2;*/
        var targetAnchor = document.getElementById(anchorId);
        targetAnchor.scrollIntoView({"block": "start"});
      }
    }

    CollapsibleLists.apply();
    console.log("Applied CollapsibleLists");

    $(document).ready(function () {
      console.log("Load initial volume " + thisVolume);
      loadVolume(thisVolume).then(res => {
        console.log("Initial volume loaded");
        $('#loading').hide();
        $('#loading').fadeOut("slow");
      });
      $(window).scroll(function () {
        if ($(this).scrollTop() > 50) {
          $('#back-to-top').fadeIn();
        } else {
          $('#back-to-top').fadeOut();
        }
      });
      // scroll body to 0px on click
      $('#back-to-top').click(function () {
        $('body,html').animate({
          scrollTop: 0
        }, 400);
        return false;
      });
      $("#menu-toggle").click(function (e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled");
      });

      $(".font-default").click(function () {

        $('#wrapper').toggleClass("font-increase", "font-default");
      });

      $(".bi-lightbulb-off").click(function () {
        $('.bi-lightbulb-off').toggleClass("bi-lightbulb", "bi-lightbulb-off");
        $('.page-wrapper').toggleClass("night-mode", "");
        $('.navbar-light').toggleClass("night-mode", "");
        console.log(this);

      });
      $('.toc-item').click(function (event) {
        /*console.log('toc item clicked');*/
        event.preventDefault();
        var clickedElement = event.target;
        /*console.log(clickedElement);*/
        var href = clickedElement.getAttribute("href");
        /*console.log('href: '+href);*/
        var vol = href.substring(0, 2);
        var head = href.split('head').pop();
        var anchorId = "head" + head;
        goToAnchor(vol, anchorId);
        return false;
      });
    });

    function loadPageNumbers(vol, page) {
      /*var pageSel = document.getElementById("page-select");*/
      pageSel.innerHTML = '';
      volPages[vol].forEach(function (p, index) {
        pageSel.options[pageSel.options.length] = new Option(p, p);
      });
      if (page) {
        pageSel.value = page;
      }
    }

    function loadVolumeNumbers(vol) {
      /*var volSel = document.getElementById("vol-select");*/
      volSel.innerHTML = '';
      /*console.log(Object.keys(volPages));*/
      /*console.log(Object.keys(volPages).sort());*/

      Object.keys(volPages).sort().forEach(function (v, index) {
        /*console.log(v);*/
        volSel.options[volSel.options.length] = new Option(v, v);
      });
      volSel.value = vol;
    }

    async function loadVolume(vol) {
      /*Load volume json */
      var page = pageSel.value;
      $('#loading').show();
      console.log("loading volume " + vol);
      await $.getJSON(vol + ".json", function (json) {
        console.log(json)
        $('#content').empty().append(json["content"]);
        /*console.log("json loaded");*/
        window.thisVolume = vol;
        $('#loading').hide();
        $('#loading').fadeOut("slow");
        /*Load volume and page numbers in page-nav form:*/
        loadVolumeNumbers(vol);
        loadPageNumbers(vol, page);
        return true;
      });
    }


    function padWithZeros(number, width) {
      number = number + "";
      if (number.length >= width) {
        return number;
      } else {
        return new Array(width - number.length + 1).join("0") + number;
      }
    }
    document.getElementById("nav-form").addEventListener("submit", function (event) {
      event.preventDefault();
      /*console.log("Clicked Go");*/
      var vol = volSel.value;
      console.log("vol: " + vol);
      /*var targetPage = parseInt(pageSel.value, 10);
      if (page >= 1) {
        page = page-1; //page number is at bottom of page
      }
      var anchor = "v"+vol+"p"+padWithZeros(targetPage, 3);*/
      var targetPage = pageSel.value;
      var pages = volPages[vol];
      var index = pages.indexOf(targetPage);
      if (index > 0) {
        targetPage = pages[index-1];
      }

      console.log("targetPage: " + targetPage);
      var anchor = "v" + vol + "p" + targetPage;
      goToAnchor(vol, anchor);
      return false;
    });

    /*Adapt the page numbers list when the volume number changes:*/
    volSel.addEventListener("change", function (event) {
      var vol = this.value;
      var page = pageSel.value;
      loadPageNumbers(vol, page);
    });


  </script>
</body>
</html>
