<html dir="rtl" lang="ar">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta http-equiv="Content-Security-Policy" https:=""/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script crossorigin="anonymous" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js"></script>
<link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" rel="stylesheet"/>
<link href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Amiri&amp;display=swap" rel="stylesheet"/>
<!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css"
        integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous"> -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css" rel="stylesheet"/>
<link crossorigin="anonymous" href="../css/stylev2.css" rel="stylesheet" type="text/css"/>
<script crossorigin="anonymous" src="../js/CollapsibleLists.js" type="application/javascript"></script>
<!-- <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/alpheios-components@latest/dist/style/style-components.min.css" /> -->
<script type="text/javascript">
</script>
</head>
<body>
<div id="loading">
<img alt="Loading..." id="loading-image" src="../img/spinner1.gif"/>
</div>
<div class="page-wrapper toggled" id="wrapper">
<div id="sidebar-wrapper">
<html><body><div class="card-header title-heading">فصول الكتاب</div><ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head0">[مقدمة التحقيق]</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head1">ذكر الغرض من هذا الكتاب</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head2">ذكر الأفلاك ms008 وهيئاتها والنجوم وتأثيراتها والعناصر وتراكيبها وكيفية أفعالها</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head3">ذكر البيان عن قسمة الازمنة، وفصول السنة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head4">ذكر الرياح الأربع ومهابها وأفعالها وتأثيراتها وما اتصل بذلك من تقريظ مصر والتنبيه على فضلها وما شرفت به على غيرها</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head5">ذكر الأرض وشكلها وما قيل في مقدار مساحتها وعامرها وغامرها، والنواحي والآفاق وما يغلب عليها وتأثيرها في سكانها وما اتصل بذلك</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head6">ذكر الأقاليم السبعة وقسمتها وحدودها وما قيل في طولها وعرضها وما اتصل بذلك</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head7">ذكر قسمة الأقاليم على الكواكب السبعة- الخمسة والنيرين-</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head8">ذكر الإقليم الرابع ووصفه وفضله على سائر الأقاليم، وما خص به ساكنوه من الفضائل التي باينوا بها سكان غيره منها وما اتصل بذلك من الكلام في عروض البلدان واطوالها والاهوية والترب والمياه وتأثيراتها وغير ذلك</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head9">ذكر البحار واعدادها وما قيل في اطوالها وعروضها واتصالها وانفصالها، ومصبات عظام الأنهار اليها وما يحيط بها من الممالك وغير ذلك من أحوالها</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head10">ذكر الأول منها وهو الحبشي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head11">ذكر البحر الثاني وهو الرومي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head12">ذكر البحر الثالث وهو الخزري</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head13">ذكر البحر الرابع وهو بنطس</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head14">ذكر أوقيانس وهو المحيط</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head15">ذكر الأمم السبع في سالف الزمان ولغاتهم وآرائهم ومواضع ms058 مساكنهم وما بانت به كل أمة من غيرها وما اتصل بذلك</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head16">ذكر ملوك الفرس على طبقاتهم من جيومرت، وهو الأول من ملوكهم إلى يزدجرد بن شهريار آخرهم، وعدة ما ملكوا من السنين</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head17">ذكر الطبقة الاولى من ملوك الفرس الأولى</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head18">ذكر الطبقة الثانية من ملوك الفرس الاولى وهم بلان، معنى ذلك العلويون</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head19">ذكر الطبقة الثالثة من ملوك الفرس الاولى وهم الكيانيون، تفسير ذلك والأعزاء</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head20">ذكر ما أدركه الإحصاء من ملوك الطوائف وهي الطبقة الرابعة من ملوك الفرس وجملة ما ملكوا من السنين</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head21">ذكر ملوك الفرس الثانية وهم الساسانية، وهي الطبقة الخامسة من ملوكهم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head22">ذكر ملوك اليونانيين ومدة ما ملكوا من السنين</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head23">ذكر ملوك الروم على طبقاتهم من الحنفاء وهم الصابئون والمنتصرة وعدتهم، وجملة ما ملكوا من السنين</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head24">ذكر الطبقة الاولى من ملوك الروم، وهم الصابئون</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head25">ذكر الطبقة الثانية من ملوك الروم وهم المنتصرة وتأريخهم وأعدادهم، وما كان من الكوائن والاحداث العظام الديانية والملوكية في أيامهم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head26">ذكر ملوك الروم من الهجرة الى سنة 345</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head27">ذكر بنود الروم وحدودها ومقاديرها، وما يتصل منها بالخليج، وبحر الروم والخزر وما اتصل بذلك من اللمع المنبهة على ما تقدم من تأليفنا فيما سلف من كتبنا</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head28">ذكر الأفدية بين المسلمين والروم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head29">ذكر تأريخ الأمم والأنبياء والملوك، وجامع تأريخ العالم من آدم الى نبينا صلى الله عليه وعلى آله، وما اتصل بذلك</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head30">ذكر جمل من الكلام في سنى الأمم وشهورها وكبسها ونسيئها وما اتصل بذلك</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head31">ذكر التأريخ من مولد رسول الله صلى الله عليه وسلم. ومبعثه. وهجرته. ومغازيه. وسراياه. وسوار به. وكتابه. ووفاته. وتأريخ الخلفاء والملوك بعده. وأيامهم. وكتابهم. ووزرائهم. وحجابهم. وقضاتهم. ونقوش خواتيمهم. وما كان من الحوادث العظيمة الديانية والملوكية في أيامهم. وحصر تواريخهم الى سنة 345 في خلافة المطيع</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head32">ذكر السنة الثانية من الهجرة وتعرف «بسنة الأمر» لأنه أمر فيها بالقتال</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head33">ذكر السنة الثالثة من الهجرة وتعرف «بسنة التمحيص»</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head34">ذكر السنة الرابعة من الهجرة وتعرف «بسنة الترفيه»</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head35">ذكر السنة الخامسة من الهجرة وتعرف «بسنة الأحزاب»</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head36">ذكر السنة السادسة من الهجرة، وتعرف «بسنة الاستئناس»</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head37">ذكر السنة السابعة من الهجرة، وتعرف «بسنة الاستغلاب»</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head38">ذكر السنة الثامنة من الهجرة وتسمى «سنة الفتح»</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head39">ذكر السنة العاشرة من الهجرة وهي سنة «حجة الوداع»</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head40">ذكر السنة الحادية عشرة من الهجرة وهي «سنة الوفاة»</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head41">ذكر خلافة ابى بكر الصديق رضى الله عنه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head42">ذكر خلافة عمر بن الخطاب رضى الله عنه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head43">ذكر خلافة عثمان بن عفان</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head44">ذكر خلافة على بن أبى طالب</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head45">ذكر خلافة الحسن بن على عليه السلام</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head46">ذكر أيام معاوية بن أبى سفيان</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head47">ذكر أيام يزيد بن معاوية</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head48">ذكر أيام معاوية بن يزيد بن معاوية</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head49">ذكر أيام مروان بن الحكم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head50">ذكر أيام عبد ms222 الملك بن مروان</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head51">ذكر أيام الوليد بن عبد الملك</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head52">ذكر أيام سليمان بن عبد الملك</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head53">ذكر خلافة عمر بن عبد العزيز رحمه الله</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head54">ذكر أيام يزيد بن عبد الملك</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head55">ذكر أيام هشام بن عبد الملك</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head56">ذكر أيام الوليد بن يزيد بن عبد الملك</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head57">ذكر أيام مروان بن محمد</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head58">ذكر ما جرت عليه أحوال بنى أمية بعد قتل مروان، بن محمد وتفرقهم في البلاد، وسبب تملك عبد الرحمن ابن معاوية بن هشام على بلاد الأندلس وولده الى وقتنا هذا وما اتصل بذلك</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head59">ذكر أيام ولد العباس خلافة أبى العباس السفاح</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head60">ذكر خلافة ابى جعفر المنصور</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head61">ذكر خلافة المهدي محمد بن عبد الله المنصور</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head62">ذكر خلافة موسى الهادي بن محمد المهدي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head63">ذكر خلافة الرشيد</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head64">ذكر خلافة الأمين</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head65">ذكر خلافة المأمون</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head66">ذكر خلافة المعتصم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head67">ذكر خلافة الواثق</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head68">ذكر خلافة المتوكل</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head69">ذكر خلافة المنتصر محمد</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head70">ذكر خلافة المستعين</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head71">ذكر خلافة المعتز</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head72">ذكر خلافة المهتدي محمد بن هارون</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head73">ذكر خلافة المعتمد</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head74">ذكر خلافة المعتضد</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head75">ذكر خلافة المكتفي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head76">ذكر خلافة المقتدر</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head77">ذكر خلافة القاهر</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head78">ذكر خلافة الراضي محمد</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head79">ذكر خلافة المتقى إبراهيم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head80">ذكر خلافة المستكفي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head81">ذكر خلافة المطيع</a>
</li>
</ul>
</body></html></div>
<div class="book body-inner" lang="ara">
<nav class="navbar navbar-expand-lg navbar-light bg-light sticky-top border-bottom" style="direction: ltr;">
<div class="mr-auto d-flex justify-content-left">
<a class="navbar-brand ms-2" href="http://www.kitab-project.org" target="_blank">
<img class="d-inline-block align-top" src="https://cdn.jsdelivr.net/gh/sohailmerchant/kitab-cdn@main/img/kitab-logo.png" width="60px"/>
</a>
</div>
<div class="navbar-nav mx-auto btn-toolbar" style="direction: rtl;">
<div class="d-flex justify-content-center">
<form class="row" id="nav-form" style="margin-bottom: 0px;">
<span class="btn col justify-content-center">ج:</span>
<select class="col form-select pull-left" id="vol-select"></select>
<span class="btn col justify-content-center">ص:</span>
<select class="col form-select pull-left" id="page-select"></select>
<button class="btn col pull-right mx-3" id="nav-submdit-btn" style="width: 100px;" type="submit" value="Go">Go</button>
</form>
</div>
</div>
<div class="btn-toolbar navbar-nav ml-auto d-flex justify-content-right">
<div class="btn-group">
<a class="nav-link pull-right" title="Go to top">
<i class="btn bi bi-arrow-up-circle" id="back-to-top"></i>
</a>
<a class="nav-link pull-right" title="Increase fonts">
<i class="btn bi bi-fonts font-default pull-left"></i>
</a>
<a class="nav-link pull-right" title="Turn light off">
<i class="btn bi bi-lightbulb-off"></i>
</a>
<div class="nav-link pull-right dropdown">
<a aria-expanded="false" aria-haspopup="true" class="" data-bs-toggle="dropdown" id="dropdownMenuButton" role="button" title="Book Metadata">
<i class="btn bi bi-info"></i>
</a>
<div aria-labelledby="dropdownMenuButton" class="dropdown-menu">
<div class="col-12" id="metadata-content"><label>char_length: 367273</label><label>author_lat_full_name: </label><label>author_lat_shuhra: </label><label>author_from_uri: Mascudi</label><label>tags: COMPLETED :: CENT0400 :: _MISC :: _TARIKH :: GAL@historiography :: GAL@period-classical :: GAL@literature-islamic :: GAL@history :: GAL@history-imperial :: GAL@0750-1000CE :: GAL@literature-arabic :: GAL@history-world :: Shamela@التاريخ</label><label>url: https://raw.githubusercontent.com/OpenITI/0350AH/master/data/0346Mascudi/0346Mascudi.TanbihWaIshraf/0346Mascudi.TanbihWaIshraf.Shamela0023718-ara1.completed</label><label>tok_length: 84786</label><label>status: pri</label><label>id: Shamela0023718</label><label>ed_info: دار الصاوي - القاهرة :: http://www.worldcat.org/oclc/4771362249</label><label>title_lat: Tanbih Wa Ishraf</label><label>title_ar: التنبيه والإشراف</label><label>book: 0346Mascudi.TanbihWaIshraf</label><label>author_lat: Mascudi</label><label>author_ar: أبو الحسن على بن الحسين بن على المسعودي (المتوفى: 346هـ)</label><label>date: 0346</label><label>versionUri: 0346Mascudi.TanbihWaIshraf.Shamela0023718-ara1</label>
</div>
</div>
</div>
<a class="nav-link pull-right" href="#menu-toggle" id="menu-toggle" title="Book Chapters">
<i class="btn bi bi-list"></i></a>
</div>
</div>
</nav>
<div class="book-body fixed pt-5">
<div class="row">
<div class="col-12">
<div class="row top-heading-panel content-outer-spacing">
</div>
</div>
<div class="col-12" id="meta">
</div>
</div>
<div class="row justify-content-md-center" id="book-main">
<div class="col-lg-8 col-sm-12" id="content">
</div>
</div>
<div class="row mt-5" id="footer">
<div class="col-md-12">
            The KITAB project is based at the Institute for the Study of Muslim Civilizations (ISMC) at Aga Khan
            University, London, and has received funding from the European Research Council (ERC) under the European
            Union's
            Horizon 2020 research and innovation programme (Grant agreement No. 772989)

          </div>
<div class="col-md-12">
<img alt="Logos" height="50" id="logos" src="../img/AKU-EU-ERC-three-logos.jpg"/>
</div>
</div>
</div>
</div>
</div>
<script>

    var pageSel = document.getElementById("page-select");
    var volSel = document.getElementById("vol-select");
    var thisVolume = "01";
    var volPages = {"01": ["000", "000", "000", "000", "000", "000", "000", "001", "002", "003", "004", "005", "006", "007", "008", "009", "010", "011", "012", "013", "014", "015", "016", "017", "018", "019", "020", "021", "022", "023", "024", "025", "026", "027", "028", "029", "030", "031", "032", "033", "034", "035", "036", "037", "038", "039", "040", "041", "042", "043", "044", "045", "046", "047", "048", "049", "050", "051", "052", "053", "054", "055", "056", "057", "058", "059", "060", "061", "062", "063", "064", "065", "066", "067", "068", "069", "070", "071", "072", "073", "074", "075", "076", "077", "078", "079", "080", "081", "082", "083", "084", "085", "086", "087", "088", "089", "090", "091", "092", "093", "094", "095", "096", "097", "098", "099", "100", "101", "102", "103", "104", "105", "106", "107", "108", "109", "110", "111", "112", "113", "114", "115", "116", "117", "118", "119", "120", "121", "122", "123", "124", "125", "126", "127", "128", "129", "130", "131", "132", "133", "134", "135", "136", "137", "138", "139", "140", "141", "142", "143", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "162", "163", "164", "165", "166", "167", "168", "169", "170", "171", "172", "173", "174", "175", "176", "177", "178", "179", "180", "181", "182", "183", "184", "185", "186", "187", "188", "189", "190", "191", "192", "193", "194", "195", "196", "197", "198", "199", "200", "201", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214", "215", "216", "217", "218", "219", "220", "221", "222", "223", "224", "225", "226", "227", "228", "229", "230", "231", "232", "233", "234", "235", "236", "237", "238", "239", "240", "241", "242", "243", "244", "245", "246", "247", "248", "249", "250", "251", "252", "253", "254", "255", "256", "257", "258", "259", "260", "261", "262", "263", "264", "265", "266", "267", "268", "269", "270", "271", "272", "273", "274", "275", "276", "277", "278", "279", "280", "281", "282", "283", "284", "285", "286", "287", "288", "289", "290", "291", "292", "293", "294", "295", "296", "297", "298", "299", "300", "301", "302", "303", "304", "305", "306", "307", "308", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321", "322", "323", "324", "325", "326", "327", "328", "329", "330", "331", "332", "333", "334", "335", "336", "337", "338", "339", "340", "341", "342", "343", "344", "345", "346", "347"]}; /*loaded by html_builder*/

    function goToAnchor(vol, anchorId) {
      if (vol != window.thisVolume) {
        loadVolume(vol, false).then(res => {
          console.log("Volume loaded");
          console.log("Go to anchor " + anchorId);
          /*move the volume page to the element with id=anchorId*/
          /*var targetAnchor = document.getElementById(anchorId);
          targetAnchor.scrollIntoView({block: 'nearest'});  // this does not always work...
          console.log(targetAnchor);*/
          /*window.location.hash = "";
          window.location.hash = anchorId;
          window.location.hash = anchorId;
          console.log("#"+anchorId);*/
          /*//This approach does not work at all: scrolls only main window.
          var targetAnchor = $("#"+anchorId);
          //$("#content").animate(
          $("html, body").animate(
            {scrollTop: targetAnchor.offset().top},
            1000
          );*/
          /*//This approach does not work at all: scrolls only main window.
          var targetAnchor = document.getElementById(anchorId);
          var rect = targetAnchor.getBoundingClientRect();
          console.log(targetAnchor);
          console.log(rect);
          var viewHeight=Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
          window.scroll({
            top: rect.top + rect.height / 2 - viewHeight /2,
            behavior: 'smooth'
          });*/
          /*var targetAnchor = document.getElementById(anchorId);
          var contentDiv = document.getElementsByClassName("book-body")[0];
          var topPos = contentDiv.offsetTop;
          var windowSize = $(window).height();
          console.log("topPos: " + topPos);
          console.log("targetPos: " + targetAnchor.offsetTop);
          console.log("windowSize:" + windowSize)
          console.log("targetAnchor.offsetTop-windowSize/3 = " + (targetAnchor.offsetTop - topPos - windowSize / 2));
          contentDiv.scrollTop = targetAnchor.offsetTop - topPos - windowSize / 2;*/
          var targetAnchor = document.getElementById(anchorId);
          targetAnchor.scrollIntoView({"block": "start"});
        });
      } else {
        /*move the volume page to the element with id=anchorId*/
        /*var targetAnchor = document.getElementById(anchorId);
        targetAnchor.scrollIntoView({block: 'nearest'});  // this does not always work...
        console.log(targetAnchor);*/
        /*window.location.hash = "";
        window.location.hash = anchorId;
        window.location.hash = anchorId;
        console.log("#"+anchorId);*/
        /*//This approach does not work at all: scrolls only main window.
        var targetAnchor = $("#"+anchorId);
        //$("#content").animate(
        $("html, body").animate(
          {scrollTop: targetAnchor.offset().top},
          1000
        );*/
        /*//This approach does not work at all: scrolls only main window.
        var targetAnchor = document.getElementById(anchorId);
        var rect = targetAnchor.getBoundingClientRect();
        console.log(targetAnchor);
        console.log(rect);
        var viewHeight=Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
        window.scroll({
          top: rect.top + rect.height / 2 - viewHeight /2,
          behavior: 'smooth'
        });*/
        /*var targetAnchor = document.getElementById(anchorId);
        var contentDiv = document.getElementsByClassName("book-body")[0];
        var topPos = contentDiv.offsetTop;
        var windowSize = $(window).height();
        console.log("topPos: " + topPos);
        console.log("targetPos: " + targetAnchor.offsetTop);
        console.log("windowSize:" + windowSize)
        console.log("targetAnchor.offsetTop-windowSize/3 = " + (targetAnchor.offsetTop - topPos - windowSize / 2));
        contentDiv.scrollTop = targetAnchor.offsetTop - topPos - windowSize / 2;*/
        var targetAnchor = document.getElementById(anchorId);
        targetAnchor.scrollIntoView({"block": "start"});
      }
    }

    CollapsibleLists.apply();
    console.log("Applied CollapsibleLists");

    $(document).ready(function () {
      console.log("Load initial volume " + thisVolume);
      loadVolume(thisVolume).then(res => {
        console.log("Initial volume loaded");
        $('#loading').hide();
        $('#loading').fadeOut("slow");
      });
      $(window).scroll(function () {
        if ($(this).scrollTop() > 50) {
          $('#back-to-top').fadeIn();
        } else {
          $('#back-to-top').fadeOut();
        }
      });
      // scroll body to 0px on click
      $('#back-to-top').click(function () {
        $('body,html').animate({
          scrollTop: 0
        }, 400);
        return false;
      });
      $("#menu-toggle").click(function (e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled");
      });

      $(".font-default").click(function () {

        $('#wrapper').toggleClass("font-increase", "font-default");
      });

      $(".bi-lightbulb-off").click(function () {
        $('.bi-lightbulb-off').toggleClass("bi-lightbulb", "bi-lightbulb-off");
        $('.page-wrapper').toggleClass("night-mode", "");
        $('.navbar-light').toggleClass("night-mode", "");
        console.log(this);

      });
      $('.toc-item').click(function (event) {
        /*console.log('toc item clicked');*/
        event.preventDefault();
        var clickedElement = event.target;
        /*console.log(clickedElement);*/
        var href = clickedElement.getAttribute("href");
        /*console.log('href: '+href);*/
        var vol = href.substring(0, 2);
        var head = href.split('head').pop();
        var anchorId = "head" + head;
        goToAnchor(vol, anchorId);
        return false;
      });
    });

    function loadPageNumbers(vol, page) {
      /*var pageSel = document.getElementById("page-select");*/
      pageSel.innerHTML = '';
      volPages[vol].forEach(function (p, index) {
        pageSel.options[pageSel.options.length] = new Option(p, p);
      });
      if (page) {
        pageSel.value = page;
      }
    }

    function loadVolumeNumbers(vol) {
      /*var volSel = document.getElementById("vol-select");*/
      volSel.innerHTML = '';
      /*console.log(Object.keys(volPages));*/
      /*console.log(Object.keys(volPages).sort());*/

      Object.keys(volPages).sort().forEach(function (v, index) {
        /*console.log(v);*/
        volSel.options[volSel.options.length] = new Option(v, v);
      });
      volSel.value = vol;
    }

    async function loadVolume(vol) {
      /*Load volume json */
      var page = pageSel.value;
      $('#loading').show();
      console.log("loading volume " + vol);
      await $.getJSON(vol + ".json", function (json) {
        console.log(json)
        $('#content').empty().append(json["content"]);
        /*console.log("json loaded");*/
        window.thisVolume = vol;
        $('#loading').hide();
        $('#loading').fadeOut("slow");
        /*Load volume and page numbers in page-nav form:*/
        loadVolumeNumbers(vol);
        loadPageNumbers(vol, page);
        return true;
      });
    }


    function padWithZeros(number, width) {
      number = number + "";
      if (number.length >= width) {
        return number;
      } else {
        return new Array(width - number.length + 1).join("0") + number;
      }
    }
    document.getElementById("nav-form").addEventListener("submit", function (event) {
      event.preventDefault();
      /*console.log("Clicked Go");*/
      var vol = volSel.value;
      console.log("vol: " + vol);
      /*var targetPage = parseInt(pageSel.value, 10);
      if (page >= 1) {
        page = page-1; //page number is at bottom of page
      }
      var anchor = "v"+vol+"p"+padWithZeros(targetPage, 3);*/
      var targetPage = pageSel.value;
      var pages = volPages[vol];
      var index = pages.indexOf(targetPage);
      if (index > 0) {
        targetPage = pages[index-1];
      }

      console.log("targetPage: " + targetPage);
      var anchor = "v" + vol + "p" + targetPage;
      goToAnchor(vol, anchor);
      return false;
    });

    /*Adapt the page numbers list when the volume number changes:*/
    volSel.addEventListener("change", function (event) {
      var vol = this.value;
      var page = pageSel.value;
      loadPageNumbers(vol, page);
    });


  </script>
</body>
</html>
