<html dir="rtl" lang="ar">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta http-equiv="Content-Security-Policy" https:=""/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script crossorigin="anonymous" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js"></script>
<link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" rel="stylesheet"/>
<link href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Amiri&amp;display=swap" rel="stylesheet"/>
<!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css"
        integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous"> -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css" rel="stylesheet"/>
<link crossorigin="anonymous" href="../css/stylev2.css" rel="stylesheet" type="text/css"/>
<script crossorigin="anonymous" src="../js/CollapsibleLists.js" type="application/javascript"></script>
<!-- <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/alpheios-components@latest/dist/style/style-components.min.css" /> -->
<script type="text/javascript">
</script>
</head>
<body>
<div id="loading">
<img alt="Loading..." id="loading-image" src="../img/spinner1.gif"/>
</div>
<div class="page-wrapper toggled" id="wrapper">
<div id="sidebar-wrapper">
<html><body><div class="card-header title-heading">فصول الكتاب</div><ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head0"></a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head1">1- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head2">2- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head3">أسعد أم سعيد </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head4">إن الحديث لذو شجون </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head5">6- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head6">: أينما أوجه ألق سعدا </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head7">9- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head8">الصيف ضيعت اللبن </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head9">19- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head10">: أسرع من نكاح أم خارجة </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head11">22- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head12">: نعم وتعليت </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head13">23- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head14">حلم الأديم </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head15">27- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head16">28- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head17">: إن الليل طويل وأنت مقمر </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head18">: أضرطا وأنت الأعلى، </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head19">32- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head20">شولان البروق، </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head21">34- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head22">35- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head23">: أنجز حر ما وعد </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head24">أزمت شجعات بما فيهن </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head25">37- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head26">38- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head27">: بمثل جارية فلتزن الزانية سرا أو علانية </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head28">: عوف يرنأ في البيت </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head29">39- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head30">: حرامه يركب من لا حلال له </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head31">42- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head32">: والله لا أرعاها سن الحسل، </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head33">46- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head34">رمتني بدائها وانسلت </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head35">47- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head36">: تلك بتلك فهل جزيتك </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head37">48- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head38">: وأهل عمرو قد أضلوه </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head39">70- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head40">71- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head41">: ذكرني فوك حماري أهلي </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head42">ولو بأحد المغروين؛ </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head43">72- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head44">عرفتني نسأها الله </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head45">73- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head46">يداك أوكتا وفوك نفخ </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head47">74- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head48">75- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head49">يا حبذا المنتعلون قياما </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head50">: إذا رمت الباطل أنجح بك </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head51">76- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head52">77- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head53">78- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head54">: ذل لو أجد ناصرا </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head55">: لو نهى عن الأولى لم يعد للآخرة </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head56">ملكت فأسجح </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head57">80- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head58">: رويد الغزو ينمرق </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head59">82- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head60">: أصبح ليل </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head61">84- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head62">: صكا ودرهماك لك، لا أفلح من أعجلك </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head63">85- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head64">: من عز بز </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head65">86- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head66">: قد نراك فلست بشيء </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head67">87- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head68">: أعن صبوح ترقق </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head69">89- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head70">: قد أنصف القارة من راماها </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head71">91- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head72">: اليوم خمر وغدا أمر </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head73">93- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head74">94- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head75">95- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head76">: خلع الدرع بيد الزوج </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head77">: إن التجريد لغير نكاح مثلة </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head78">: بخ بخ ساق بخلخال </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head79">106- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head80">: إذا عز أخوك فهن </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head81">107- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head82">108- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head83">109- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head84">: رب عجلة تهب ريثا </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head85">ورب فروقة يدعى ليثا </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head86">ورب غيث لم يكن غيثا </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head87">113- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head88">: ازلأم المعدي ونفر </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head89">114- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head90">: القيد والرتعة </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head91">115- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head92">؟ مالي بين بني </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head93">135- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head94">: بسلاح ما يقتلن القتيل </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head95">155- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head96">: قد يضرط العير والمكواة في النار </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head97">156- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head98">: من سره بنوه ساءته نفسه </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head99">157- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head100">؛ ابنك من دمى عقبيك </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head101">158- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head102">نفس عصام سودت عصاما </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head103">160- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head104">: اقلب قلاب </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head105">161- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head106">يوم كيوم القسطل </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head107">162- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head108">163- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head109">: تنهانا أمنا عن الغي وتغدو فيه </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head110">صغراهن مراهن </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head111">165- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head112">ما يوم حليمة بسر </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head113">166- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head114">167- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head115">: أساء سمعا فأساء إجابة </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head116">: أشبه امرؤ بعض بزه </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head117">169- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head118">اليك يساق الحديث </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head119">171- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head120">: نعم ويدعو أباه </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head121">175- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head122">: نعم كلب من بؤس أهله </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head123">176- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head124">كالطاحنة </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head125">178- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head126">؛ استنوق الجمل </a>
</li>
</ul>
</body></html></div>
<div class="book body-inner" lang="ara">
<nav class="navbar navbar-expand-lg navbar-light bg-light sticky-top border-bottom" style="direction: ltr;">
<div class="mr-auto d-flex justify-content-left">
<a class="navbar-brand ms-2" href="http://www.kitab-project.org" target="_blank">
<img class="d-inline-block align-top" src="https://cdn.jsdelivr.net/gh/sohailmerchant/kitab-cdn@main/img/kitab-logo.png" width="60px"/>
</a>
</div>
<div class="navbar-nav mx-auto btn-toolbar" style="direction: rtl;">
<div class="d-flex justify-content-center">
<form class="row" id="nav-form" style="margin-bottom: 0px;">
<span class="btn col justify-content-center">ج:</span>
<select class="col form-select pull-left" id="vol-select"></select>
<span class="btn col justify-content-center">ص:</span>
<select class="col form-select pull-left" id="page-select"></select>
<button class="btn col pull-right mx-3" id="nav-submdit-btn" style="width: 100px;" type="submit" value="Go">Go</button>
</form>
</div>
</div>
<div class="btn-toolbar navbar-nav ml-auto d-flex justify-content-right">
<div class="btn-group">
<a class="nav-link pull-right" title="Go to top">
<i class="btn bi bi-arrow-up-circle" id="back-to-top"></i>
</a>
<a class="nav-link pull-right" title="Increase fonts">
<i class="btn bi bi-fonts font-default pull-left"></i>
</a>
<a class="nav-link pull-right" title="Turn light off">
<i class="btn bi bi-lightbulb-off"></i>
</a>
<div class="nav-link pull-right dropdown">
<a aria-expanded="false" aria-haspopup="true" class="" data-bs-toggle="dropdown" id="dropdownMenuButton" role="button" title="Book Metadata">
<i class="btn bi bi-info"></i>
</a>
<div aria-labelledby="dropdownMenuButton" class="dropdown-menu">
<div class="col-12" id="metadata-content"><label>char_length: 145332</label><label>author_lat_full_name: </label><label>author_lat_shuhra: </label><label>author_from_uri: Mufaddal Dabbi</label><label>tags: _ADAB :: _BALAGHA :: GAL@period-classical :: GAL@literature-islamic :: GAL@0750-1000CE :: GAL@literature-arabic :: GAL@philology :: Shamela@الأدب والبلاغة</label><label>url: https://raw.githubusercontent.com/OpenITI/0175AH/master/data/0168MufaddalDabbi/0168MufaddalDabbi.AmthalCarab/0168MufaddalDabbi.AmthalCarab.Shamela0009081-ara2</label><label>tok_length: 35811</label><label>status: sec</label><label>id: Shamela0009081</label><label>ed_info: دار ومكتبة الهلال، بيروت</label><label>title_lat: Amthal Carab</label><label>title_ar: أمثال العرب</label><label>book: 0168MufaddalDabbi.AmthalCarab</label><label>author_lat: Mufaddal Dabbi</label><label>author_ar: المفضل بن محمد بن يعلى بن سالم الضبي (المتوفى: نحو 168هـ)</label><label>date: 0168</label><label>versionUri: 0168MufaddalDabbi.AmthalCarab.Shamela0009081-ara2</label>
</div>
</div>
</div>
<a class="nav-link pull-right" href="#menu-toggle" id="menu-toggle" title="Book Chapters">
<i class="btn bi bi-list"></i></a>
</div>
</div>
</nav>
<div class="book-body fixed pt-5">
<div class="row">
<div class="col-12">
<div class="row top-heading-panel content-outer-spacing">
</div>
</div>
<div class="col-12" id="meta">
</div>
</div>
<div class="row justify-content-md-center" id="book-main">
<div class="col-lg-8 col-sm-12" id="content">
</div>
</div>
<div class="row mt-5" id="footer">
<div class="col-md-12">
            The KITAB project is based at the Institute for the Study of Muslim Civilizations (ISMC) at Aga Khan
            University, London, and has received funding from the European Research Council (ERC) under the European
            Union's
            Horizon 2020 research and innovation programme (Grant agreement No. 772989)

          </div>
<div class="col-md-12">
<img alt="Logos" height="50" id="logos" src="../img/AKU-EU-ERC-three-logos.jpg"/>
</div>
</div>
</div>
</div>
</div>
<script>

    var pageSel = document.getElementById("page-select");
    var volSel = document.getElementById("vol-select");
    var thisVolume = "01";
    var volPages = {"01": ["005", "006", "007", "008", "009", "010", "011", "012", "013", "014", "015", "016", "017", "018", "019", "020", "021", "022", "023", "024", "025", "026", "027", "028", "029", "030", "031", "032", "033", "034", "035", "036", "037", "038", "039", "040", "041", "042", "043", "044", "045", "046", "047", "048", "049", "050", "051", "052", "053", "054", "055", "056", "057", "058", "059", "060", "061", "062", "063", "064", "065", "066", "067", "068", "069", "070", "071", "072", "073", "074", "075", "076", "077", "078", "079", "080", "081", "082", "083", "084", "085", "086", "087", "088", "089", "090", "091", "092", "093", "094", "095", "096", "097", "098", "099", "100", "101", "102", "103", "104", "105", "106", "107", "108", "109", "110", "111", "112", "113", "114", "115", "116", "117", "118", "119", "120", "121", "122", "123", "124", "125", "126", "127", "128", "129", "130", "131", "132", "133", "134", "135", "136", "137", "138", "139", "140", "141", "142", "143", "144", "145", "146", "147", "148", "149", "150", "151", "153", "154", "155", "156", "157", "158", "159", "160"]}; /*loaded by html_builder*/

    function goToAnchor(vol, anchorId) {
      if (vol != window.thisVolume) {
        loadVolume(vol, false).then(res => {
          console.log("Volume loaded");
          console.log("Go to anchor " + anchorId);
          /*move the volume page to the element with id=anchorId*/
          /*var targetAnchor = document.getElementById(anchorId);
          targetAnchor.scrollIntoView({block: 'nearest'});  // this does not always work...
          console.log(targetAnchor);*/
          /*window.location.hash = "";
          window.location.hash = anchorId;
          window.location.hash = anchorId;
          console.log("#"+anchorId);*/
          /*//This approach does not work at all: scrolls only main window.
          var targetAnchor = $("#"+anchorId);
          //$("#content").animate(
          $("html, body").animate(
            {scrollTop: targetAnchor.offset().top},
            1000
          );*/
          /*//This approach does not work at all: scrolls only main window.
          var targetAnchor = document.getElementById(anchorId);
          var rect = targetAnchor.getBoundingClientRect();
          console.log(targetAnchor);
          console.log(rect);
          var viewHeight=Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
          window.scroll({
            top: rect.top + rect.height / 2 - viewHeight /2,
            behavior: 'smooth'
          });*/
          /*var targetAnchor = document.getElementById(anchorId);
          var contentDiv = document.getElementsByClassName("book-body")[0];
          var topPos = contentDiv.offsetTop;
          var windowSize = $(window).height();
          console.log("topPos: " + topPos);
          console.log("targetPos: " + targetAnchor.offsetTop);
          console.log("windowSize:" + windowSize)
          console.log("targetAnchor.offsetTop-windowSize/3 = " + (targetAnchor.offsetTop - topPos - windowSize / 2));
          contentDiv.scrollTop = targetAnchor.offsetTop - topPos - windowSize / 2;*/
          var targetAnchor = document.getElementById(anchorId);
          targetAnchor.scrollIntoView({"block": "start"});
        });
      } else {
        /*move the volume page to the element with id=anchorId*/
        /*var targetAnchor = document.getElementById(anchorId);
        targetAnchor.scrollIntoView({block: 'nearest'});  // this does not always work...
        console.log(targetAnchor);*/
        /*window.location.hash = "";
        window.location.hash = anchorId;
        window.location.hash = anchorId;
        console.log("#"+anchorId);*/
        /*//This approach does not work at all: scrolls only main window.
        var targetAnchor = $("#"+anchorId);
        //$("#content").animate(
        $("html, body").animate(
          {scrollTop: targetAnchor.offset().top},
          1000
        );*/
        /*//This approach does not work at all: scrolls only main window.
        var targetAnchor = document.getElementById(anchorId);
        var rect = targetAnchor.getBoundingClientRect();
        console.log(targetAnchor);
        console.log(rect);
        var viewHeight=Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
        window.scroll({
          top: rect.top + rect.height / 2 - viewHeight /2,
          behavior: 'smooth'
        });*/
        /*var targetAnchor = document.getElementById(anchorId);
        var contentDiv = document.getElementsByClassName("book-body")[0];
        var topPos = contentDiv.offsetTop;
        var windowSize = $(window).height();
        console.log("topPos: " + topPos);
        console.log("targetPos: " + targetAnchor.offsetTop);
        console.log("windowSize:" + windowSize)
        console.log("targetAnchor.offsetTop-windowSize/3 = " + (targetAnchor.offsetTop - topPos - windowSize / 2));
        contentDiv.scrollTop = targetAnchor.offsetTop - topPos - windowSize / 2;*/
        var targetAnchor = document.getElementById(anchorId);
        targetAnchor.scrollIntoView({"block": "start"});
      }
    }

    CollapsibleLists.apply();
    console.log("Applied CollapsibleLists");

    $(document).ready(function () {
      console.log("Load initial volume " + thisVolume);
      loadVolume(thisVolume).then(res => {
        console.log("Initial volume loaded");
        $('#loading').hide();
        $('#loading').fadeOut("slow");
      });
      $(window).scroll(function () {
        if ($(this).scrollTop() > 50) {
          $('#back-to-top').fadeIn();
        } else {
          $('#back-to-top').fadeOut();
        }
      });
      // scroll body to 0px on click
      $('#back-to-top').click(function () {
        $('body,html').animate({
          scrollTop: 0
        }, 400);
        return false;
      });
      $("#menu-toggle").click(function (e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled");
      });

      $(".font-default").click(function () {

        $('#wrapper').toggleClass("font-increase", "font-default");
      });

      $(".bi-lightbulb-off").click(function () {
        $('.bi-lightbulb-off').toggleClass("bi-lightbulb", "bi-lightbulb-off");
        $('.page-wrapper').toggleClass("night-mode", "");
        $('.navbar-light').toggleClass("night-mode", "");
        console.log(this);

      });
      $('.toc-item').click(function (event) {
        /*console.log('toc item clicked');*/
        event.preventDefault();
        var clickedElement = event.target;
        /*console.log(clickedElement);*/
        var href = clickedElement.getAttribute("href");
        /*console.log('href: '+href);*/
        var vol = href.substring(0, 2);
        var head = href.split('head').pop();
        var anchorId = "head" + head;
        goToAnchor(vol, anchorId);
        return false;
      });
    });

    function loadPageNumbers(vol, page) {
      /*var pageSel = document.getElementById("page-select");*/
      pageSel.innerHTML = '';
      volPages[vol].forEach(function (p, index) {
        pageSel.options[pageSel.options.length] = new Option(p, p);
      });
      if (page) {
        pageSel.value = page;
      }
    }

    function loadVolumeNumbers(vol) {
      /*var volSel = document.getElementById("vol-select");*/
      volSel.innerHTML = '';
      /*console.log(Object.keys(volPages));*/
      /*console.log(Object.keys(volPages).sort());*/

      Object.keys(volPages).sort().forEach(function (v, index) {
        /*console.log(v);*/
        volSel.options[volSel.options.length] = new Option(v, v);
      });
      volSel.value = vol;
    }

    async function loadVolume(vol) {
      /*Load volume json */
      var page = pageSel.value;
      $('#loading').show();
      console.log("loading volume " + vol);
      await $.getJSON(vol + ".json", function (json) {
        console.log(json)
        $('#content').empty().append(json["content"]);
        /*console.log("json loaded");*/
        window.thisVolume = vol;
        $('#loading').hide();
        $('#loading').fadeOut("slow");
        /*Load volume and page numbers in page-nav form:*/
        loadVolumeNumbers(vol);
        loadPageNumbers(vol, page);
        return true;
      });
    }


    function padWithZeros(number, width) {
      number = number + "";
      if (number.length >= width) {
        return number;
      } else {
        return new Array(width - number.length + 1).join("0") + number;
      }
    }
    document.getElementById("nav-form").addEventListener("submit", function (event) {
      event.preventDefault();
      /*console.log("Clicked Go");*/
      var vol = volSel.value;
      console.log("vol: " + vol);
      /*var targetPage = parseInt(pageSel.value, 10);
      if (page >= 1) {
        page = page-1; //page number is at bottom of page
      }
      var anchor = "v"+vol+"p"+padWithZeros(targetPage, 3);*/
      var targetPage = pageSel.value;
      var pages = volPages[vol];
      var index = pages.indexOf(targetPage);
      if (index > 0) {
        targetPage = pages[index-1];
      }

      console.log("targetPage: " + targetPage);
      var anchor = "v" + vol + "p" + targetPage;
      goToAnchor(vol, anchor);
      return false;
    });

    /*Adapt the page numbers list when the volume number changes:*/
    volSel.addEventListener("change", function (event) {
      var vol = this.value;
      var page = pageSel.value;
      loadPageNumbers(vol, page);
    });


  </script>
</body>
</html>
