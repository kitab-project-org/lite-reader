<html dir="rtl" lang="ar">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta http-equiv="Content-Security-Policy" https:=""/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script crossorigin="anonymous" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js"></script>
<link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" rel="stylesheet"/>
<link href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Amiri&amp;display=swap" rel="stylesheet"/>
<!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css"
        integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous"> -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css" rel="stylesheet"/>
<link crossorigin="anonymous" href="../css/stylev2.css" rel="stylesheet" type="text/css"/>
<script crossorigin="anonymous" src="../js/CollapsibleLists.js" type="application/javascript"></script>
<!-- <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/alpheios-components@latest/dist/style/style-components.min.css" /> -->
<script type="text/javascript">
</script>
</head>
<body>
<div id="loading">
<img alt="Loading..." id="loading-image" src="../img/spinner1.gif"/>
</div>
<div class="page-wrapper toggled" id="wrapper">
<div id="sidebar-wrapper">
<html><body><div class="card-header title-heading">فصول الكتاب</div><ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head0">AUTO باب القضاء وما يتعلق به</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head1">AUTO (فصل في معرفة اركان القضآء)</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head2">AUTO (فصل في رفع المدعى عليه وما يتعلق بذلك)</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head3">AUTO (فصل في المقال والجواب)</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head4">AUTO (فصل في الاجال)</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head5">AUTO فصل في الإعذار</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head6">AUTO فصل في خطاب القضاة وما يتعلق به</a>
</li>
</ul>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head7">AUTO باب الشهود وأنواع الشهادات</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head8">AUTO فصل في مسائل من الشهادات</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head9">AUTO فصل في أنواع الشهادات</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head10">AUTO فصل في شهادة السماع</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head11">AUTO فصل في مسائل من الشهادات</a>
</li>
</ul>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head12">AUTO باب اليمين وما يتعلق بها</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head13">AUTO باب الرهن وما يتعلق به</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head14">AUTO باب الضمان وما يتعلق به</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head15">AUTO باب الوكالة وما يتعلق بها</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head16">AUTO فصل في تداعي الموكل والوكيل</a>
</li>
</ul>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head17">AUTO باب الصلح وما يتعلق به</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head0">AUTO باب في النكاح وما يتعلق به</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l2" href="02.html#head1">AUTO (فصل في الأولياء ومن له الولاية)</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="02.html#head2">AUTO (فصل فيمن له الإجبار)</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="02.html#head3">AUTO (فصل في فاسد ms248 النكاح وما يتعلق به)</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="02.html#head4">AUTO (فصل في مسائل من النكاح)</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="02.html#head5">AUTO (فصل في تداعي الزوجين وما يلحق به)</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="02.html#head6">AUTO (فصل في الاختلاف في القبض)</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="02.html#head7">AUTO (فصل فيما يهديه الزوج ثم يقع الطلاق)</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="02.html#head8">AUTO (فصل في الاختلاف في الشوار المورد بيت البناء)</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="02.html#head9">AUTO (فصل في الاختلاف في متاع البيت)</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="02.html#head10">AUTO فصل في إثبات الضرر والقيام به وبعث الحكمين</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="02.html#head11">AUTO (فصل في الرضاع)</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="02.html#head12">AUTO (فصل في عيوب الزوجين وما يردان به)</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="02.html#head13">AUTO (فصل في الإيلاء والظهار)</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="02.html#head14">AUTO (فصل في اللعان)</a>
</li>
</ul>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head15">AUTO (باب الطلاق والرجعة وما يتعلق بهما)</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l2" href="02.html#head16">AUTO (فصل)</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="02.html#head17">AUTO (فصل)</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="02.html#head18">AUTO (فصل)</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="02.html#head19">AUTO (فصل)</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="02.html#head20">AUTO (فصل في التداعي في الطلاق)</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="02.html#head21">AUTO (فصل)</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="02.html#head22">AUTO (فصل في المراجعة)</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="02.html#head23">AUTO (فصل)</a>
</li>
</ul>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head24">AUTO (باب النفقة وما يتعلق بها)</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l2" href="02.html#head25">AUTO (فصل في التداعي في النفقة)</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="02.html#head26">AUTO (فصل فيما يجب للمطلقات)</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="02.html#head27">AUTO (فصل في الطلاق بالإعسار بالنفقة)</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="02.html#head28">AUTO (فصل في أحكام المفقودين)</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="02.html#head29">AUTO (فصل في الحضانة)</a>
</li>
</ul>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="03.html#head0">AUTO باب البيوع</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l2" href="03.html#head1">AUTO فصل في بيع الأصول</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="03.html#head2">AUTO فصل في بيع العروض</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="03.html#head3">AUTO فصل في حكم بيع الطعام</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="03.html#head4">AUTO فصل في بيع النقدين والحلي وشبهه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="03.html#head5">AUTO فصل في بيع الثمار وما يلحق بها</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="03.html#head6">AUTO فصل في الجائحة في ذلك</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="03.html#head7">AUTO فصل في بيع الرقيق وسائر الحيوان</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="03.html#head8">AUTO فصل</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="03.html#head9">AUTO فصل في بيع الدين والمقاصة فيه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="03.html#head10">AUTO فصل في الحوالة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="03.html#head11">AUTO فصل في بيع الخيار والثنيا</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="03.html#head12">AUTO فصل في بيع الفضولي وما يماثله</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="03.html#head13">AUTO فصل في بيع المضغوط وما أشبهه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="03.html#head14">AUTO فصل في مسائل من أحكام البيع</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="03.html#head15">AUTO فصل</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="03.html#head16">AUTO فصل</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="03.html#head17">AUTO فصل في اختلاف المتبايعين</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="03.html#head18">AUTO {فصل في حكم البيع على الغائب}</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="03.html#head19">AUTO {فصل في العيوب}</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="03.html#head20">AUTO {فصل في الغبن}</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="03.html#head21">AUTO {فصل في الشفعة}</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="03.html#head22">AUTO {فصل في القسمة}</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="03.html#head23">AUTO {فصل في المعاوضة}</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="03.html#head24">AUTO {فصل في الاقالة}</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="03.html#head25">AUTO {فصل في التولية والتصيير}</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="03.html#head26">AUTO {فصل في السلم}</a>
</li>
</ul>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="03.html#head27">AUTO {باب الكراء وما يتصل به}</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l2" href="03.html#head28">AUTO {فصل في كراء الأرض وفي الجائحة فيه}</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="03.html#head29">AUTO {فصل في أحكام من الكراء}</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="03.html#head30">AUTO {فصل في اختلاف المكري والمكتري}</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="03.html#head31">AUTO {فصل في كراء الرواحل والسفن}</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="03.html#head32">AUTO {فصل في الإجارة}</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="03.html#head33">AUTO {فصل في الجعل}</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="03.html#head34">AUTO {فصل في المساقاة}</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="03.html#head35">AUTO {فصل في الاغتراس}</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="03.html#head36">AUTO {فصل في المزارعة}</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="03.html#head37">AUTO {فصل في الشركة}</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="03.html#head38">AUTO {فصل في القراض}</a>
</li>
</ul>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="04.html#head0">AUTO {باب الحبس والهبة والصدقة وما يتصل بها}</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l2" href="04.html#head1">AUTO {فصل في الصدقة والهبة وما يتعلق بهما}</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="04.html#head2">AUTO {فصل في الاعتصار}</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="04.html#head3">AUTO {فصل في العمرى وما يلحق بها}</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="04.html#head4">AUTO {فصل في الإرفاق}</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="04.html#head5">AUTO {فصل في حكم الحوز}</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="04.html#head6">AUTO {فصل في الاسىتحقاق}</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="04.html#head7">AUTO {فصل في العادية والوديعة والأمناء}</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="04.html#head8">AUTO {فصل في القرض وهو السلف}</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="04.html#head9">AUTO {فصل في العتق وما يتصل به}</a>
</li>
</ul>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="04.html#head10">AUTO {باب الرشد}</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l2" href="04.html#head11">AUTO {فصل في الوصية وما يجري مجراها}</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="04.html#head12">AUTO {فصل في الإقرار}</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="04.html#head13">AUTO *فصل في حكم المديان*</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="04.html#head14">AUTO *فصل في الفلس*</a>
</li>
</ul>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="04.html#head15">AUTO *باب في الضرر وسائر الجنايات*</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l2" href="04.html#head16">AUTO *فصل في ضرر الأشجار*</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="04.html#head17">AUTO *فصل في نسقط القيام بالضرر*</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="04.html#head18">AUTO *فصل في الغصب والتعدي*</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="04.html#head19">AUTO *فصل في الاغتصاب*</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="04.html#head20">AUTO *فصل في دعوى السرقة*</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="04.html#head21">AUTO *فصل في أحكام الدماء*</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="04.html#head22">AUTO *فصل في الجراحات*</a>
</li>
</ul>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="04.html#head23">AUTO *باب التوارث والفرائض*</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l2" href="04.html#head24">AUTO *فصل في ذكر عدد الوارثين*</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="04.html#head25">AUTO *فصل في ذكر أحوال الميراث*</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="04.html#head26">AUTO *فصل في المقدار الذي يكون به الإرث*</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="04.html#head27">AUTO *فصل في ذكر حالات وجوب الميراث*</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="04.html#head28">AUTO *فصل في ذكر أهل الفرائض وأصولها*</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="04.html#head29">AUTO *فصل في ذكر حجب الإسقاط*</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="04.html#head30">AUTO *فصل في ذكر حجب النقل إلى فرض*</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="04.html#head31">AUTO *فصل في ذكر حجب النقل للتعصيب*</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="04.html#head32">AUTO *فصل في موانع الميراث*</a>
</li>
</ul>
</li>
</ul>
</body></html></div>
<div class="book body-inner" lang="ara">
<nav class="navbar navbar-expand-lg navbar-light bg-light sticky-top border-bottom" style="direction: ltr;">
<div class="mr-auto d-flex justify-content-left">
<a class="navbar-brand ms-2" href="http://www.kitab-project.org" target="_blank">
<img class="d-inline-block align-top" src="https://cdn.jsdelivr.net/gh/sohailmerchant/kitab-cdn@main/img/kitab-logo.png" width="60px"/>
</a>
</div>
<div class="navbar-nav mx-auto btn-toolbar" style="direction: rtl;">
<div class="d-flex justify-content-center">
<form class="row" id="nav-form" style="margin-bottom: 0px;">
<span class="btn col justify-content-center">ج:</span>
<select class="col form-select pull-left" id="vol-select"></select>
<span class="btn col justify-content-center">ص:</span>
<select class="col form-select pull-left" id="page-select"></select>
<button class="btn col pull-right mx-3" id="nav-submdit-btn" style="width: 100px;" type="submit" value="Go">Go</button>
</form>
</div>
</div>
<div class="btn-toolbar navbar-nav ml-auto d-flex justify-content-right">
<div class="btn-group">
<a class="nav-link pull-right" title="Go to top">
<i class="btn bi bi-arrow-up-circle" id="back-to-top"></i>
</a>
<a class="nav-link pull-right" title="Increase fonts">
<i class="btn bi bi-fonts font-default pull-left"></i>
</a>
<a class="nav-link pull-right" title="Turn light off">
<i class="btn bi bi-lightbulb-off"></i>
</a>
<div class="nav-link pull-right dropdown">
<a aria-expanded="false" aria-haspopup="true" class="" data-bs-toggle="dropdown" id="dropdownMenuButton" role="button" title="Book Metadata">
<i class="btn bi bi-info"></i>
</a>
<div aria-labelledby="dropdownMenuButton" class="dropdown-menu">
<div class="col-12" id="metadata-content"><label>char_length: 902590</label><label>author_lat_full_name: </label><label>author_lat_shuhra: </label><label>author_from_uri: Tawzari</label><label>tags:  :: Sham@فقه مالكي</label><label>url: https://raw.githubusercontent.com/OpenITI/1350AH/master/data/1338Tawzari/1338Tawzari.TawdihAhkam/1338Tawzari.TawdihAhkam.Sham19Y0133369-ara1</label><label>tok_length: 218669</label><label>status: pri</label><label>id: Sham19Y0133369</label><label>ed_info: الأولى، 1339 ه :: المطبعة التونسية</label><label>title_lat: Tawdih Ahkam</label><label>title_ar: توضيح الأحكام شرح تحفة الحكام</label><label>book: 1338Tawzari.TawdihAhkam</label><label>author_lat: Tawzari</label><label>author_ar: عثمان بن المكي التوزري الزبيدي :: التوزري</label><label>date: 1338</label><label>versionUri: 1338Tawzari.TawdihAhkam.Sham19Y0133369-ara1</label>
</div>
</div>
</div>
<a class="nav-link pull-right" href="#menu-toggle" id="menu-toggle" title="Book Chapters">
<i class="btn bi bi-list"></i></a>
</div>
</div>
</nav>
<div class="book-body fixed pt-5">
<div class="row">
<div class="col-12">
<div class="row top-heading-panel content-outer-spacing">
</div>
</div>
<div class="col-12" id="meta">
</div>
</div>
<div class="row justify-content-md-center" id="book-main">
<div class="col-lg-8 col-sm-12" id="content">
</div>
</div>
<div class="row mt-5" id="footer">
<div class="col-md-12">
            The KITAB project is based at the Institute for the Study of Muslim Civilizations (ISMC) at Aga Khan
            University, London, and has received funding from the European Research Council (ERC) under the European
            Union's
            Horizon 2020 research and innovation programme (Grant agreement No. 772989)

          </div>
<div class="col-md-12">
<img alt="Logos" height="50" id="logos" src="../img/AKU-EU-ERC-three-logos.jpg"/>
</div>
</div>
</div>
</div>
</div>
<script>

    var pageSel = document.getElementById("page-select");
    var volSel = document.getElementById("vol-select");
    var thisVolume = "01";
    var volPages = {"01": ["001", "002", "003", "004", "005", "006", "007", "008", "009", "010", "011", "012", "013", "014", "015", "016", "017", "018", "019", "020", "021", "022", "023", "024", "025", "026", "027", "028", "029", "030", "031", "032", "033", "034", "035", "036", "037", "038", "039", "040", "041", "042", "043", "044", "045", "046", "047", "048", "049", "050", "051", "052", "053", "054", "055", "056", "057", "058", "059", "060", "061", "062", "063", "064", "065", "066", "067", "068", "069", "070", "071", "072", "073", "074", "075", "076", "077", "078", "079", "080", "081", "082", "083", "084", "085", "086", "087", "088", "089", "090", "091", "092", "093", "094", "095", "096", "097", "098", "099", "100", "101", "102", "103", "104", "105", "106", "107", "108", "109", "110", "111", "112", "113", "114", "115", "116", "117", "118", "119", "120", "121", "122", "123", "124", "125", "126", "127", "128", "129", "130", "131", "132", "133", "134", "135", "136", "137", "138", "139", "140", "141", "142", "143", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "162", "163", "164", "165", "166", "167", "168", "169", "170", "171", "172", "173", "174", "175", "176", "177", "178", "179", "180", "181", "182", "183", "184", "185", "186", "187", "188", "189", "190", "191", "192", "193", "194", "195", "196", "197", "198", "199", "200", "201", "202", "203", "204", "205", "206", "207", "208", "209", "210"], "02": ["001", "002", "003", "004", "005", "006", "007", "008", "009", "010", "011", "012", "013", "014", "015", "016", "017", "018", "019", "020", "021", "022", "023", "024", "025", "026", "027", "028", "029", "030", "031", "032", "033", "034", "035", "036", "037", "038", "039", "040", "041", "042", "043", "044", "045", "046", "047", "048", "049", "050", "051", "052", "053", "054", "055", "056", "057", "058", "059", "060", "061", "062", "063", "064", "065", "066", "067", "068", "069", "070", "071", "072", "073", "074", "075", "076", "077", "078", "079", "080", "081", "082", "083", "084", "085", "086", "087", "088", "089", "090", "091", "092", "093", "094", "095", "096", "097", "098", "099", "100", "101", "102", "103", "104", "105", "106", "107", "108", "109", "110", "111", "112", "113", "114", "115", "116", "117", "118", "119", "120", "121", "122", "123", "124", "125", "126", "127", "128", "129", "130", "131", "132", "133", "134", "135", "136", "137", "138", "139", "140", "141", "142", "143", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "162", "163", "164", "165", "166", "167", "168", "169", "170", "171", "172", "173", "174", "175", "176", "177", "178", "179", "180", "181", "182"], "03": ["001", "002", "003", "004", "005", "006", "007", "008", "009", "010", "011", "012", "013", "014", "015", "016", "017", "018", "019", "020", "021", "022", "023", "024", "025", "026", "027", "028", "029", "030", "031", "032", "033", "034", "035", "036", "037", "038", "039", "040", "041", "042", "043", "044", "045", "046", "047", "048", "049", "050", "051", "052", "053", "054", "055", "056", "057", "058", "059", "060", "061", "062", "063", "064", "065", "066", "067", "068", "069", "070", "071", "072", "073", "074", "075", "076", "077", "078", "079", "080", "081", "082", "083", "084", "085", "086", "087", "088", "089", "090", "091", "092", "093", "094", "095", "096", "097", "098", "099", "100", "101", "102", "103", "104", "105", "106", "107", "108", "109", "110", "111", "112", "113", "114", "115", "116", "117", "118", "119", "120", "121", "122", "123", "124", "125", "126", "127", "128", "129", "130", "131", "132", "133", "134", "135", "136", "137", "138", "139", "140", "141", "142", "143", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "162", "163", "164", "165", "166", "167", "168", "169", "170", "171", "172", "173", "174", "175", "176", "177", "178", "179", "180", "181", "182", "183", "184", "185", "186", "187", "188", "189", "190", "191", "192", "193", "194", "195"], "04": ["001", "002", "003", "004", "005", "006", "007", "008", "009", "010", "011", "012", "013", "014", "015", "016", "017", "018", "019", "020", "021", "022", "023", "024", "025", "026", "027", "028", "029", "030", "031", "032", "033", "034", "035", "036", "037", "038", "039", "040", "041", "042", "043", "044", "045", "046", "047", "048", "049", "050", "051", "052", "053", "054", "055", "056", "057", "058", "059", "060", "061", "062", "063", "064", "065", "066", "067", "068", "069", "070", "071", "072", "073", "074", "075", "076", "077", "078", "079", "080", "081", "082", "083", "084", "085", "086", "087", "088", "089", "090", "091", "092", "093", "094", "095", "096", "097", "098", "099", "100", "101", "102", "103", "104", "105", "106", "107", "108", "109", "110", "111", "112", "113", "114", "115", "116", "117", "118", "119", "120", "121", "122", "123", "124", "125", "126", "127", "128", "129", "130", "131", "132", "133", "134", "135", "136", "137", "138", "139", "140", "141", "142", "143", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "162", "163", "164", "165", "166", "167", "168", "169", "170", "171", "172"]}; /*loaded by html_builder*/

    function goToAnchor(vol, anchorId) {
      if (vol != window.thisVolume) {
        loadVolume(vol, false).then(res => {
          console.log("Volume loaded");
          console.log("Go to anchor " + anchorId);
          /*move the volume page to the element with id=anchorId*/
          /*var targetAnchor = document.getElementById(anchorId);
          targetAnchor.scrollIntoView({block: 'nearest'});  // this does not always work...
          console.log(targetAnchor);*/
          /*window.location.hash = "";
          window.location.hash = anchorId;
          window.location.hash = anchorId;
          console.log("#"+anchorId);*/
          /*//This approach does not work at all: scrolls only main window.
          var targetAnchor = $("#"+anchorId);
          //$("#content").animate(
          $("html, body").animate(
            {scrollTop: targetAnchor.offset().top},
            1000
          );*/
          /*//This approach does not work at all: scrolls only main window.
          var targetAnchor = document.getElementById(anchorId);
          var rect = targetAnchor.getBoundingClientRect();
          console.log(targetAnchor);
          console.log(rect);
          var viewHeight=Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
          window.scroll({
            top: rect.top + rect.height / 2 - viewHeight /2,
            behavior: 'smooth'
          });*/
          /*var targetAnchor = document.getElementById(anchorId);
          var contentDiv = document.getElementsByClassName("book-body")[0];
          var topPos = contentDiv.offsetTop;
          var windowSize = $(window).height();
          console.log("topPos: " + topPos);
          console.log("targetPos: " + targetAnchor.offsetTop);
          console.log("windowSize:" + windowSize)
          console.log("targetAnchor.offsetTop-windowSize/3 = " + (targetAnchor.offsetTop - topPos - windowSize / 2));
          contentDiv.scrollTop = targetAnchor.offsetTop - topPos - windowSize / 2;*/
          var targetAnchor = document.getElementById(anchorId);
          targetAnchor.scrollIntoView({"block": "start"});
        });
      } else {
        /*move the volume page to the element with id=anchorId*/
        /*var targetAnchor = document.getElementById(anchorId);
        targetAnchor.scrollIntoView({block: 'nearest'});  // this does not always work...
        console.log(targetAnchor);*/
        /*window.location.hash = "";
        window.location.hash = anchorId;
        window.location.hash = anchorId;
        console.log("#"+anchorId);*/
        /*//This approach does not work at all: scrolls only main window.
        var targetAnchor = $("#"+anchorId);
        //$("#content").animate(
        $("html, body").animate(
          {scrollTop: targetAnchor.offset().top},
          1000
        );*/
        /*//This approach does not work at all: scrolls only main window.
        var targetAnchor = document.getElementById(anchorId);
        var rect = targetAnchor.getBoundingClientRect();
        console.log(targetAnchor);
        console.log(rect);
        var viewHeight=Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
        window.scroll({
          top: rect.top + rect.height / 2 - viewHeight /2,
          behavior: 'smooth'
        });*/
        /*var targetAnchor = document.getElementById(anchorId);
        var contentDiv = document.getElementsByClassName("book-body")[0];
        var topPos = contentDiv.offsetTop;
        var windowSize = $(window).height();
        console.log("topPos: " + topPos);
        console.log("targetPos: " + targetAnchor.offsetTop);
        console.log("windowSize:" + windowSize)
        console.log("targetAnchor.offsetTop-windowSize/3 = " + (targetAnchor.offsetTop - topPos - windowSize / 2));
        contentDiv.scrollTop = targetAnchor.offsetTop - topPos - windowSize / 2;*/
        var targetAnchor = document.getElementById(anchorId);
        targetAnchor.scrollIntoView({"block": "start"});
      }
    }

    CollapsibleLists.apply();
    console.log("Applied CollapsibleLists");

    $(document).ready(function () {
      console.log("Load initial volume " + thisVolume);
      loadVolume(thisVolume).then(res => {
        console.log("Initial volume loaded");
        $('#loading').hide();
        $('#loading').fadeOut("slow");
      });
      $(window).scroll(function () {
        if ($(this).scrollTop() > 50) {
          $('#back-to-top').fadeIn();
        } else {
          $('#back-to-top').fadeOut();
        }
      });
      // scroll body to 0px on click
      $('#back-to-top').click(function () {
        $('body,html').animate({
          scrollTop: 0
        }, 400);
        return false;
      });
      $("#menu-toggle").click(function (e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled");
      });

      $(".font-default").click(function () {

        $('#wrapper').toggleClass("font-increase", "font-default");
      });

      $(".bi-lightbulb-off").click(function () {
        $('.bi-lightbulb-off').toggleClass("bi-lightbulb", "bi-lightbulb-off");
        $('.page-wrapper').toggleClass("night-mode", "");
        $('.navbar-light').toggleClass("night-mode", "");
        console.log(this);

      });
      $('.toc-item').click(function (event) {
        /*console.log('toc item clicked');*/
        event.preventDefault();
        var clickedElement = event.target;
        /*console.log(clickedElement);*/
        var href = clickedElement.getAttribute("href");
        /*console.log('href: '+href);*/
        var vol = href.substring(0, 2);
        var head = href.split('head').pop();
        var anchorId = "head" + head;
        goToAnchor(vol, anchorId);
        return false;
      });
    });

    function loadPageNumbers(vol, page) {
      /*var pageSel = document.getElementById("page-select");*/
      pageSel.innerHTML = '';
      volPages[vol].forEach(function (p, index) {
        pageSel.options[pageSel.options.length] = new Option(p, p);
      });
      if (page) {
        pageSel.value = page;
      }
    }

    function loadVolumeNumbers(vol) {
      /*var volSel = document.getElementById("vol-select");*/
      volSel.innerHTML = '';
      /*console.log(Object.keys(volPages));*/
      /*console.log(Object.keys(volPages).sort());*/

      Object.keys(volPages).sort().forEach(function (v, index) {
        /*console.log(v);*/
        volSel.options[volSel.options.length] = new Option(v, v);
      });
      volSel.value = vol;
    }

    async function loadVolume(vol) {
      /*Load volume json */
      var page = pageSel.value;
      $('#loading').show();
      console.log("loading volume " + vol);
      await $.getJSON(vol + ".json", function (json) {
        console.log(json)
        $('#content').empty().append(json["content"]);
        /*console.log("json loaded");*/
        window.thisVolume = vol;
        $('#loading').hide();
        $('#loading').fadeOut("slow");
        /*Load volume and page numbers in page-nav form:*/
        loadVolumeNumbers(vol);
        loadPageNumbers(vol, page);
        return true;
      });
    }


    function padWithZeros(number, width) {
      number = number + "";
      if (number.length >= width) {
        return number;
      } else {
        return new Array(width - number.length + 1).join("0") + number;
      }
    }
    document.getElementById("nav-form").addEventListener("submit", function (event) {
      event.preventDefault();
      /*console.log("Clicked Go");*/
      var vol = volSel.value;
      console.log("vol: " + vol);
      /*var targetPage = parseInt(pageSel.value, 10);
      if (page >= 1) {
        page = page-1; //page number is at bottom of page
      }
      var anchor = "v"+vol+"p"+padWithZeros(targetPage, 3);*/
      var targetPage = pageSel.value;
      var pages = volPages[vol];
      var index = pages.indexOf(targetPage);
      if (index > 0) {
        targetPage = pages[index-1];
      }

      console.log("targetPage: " + targetPage);
      var anchor = "v" + vol + "p" + targetPage;
      goToAnchor(vol, anchor);
      return false;
    });

    /*Adapt the page numbers list when the volume number changes:*/
    volSel.addEventListener("change", function (event) {
      var vol = this.value;
      var page = pageSel.value;
      loadPageNumbers(vol, page);
    });


  </script>
</body>
</html>
