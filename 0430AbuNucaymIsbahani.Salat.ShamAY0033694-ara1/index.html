<html dir="rtl" lang="ar">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta http-equiv="Content-Security-Policy" https:=""/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script crossorigin="anonymous" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js"></script>
<link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" rel="stylesheet"/>
<link href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Amiri&amp;display=swap" rel="stylesheet"/>
<!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css"
        integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous"> -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css" rel="stylesheet"/>
<link crossorigin="anonymous" href="../css/stylev2.css" rel="stylesheet" type="text/css"/>
<script crossorigin="anonymous" src="../js/CollapsibleLists.js" type="application/javascript"></script>
<!-- <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/alpheios-components@latest/dist/style/style-components.min.css" /> -->
<script type="text/javascript">
</script>
</head>
<body>
<div id="loading">
<img alt="Loading..." id="loading-image" src="../img/spinner1.gif"/>
</div>
<div class="page-wrapper toggled" id="wrapper">
<div id="sidebar-wrapper">
<html><body><div class="card-header title-heading">فصول الكتاب</div><ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head0">AUTO باب تحريم الصلاة PageV01P063</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head1">AUTO باب الرجل يجامع امرأته وهي حائض PageV01P066</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head2">AUTO باب ما للرجل من امرأته وهي حائض PageV01P069</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head3">AUTO باب المرأة تجنب ثم تحيض PageV01P074</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head4">AUTO باب الحائض ترى الدم PageV01P075</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head5">AUTO باب ما يوجب الغسل PageV01P078</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head6">AUTO باب الرجل يجامع ثم يعود PageV01P085</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head7">AUTO باب الرجل ينام وهو جنب PageV01P087</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head8">AUTO باب من قال: يتوضأ وضوءه للصلاة PageV01P090</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head9">AUTO باب في الجنب يأكل PageV01P094</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head10">AUTO باب من قال يتوضأ PageV01P095</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head11">AUTO باب ما يكفي من الغسل PageV01P097</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head12">AUTO باب ما يكفي غسل الرأس PageV01P100</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head13">AUTO باب الجنب يغسل رأسه بالخطمي PageV01P106</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head14">AUTO باب الغسل من الجنابة PageV01P109</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head15">AUTO باب المضمضة والاستنشاق PageV01P112</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head16">AUTO باب غسل الرجل والمرأة PageV01P113</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head17">AUTO باب: يرتمس الماء PageV01P115</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head18">AUTO باب المنديل بعد الغسل PageV01P116</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head19">AUTO باب الرجل يكون معه امرأته PageV01P118</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head20">AUTO باب الرجل يجامع في النوم ولم ينزل PageV01P121</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head21">AUTO باب الرجل يستيقظ وهو يجد بللا PageV01P122</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head22">AUTO باب المرأة ترى في النوم ما يرى الرجل PageV01P124</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head23">AUTO باب كم تقعد النفساء PageV01P126</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head24">AUTO باب الجنب يقرأ القرآن PageV01P130</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head25">AUTO باب الجنب يكتب: {بسم الله الرحمن الرحيم} [الفاتحة: 1] PageV01P133</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head26">AUTO باب التيمم بالصعيد PageV01P134</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head27">AUTO باب في من لم ير التيمم PageV01P137</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head28">AUTO باب الوقت في التيمم PageV01P138</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head29">AUTO باب التيمم ضربتان PageV01P139</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head30">AUTO باب من تيمم ثم وجد الماء PageV01P144</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head31">AUTO باب الأكل على غير وضوء PageV01P146</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head32">AUTO باب القراءة على غير وضوء PageV01P147</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head33">AUTO باب في من صلى وهو يدافع الأخبثين: الغائط والبول PageV01P149</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head34">AUTO باب بدء الأذان PageV01P151</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head35">AUTO باب فضل الأذان PageV01P153</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head36">AUTO باب ما يقال إذا أذن المؤذن PageV01P159</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head37">AUTO باب أخذ الأجرة على الأذان PageV01P162</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head38">AUTO باب أذان الأعمى ومن كرهه ومن رخص فيه PageV01P163</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head39">AUTO باب الأذان على غير وضوء PageV01P166</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head40">AUTO باب من لا يتكلم في أذانه PageV01P167</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head41">AUTO باب: في المؤذن يجعل إصبعيه في أذنيه PageV01P169</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head42">AUTO باب الترسل في الأذان PageV01P174</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head43">AUTO باب من كان يحذم الإقامة PageV01P175</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head44">AUTO باب في من كان يثني الأذان PageV01P176</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head45">AUTO باب من كان آخر أذانه لا إله إلا الله PageV01P178</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head46">AUTO باب من كان آخر أذانه الله أكبر PageV01P180</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head47">AUTO باب في: الصلاة خير من النوم، من كان يقول في صلاة الفجر PageV01P182</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head48">AUTO باب من كان يثوب في الفجر PageV01P186</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head49">AUTO باب في من يحضر المسجد PageV01P190</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head50">AUTO باب الرجل يأتي المسجد وقد صلوا PageV01P192</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head51">AUTO باب: إذا خرجت في قي من الأرض PageV01P193</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head52">AUTO باب من قال يعيد PageV01P196</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head53">AUTO باب في من صلى في بيته PageV01P198</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head54">AUTO باب المؤذن أملك بالأذان والإمام أملك بالإقامة PageV01P199</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head55">AUTO باب في القوم ينتظرون الإمام قياما PageV01P201</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head56">AUTO باب في من أذن وأم PageV01P203</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head57">AUTO باب ms24 في من أذن على راحلته PageV01P205</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head58">AUTO باب: في من قال ليس على النساء أذان ولا إقامة PageV01P206</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head59">AUTO باب: في من قال: يقعد المؤذن بين الأذان والإقامة PageV01P208</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head60">AUTO باب: لا يرد الدعاء في ما بين الأذان والإقامة PageV01P209</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head61">AUTO باب: إذا كان الغيم كيف يصنع PageV01P211</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head62">AUTO باب الإسفار بالفجر PageV01P213</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head63">AUTO باب: في التغليس بالفجر PageV01P220</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head64">AUTO باب من ينور ويغلس PageV01P223</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head65">AUTO باب: في تعجيل الظهر PageV01P224</a>
</li>
</ul>
</body></html></div>
<div class="book body-inner" lang="ara">
<nav class="navbar navbar-expand-lg navbar-light bg-light sticky-top border-bottom" style="direction: ltr;">
<div class="mr-auto d-flex justify-content-left">
<a class="navbar-brand ms-2" href="http://www.kitab-project.org" target="_blank">
<img class="d-inline-block align-top" src="https://cdn.jsdelivr.net/gh/sohailmerchant/kitab-cdn@main/img/kitab-logo.png" width="60px"/>
</a>
</div>
<div class="navbar-nav mx-auto btn-toolbar" style="direction: rtl;">
<div class="d-flex justify-content-center">
<form class="row" id="nav-form" style="margin-bottom: 0px;">
<span class="btn col justify-content-center">ج:</span>
<select class="col form-select pull-left" id="vol-select"></select>
<span class="btn col justify-content-center">ص:</span>
<select class="col form-select pull-left" id="page-select"></select>
<button class="btn col pull-right mx-3" id="nav-submdit-btn" style="width: 100px;" type="submit" value="Go">Go</button>
</form>
</div>
</div>
<div class="btn-toolbar navbar-nav ml-auto d-flex justify-content-right">
<div class="btn-group">
<a class="nav-link pull-right" title="Go to top">
<i class="btn bi bi-arrow-up-circle" id="back-to-top"></i>
</a>
<a class="nav-link pull-right" title="Increase fonts">
<i class="btn bi bi-fonts font-default pull-left"></i>
</a>
<a class="nav-link pull-right" title="Turn light off">
<i class="btn bi bi-lightbulb-off"></i>
</a>
<div class="nav-link pull-right dropdown">
<a aria-expanded="false" aria-haspopup="true" class="" data-bs-toggle="dropdown" id="dropdownMenuButton" role="button" title="Book Metadata">
<i class="btn bi bi-info"></i>
</a>
<div aria-labelledby="dropdownMenuButton" class="dropdown-menu">
<div class="col-12" id="metadata-content"><label>char_length: 31449</label><label>author_lat_full_name:  ʾAbū Nuʿaym ʾAḥmad b. ʿAbd Āllāh b. Isḥāq b. Mūs/a b. Mihrān al-^Sāfiʿī</label><label>author_lat_shuhra: ʾAbū Nuʿaym al-Isbaḥānī</label><label>author_from_uri: Abu Nucaym Isbahani</label><label>tags:  :: ShamAY@الأجزاء الحديثية</label><label>url: https://raw.githubusercontent.com/OpenITI/0450AH/master/data/0430AbuNucaymIsbahani/0430AbuNucaymIsbahani.Salat/0430AbuNucaymIsbahani.Salat.ShamAY0033694-ara1</label><label>tok_length: 8321</label><label>status: pri</label><label>id: ShamAY0033694</label><label>ed_info: صلاح بن عايض الشلاحي :: الأولى، 1417ه - 1996م :: مكتبة الغرباء الأثرية - المدينة / السعودية</label><label>title_lat: Salat</label><label>title_ar: الصلاة ¶ المؤلف: أبو نعيم الفضل بن عمرو بن حماد بن زهير بن درهم القرشي التيمي بالولاء الملائي، المعروف بابن دكين (المتوفى: 219ه) ¶ المحقق: صلاح بن عايض الشلاحي ¶ الناشر: مكتبة الغرباء الأثرية - المدينة / السعودية ¶ الطبعة: الأولى، 1417ه - 1996م ¶ عدد الأجزاء: 1 ¶ [ترقيم الكتاب موافق للمطبوع، وهو ضمن خدمة التخريج] ¶ [تم مقابلة نسخة الموقع الرسمية على المطبوع - مكتبة يا باغي الخير أقبل ومكتبة أحمد الخضري] ¶ ملاحظة: [هذا الكتاب من كتب المستودع بموقع المكتبة الشاملة] :: الصلاة :: الصلاة لأبي نعيم الفضل بن دكين</label><label>book: 0430AbuNucaymIsbahani.Salat</label><label>author_lat: Abu Nucaym Isbahani :: ʾAbū Nuʿaym al-Isbaḥānī ::  ʾAbū Nuʿaym ʾAḥmad b. ʿAbd Āllāh b. Isḥāq b. Mūs/a b. Mihrān al-^Sāfiʿī</label><label>author_ar: أبو نعيم الإسبحاني ::  أبو نعيم أحمد بن عبد آلاه بن إسحاق بن موسى بن مهران الشافعي</label><label>date: 0430</label><label>versionUri: 0430AbuNucaymIsbahani.Salat.ShamAY0033694-ara1</label>
</div>
</div>
</div>
<a class="nav-link pull-right" href="#menu-toggle" id="menu-toggle" title="Book Chapters">
<i class="btn bi bi-list"></i></a>
</div>
</div>
</nav>
<div class="book-body fixed pt-5">
<div class="row">
<div class="col-12">
<div class="row top-heading-panel content-outer-spacing">
</div>
</div>
<div class="col-12" id="meta">
</div>
</div>
<div class="row justify-content-md-center" id="book-main">
<div class="col-lg-8 col-sm-12" id="content">
</div>
</div>
<div class="row mt-5" id="footer">
<div class="col-md-12">
            The KITAB project is based at the Institute for the Study of Muslim Civilizations (ISMC) at Aga Khan
            University, London, and has received funding from the European Research Council (ERC) under the European
            Union's
            Horizon 2020 research and innovation programme (Grant agreement No. 772989)

          </div>
<div class="col-md-12">
<img alt="Logos" height="50" id="logos" src="../img/AKU-EU-ERC-three-logos.jpg"/>
</div>
</div>
</div>
</div>
</div>
<script>

    var pageSel = document.getElementById("page-select");
    var volSel = document.getElementById("vol-select");
    var thisVolume = "01";
    var volPages = {"01": ["063", "063", "064", "065", "066", "066", "066", "067", "067", "069", "069", "069", "070", "071", "072", "072", "073", "074", "074", "074", "075", "075", "075", "076", "076", "078", "078", "079", "080", "081", "081", "081", "081", "082", "082", "083", "083", "084", "085", "085", "085", "085", "086", "087", "087", "088", "089", "090", "090", "090", "091", "092", "093", "093", "093", "094", "094", "094", "095", "095", "095", "096", "097", "097", "097", "098", "098", "098", "098", "099", "100", "100", "100", "101", "102", "102", "102", "103", "103", "104", "105", "105", "106", "106", "106", "106", "107", "107", "108", "108", "108", "109", "109", "109", "110", "110", "111", "112", "112", "112", "113", "113", "113", "114", "115", "115", "116", "116", "116", "116", "117", "117", "118", "118", "118", "119", "120", "121", "121", "121", "121", "122", "122", "124", "124", "124", "125", "125", "126", "126", "127", "127", "128", "129", "129", "129", "130", "130", "130", "131", "132", "132", "132", "133", "133", "134", "134", "135", "135", "135", "136", "137", "137", "137", "137", "138", "138", "139", "139", "139", "140", "140", "140", "141", "141", "142", "143", "144", "144", "146", "146", "146", "147", "147", "147", "147", "147", "148", "149", "149", "149", "149", "151", "151", "151", "153", "153", "153", "154", "154", "154", "155", "155", "155", "155", "156", "156", "156", "157", "158", "159", "159", "159", "160", "160", "160", "161", "162", "162", "162", "163", "163", "163", "164", "164", "166", "166", "166", "167", "167", "167", "167", "169", "169", "169", "169", "169", "169", "170", "170", "170", "171", "172", "172", "173", "173", "174", "174", "174", "175", "175", "175", "175", "176", "176", "176", "177", "177", "178", "178", "178", "178", "179", "179", "180", "180", "180", "180", "181", "182", "182", "183", "183", "183", "184", "184", "185", "186", "186", "186", "186", "187", "187", "187", "187", "188", "188", "188", "189", "189", "189", "190", "190", "190", "191", "191", "192", "192", "192", "193", "193", "193", "193", "193", "194", "194", "194", "194", "195", "196", "196", "196", "197", "198", "198", "198", "198", "199", "199", "201", "201", "201", "202", "203", "203", "203", "203", "205", "205", "206", "206", "206", "207", "208", "208", "208", "209", "209", "210", "211", "211", "211", "212", "213", "213", "214", "214", "215", "215", "215", "215", "216", "216", "217", "217", "217", "218", "218", "219", "220", "220", "220", "221", "221", "223", "223", "223", "224", "224", "224", "225", "225", "225", "226", "227", "227", "228", "228", "100", "135", "135", "140", "141"]}; /*loaded by html_builder*/

    function goToAnchor(vol, anchorId) {
      if (vol != window.thisVolume) {
        loadVolume(vol, false).then(res => {
          console.log("Volume loaded");
          console.log("Go to anchor " + anchorId);
          /*move the volume page to the element with id=anchorId*/
          /*var targetAnchor = document.getElementById(anchorId);
          targetAnchor.scrollIntoView({block: 'nearest'});  // this does not always work...
          console.log(targetAnchor);*/
          /*window.location.hash = "";
          window.location.hash = anchorId;
          window.location.hash = anchorId;
          console.log("#"+anchorId);*/
          /*//This approach does not work at all: scrolls only main window.
          var targetAnchor = $("#"+anchorId);
          //$("#content").animate(
          $("html, body").animate(
            {scrollTop: targetAnchor.offset().top},
            1000
          );*/
          /*//This approach does not work at all: scrolls only main window.
          var targetAnchor = document.getElementById(anchorId);
          var rect = targetAnchor.getBoundingClientRect();
          console.log(targetAnchor);
          console.log(rect);
          var viewHeight=Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
          window.scroll({
            top: rect.top + rect.height / 2 - viewHeight /2,
            behavior: 'smooth'
          });*/
          /*var targetAnchor = document.getElementById(anchorId);
          var contentDiv = document.getElementsByClassName("book-body")[0];
          var topPos = contentDiv.offsetTop;
          var windowSize = $(window).height();
          console.log("topPos: " + topPos);
          console.log("targetPos: " + targetAnchor.offsetTop);
          console.log("windowSize:" + windowSize)
          console.log("targetAnchor.offsetTop-windowSize/3 = " + (targetAnchor.offsetTop - topPos - windowSize / 2));
          contentDiv.scrollTop = targetAnchor.offsetTop - topPos - windowSize / 2;*/
          var targetAnchor = document.getElementById(anchorId);
          targetAnchor.scrollIntoView({"block": "start"});
        });
      } else {
        /*move the volume page to the element with id=anchorId*/
        /*var targetAnchor = document.getElementById(anchorId);
        targetAnchor.scrollIntoView({block: 'nearest'});  // this does not always work...
        console.log(targetAnchor);*/
        /*window.location.hash = "";
        window.location.hash = anchorId;
        window.location.hash = anchorId;
        console.log("#"+anchorId);*/
        /*//This approach does not work at all: scrolls only main window.
        var targetAnchor = $("#"+anchorId);
        //$("#content").animate(
        $("html, body").animate(
          {scrollTop: targetAnchor.offset().top},
          1000
        );*/
        /*//This approach does not work at all: scrolls only main window.
        var targetAnchor = document.getElementById(anchorId);
        var rect = targetAnchor.getBoundingClientRect();
        console.log(targetAnchor);
        console.log(rect);
        var viewHeight=Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
        window.scroll({
          top: rect.top + rect.height / 2 - viewHeight /2,
          behavior: 'smooth'
        });*/
        /*var targetAnchor = document.getElementById(anchorId);
        var contentDiv = document.getElementsByClassName("book-body")[0];
        var topPos = contentDiv.offsetTop;
        var windowSize = $(window).height();
        console.log("topPos: " + topPos);
        console.log("targetPos: " + targetAnchor.offsetTop);
        console.log("windowSize:" + windowSize)
        console.log("targetAnchor.offsetTop-windowSize/3 = " + (targetAnchor.offsetTop - topPos - windowSize / 2));
        contentDiv.scrollTop = targetAnchor.offsetTop - topPos - windowSize / 2;*/
        var targetAnchor = document.getElementById(anchorId);
        targetAnchor.scrollIntoView({"block": "start"});
      }
    }

    CollapsibleLists.apply();
    console.log("Applied CollapsibleLists");

    $(document).ready(function () {
      console.log("Load initial volume " + thisVolume);
      loadVolume(thisVolume).then(res => {
        console.log("Initial volume loaded");
        $('#loading').hide();
        $('#loading').fadeOut("slow");
      });
      $(window).scroll(function () {
        if ($(this).scrollTop() > 50) {
          $('#back-to-top').fadeIn();
        } else {
          $('#back-to-top').fadeOut();
        }
      });
      // scroll body to 0px on click
      $('#back-to-top').click(function () {
        $('body,html').animate({
          scrollTop: 0
        }, 400);
        return false;
      });
      $("#menu-toggle").click(function (e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled");
      });

      $(".font-default").click(function () {

        $('#wrapper').toggleClass("font-increase", "font-default");
      });

      $(".bi-lightbulb-off").click(function () {
        $('.bi-lightbulb-off').toggleClass("bi-lightbulb", "bi-lightbulb-off");
        $('.page-wrapper').toggleClass("night-mode", "");
        $('.navbar-light').toggleClass("night-mode", "");
        console.log(this);

      });
      $('.toc-item').click(function (event) {
        /*console.log('toc item clicked');*/
        event.preventDefault();
        var clickedElement = event.target;
        /*console.log(clickedElement);*/
        var href = clickedElement.getAttribute("href");
        /*console.log('href: '+href);*/
        var vol = href.substring(0, 2);
        var head = href.split('head').pop();
        var anchorId = "head" + head;
        goToAnchor(vol, anchorId);
        return false;
      });
    });

    function loadPageNumbers(vol, page) {
      /*var pageSel = document.getElementById("page-select");*/
      pageSel.innerHTML = '';
      volPages[vol].forEach(function (p, index) {
        pageSel.options[pageSel.options.length] = new Option(p, p);
      });
      if (page) {
        pageSel.value = page;
      }
    }

    function loadVolumeNumbers(vol) {
      /*var volSel = document.getElementById("vol-select");*/
      volSel.innerHTML = '';
      /*console.log(Object.keys(volPages));*/
      /*console.log(Object.keys(volPages).sort());*/

      Object.keys(volPages).sort().forEach(function (v, index) {
        /*console.log(v);*/
        volSel.options[volSel.options.length] = new Option(v, v);
      });
      volSel.value = vol;
    }

    async function loadVolume(vol) {
      /*Load volume json */
      var page = pageSel.value;
      $('#loading').show();
      console.log("loading volume " + vol);
      await $.getJSON(vol + ".json", function (json) {
        console.log(json)
        $('#content').empty().append(json["content"]);
        /*console.log("json loaded");*/
        window.thisVolume = vol;
        $('#loading').hide();
        $('#loading').fadeOut("slow");
        /*Load volume and page numbers in page-nav form:*/
        loadVolumeNumbers(vol);
        loadPageNumbers(vol, page);
        return true;
      });
    }


    function padWithZeros(number, width) {
      number = number + "";
      if (number.length >= width) {
        return number;
      } else {
        return new Array(width - number.length + 1).join("0") + number;
      }
    }
    document.getElementById("nav-form").addEventListener("submit", function (event) {
      event.preventDefault();
      /*console.log("Clicked Go");*/
      var vol = volSel.value;
      console.log("vol: " + vol);
      /*var targetPage = parseInt(pageSel.value, 10);
      if (page >= 1) {
        page = page-1; //page number is at bottom of page
      }
      var anchor = "v"+vol+"p"+padWithZeros(targetPage, 3);*/
      var targetPage = pageSel.value;
      var pages = volPages[vol];
      var index = pages.indexOf(targetPage);
      if (index > 0) {
        targetPage = pages[index-1];
      }

      console.log("targetPage: " + targetPage);
      var anchor = "v" + vol + "p" + targetPage;
      goToAnchor(vol, anchor);
      return false;
    });

    /*Adapt the page numbers list when the volume number changes:*/
    volSel.addEventListener("change", function (event) {
      var vol = this.value;
      var page = pageSel.value;
      loadPageNumbers(vol, page);
    });


  </script>
</body>
</html>
