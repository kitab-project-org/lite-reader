<html dir="rtl" lang="ar">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta http-equiv="Content-Security-Policy" https:=""/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script crossorigin="anonymous" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js"></script>
<link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" rel="stylesheet"/>
<link href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Amiri&amp;display=swap" rel="stylesheet"/>
<!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css"
        integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous"> -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css" rel="stylesheet"/>
<link crossorigin="anonymous" href="../css/stylev2.css" rel="stylesheet" type="text/css"/>
<script crossorigin="anonymous" src="../js/CollapsibleLists.js" type="application/javascript"></script>
<!-- <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/alpheios-components@latest/dist/style/style-components.min.css" /> -->
<script type="text/javascript">
</script>
</head>
<body>
<div id="loading">
<img alt="Loading..." id="loading-image" src="../img/spinner1.gif"/>
</div>
<div class="page-wrapper toggled" id="wrapper">
<div id="sidebar-wrapper">
<html><body><div class="card-header title-heading">فصول الكتاب</div><ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head0">CHECK مقدمة المؤلف</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head1">CHECK بيان أن هذه الآية اشتملت على جميع مصالح العباد في معاشهم ومعادهم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head2">CHECK تفسير قوله تعالى: {وتعاونوا على البر والتقوى ولا تعاونوا على الإثم والعدوان}</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head3">CHECK البر والتقوى جحاع الدين كلهه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head4">CHECK البر يشمل أصول الإيمان والشرائع الظاهرة والأعمال القلبية</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head5">CHECK خصال البر كما ذكرت في سورة البقرة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head6">CHECK حقيقة "البر" واشتقاق هده المادة وتصاريفها</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head7">CHECK قول طلق بن حبيب في ms06 حدها</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head8">CHECK حقيقة "التقوى" وخصا لها</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head9">CHECK سبب اقتران الإيمان للاحتساب</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head10">CHECK الفرق بين البر والتقوى عند أقتران أحدهما بالآخر</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head11">CHECK عدم العلم بها يؤدي إلى مفسدتين</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head12">CHECK العلم بحدود ما أنزل الله هو العلم النافع</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head13">CHECK عودة إلى تفسير الآية</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head14">CHECK أمثلة من الأسماء التي علق الله بها الأحكام</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head15">CHECK الفرق بين "الإثم" و"العدوان"</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head16">CHECK كيف يتم أدأء هذين الواجبين</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head17">CHECK واجب العبد بينه وبين الخلق، وواجبه بينه وبين الله</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head18">CHECK المقصود الأهم هو الهجرة إلى الله ورسوله</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head19">CHECK مبدأ الهجرة بالقلب ومنتهاها</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head20">CHECK الهجرة نوعان هجرة بالجسم وهجرة بالقلب</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head21">CHECK قوله - صلى الله عليه وسلم -: "لا ملجأ ولا منجى منك إلا إليك"</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head22">CHECK معنى الفرار من الله إليه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head23">AUTO معنى قوله - صلى الله عليه وسلم -: "وأعوذ بك منك"</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head24">CHECK المقصود من الهجرة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head25">CHECK سبب قوة هذه الهجرة وضعفها</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head26">CHECK على العبد في كل وقت أن يهاجر إلى الله</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head27">CHECK الهجرة إلى الرسول - صلى الله عليه وسلم - وغربة السالكين في طريقها</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head28">CHECK حد هذه الهجرة وبيان أنها مقتضى شهادة أن محمد رسول الله</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head29">CHECK المطلوب تحكيم الرسول - صلى الله عليه وسلم - في جميع موارد النزاع وانشراح الصدور بحكمه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head30">CHECK كيف يختبر العبد حاله في هذا الأمر</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head31">CHECK ذكر وجوه التأكيد في قوله تعالى: {فلا وربك لا يؤمنون حتى يحكموك فيما شجر بينهم}</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head32">CHECK الفرق بين علم الحب وحال الحب</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head33">CHECK الأولوية تتضمن عدة أمور</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head34">CHECK الكلام على قوله تعالى: {النبي أولى بالمؤمنين من أنفسهم}</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head35">CHECK تفسير قوله تعالى: {ياأيها الذين آمنوا كونوا قوامين بالقسط شهداء لله ولو على أنفسكم}</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head36">CHECK ادعاء هذه الأولوية والمحبة ممن سعيه واجتهاده في الأشتغال بأقوال غير الرسول وتقريرها</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head37">CHECK معنى الشهادة لله</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head38">CHECK معنى القيام بالقسط أو العدل</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head39">CHECK اللي هو التحريف، وقد يكون في اللفظ وقد يكون في المعنى</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head40">CHECK اللي والإعراض المنهي عنهما في الآية</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head41">CHECK وجوب اتباع النصوص وإظهارها ودعوة الخلق إليها</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head42">CHECK تفسير قوله تعالى: {ياأيها الذين آمنوا أطيعوا الله وأطيعوا الرسول وأولي الأمر منكم}</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head43">CHECK الكلام على قوله تعالى: {قل أطيعوا الله وأطيعوا الرسول فإن تولوا فإنما عليه ما حمل وعليكم ما حملتم}</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head44">CHECK السر في تكرار الفعل في {أطيعوا الله وأطيعوا الرسول} والجمع بين الرسول وأولي الأمر تحت فعل واحد</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head45">CHECK سبب الخطاب في القرآن بقوله: {ياأيها الذين آمنوا}</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head46">CHECK معنى الرد إلى الله والرسول</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head47">CHECK معنى أولي الأمر</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head48">CHECK حكم تحكيم غير الله والرسول</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head49">CHECK وجوب رد موارد النزاع إلى الله ورسوله</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head50">CHECK كل شر في الدنيا والآخرة سببه مخالفة الرسول، وكل خير فيهما سببه طاعة الرسول</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head51">CHECK مراتب الكمال الإنساني الأربع</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head52">CHECK كمال هذه السعادة دعوة الخلق إليه وصبره وجهاده على ms24 تلك الدعوة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head53">CHECK سعادة العبد في معرفة ما جاء به الرسول علما والقيام به عملا</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head54">CHECK ضلال من يزعم أن الهداية لا تحصل بالوحي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head55">CHECK كل من لم يتبع الوحي فإنما أتبع الباطل واتبع اولياء من دون الله</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head56">CHECK تفسير قوله تعالى: {ومن أظلم ممن افترى على الله كذبا أو كذب بآياته}</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head57">CHECK حكم الأتباع الأشقياء</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head58">CHECK قطع جميع الأسباب يوم القيامة إلا السبب الواصل بين العبد وبين ربه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head59">CHECK حكم الأتباع السعداء وبيان أنهم نوعان</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head60">CHECK شرح حديث "مثل ما بعثني الله به من الهدى والعلم كمثل غيث"</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head61">CHECK أقسام الخلائق في الدعوة والاستجابة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head62">CHECK تشبيه القلوب بالأرضين الثلاثة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head63">AUTO النوع الثاني من الأتباع السعداء</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head64">CHECK راد هذا السفر العلم الموروث عن خاتم الأنبياء - صلى الله عليه وسلم -</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head65">CHECK من أعظم التعاون على البر والتقوى: التعاون على سفر الهجرة إلى الله ورسوله</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head66">CHECK طريق هذا السفر بذل الجهد واستفراغ الوسع</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head67">CHECK مركب هذا السفر: صدق اللجأ إلى الله والانقطاع إليه بالكلية</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head68">CHECK عليه أن لا يصبو في الحق إلى لومة لائم، وأن تهون عليه نفسه في الله، وأن يتحلى بالصبر</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head69">CHECK رأس مال الأم، وعموده في ذلك: دوام التفكر والتدبر في آيات القرآن</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head70">CHECK تفسير قوله تعالى: {هل أتاك حديث ضيف إبراهيم المكرمين}</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head71">CHECK نموذج من تدبر القرآن وتفهمه والإشراف على عجائبه وكنوره</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head72">CHECK ذكر بعض في هذه الآيات من الأسرار</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head73">CHECK السر في افتتاح القصة بصيغة الاستفهام</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head74">CHECK معنى "المكرمين"</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head75">CHECK الكلام على قوله {فقالوا سلام}</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head76">CHECK ذكر أنواع من المدح وآداب الضيافة وإكرام الضيافة في الآيات</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head77">CHECK إثبات العلم والحكمة لله وبيان أنهما متضمنان لجميع صفات الكمال</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head78">CHECK طريقة القرآن في إثبات المعاد، وعزم المؤلف على التأليف فيها</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head79">CHECK سر الفرق بين الإسلام والإيمان في الآيتين</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head80">CHECK طلب الرفيق لسفر الهجرة، ومواصلة السير ولو وحيدا غريبا</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head81">CHECK الانتفاع بآيات الله وعجائبه لمن يؤمن بالمعاد ويخشى عذاب الله</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head82">CHECK الغرض من تأليف هده الرسالة وبيان أهميتها</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head83">CHECK من أراد هذا السفر فعليه بموافقة الأموات، ويحذر من مرافقة الأحياء</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head84">CHECK علاقة هذا المسافر بعامة الناس، وواجبه نحوهم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head85">CHECK بيان أهمية هذه الخصال الثلاث</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head86">CHECK الكلام على قوله تعالى: {خذ العفو وأمر بالعرف وأعرض عن الجاهلين}</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head87">CHECK الكلام على قوله تعالى: {فاعف عنهم واستغفر لهم وشاورهم في الأمر}</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head88">CHECK لا تتم هذه الخصال إلا بثلاثة أشياء: أن يكون العود طيبا، وأن تكون النفس قوية، وعلم شاف بحقائق الأشياء</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head89">CHECK خاتمة الرسالة</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head90">CHECK أول الأمر وآخره: معاملة الله وحده والانقطاع إليه بكلية القلب</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head91">CHECK ثلاث كلمات كاد يكتب بها بعض السلف إلى بعض</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head92">CHECK إشارة المؤلف إلي تأليف له في شرح معنى بيت</a>
</li>
</ul>
</li>
</ul>
</body></html></div>
<div class="book body-inner" lang="ara">
<nav class="navbar navbar-expand-lg navbar-light bg-light sticky-top border-bottom" style="direction: ltr;">
<div class="mr-auto d-flex justify-content-left">
<a class="navbar-brand ms-2" href="http://www.kitab-project.org" target="_blank">
<img class="d-inline-block align-top" src="https://cdn.jsdelivr.net/gh/sohailmerchant/kitab-cdn@main/img/kitab-logo.png" width="60px"/>
</a>
</div>
<div class="navbar-nav mx-auto btn-toolbar" style="direction: rtl;">
<div class="d-flex justify-content-center">
<form class="row" id="nav-form" style="margin-bottom: 0px;">
<span class="btn col justify-content-center">ج:</span>
<select class="col form-select pull-left" id="vol-select"></select>
<span class="btn col justify-content-center">ص:</span>
<select class="col form-select pull-left" id="page-select"></select>
<button class="btn col pull-right mx-3" id="nav-submdit-btn" style="width: 100px;" type="submit" value="Go">Go</button>
</form>
</div>
</div>
<div class="btn-toolbar navbar-nav ml-auto d-flex justify-content-right">
<div class="btn-group">
<a class="nav-link pull-right" title="Go to top">
<i class="btn bi bi-arrow-up-circle" id="back-to-top"></i>
</a>
<a class="nav-link pull-right" title="Increase fonts">
<i class="btn bi bi-fonts font-default pull-left"></i>
</a>
<a class="nav-link pull-right" title="Turn light off">
<i class="btn bi bi-lightbulb-off"></i>
</a>
<div class="nav-link pull-right dropdown">
<a aria-expanded="false" aria-haspopup="true" class="" data-bs-toggle="dropdown" id="dropdownMenuButton" role="button" title="Book Metadata">
<i class="btn bi bi-info"></i>
</a>
<div aria-labelledby="dropdownMenuButton" class="dropdown-menu">
<div class="col-12" id="metadata-content"><label>char_length: 67060</label><label>author_lat_full_name: </label><label>author_lat_shuhra: </label><label>author_from_uri: Ibn Qayyim Jawziyya</label><label>tags:  :: Sham@الرقاق والآداب والأذكار</label><label>url: https://raw.githubusercontent.com/OpenITI/0775AH/master/data/0751IbnQayyimJawziyya/0751IbnQayyimJawziyya.RisalaTabukiyya/0751IbnQayyimJawziyya.RisalaTabukiyya.Sham19Y0014211-ara1</label><label>tok_length: 15987</label><label>status: pri</label><label>id: Sham19Y0014211</label><label>ed_info: محمد عزير شمس :: الأولى، 1425 ه :: دار عالم الفوائد - مكة المكرمة</label><label>title_lat: Risala Tabukiyya</label><label>title_ar: الرسالة التبوكية (ضمن مجموع الرسائل) :: الرسالة التبوكية = زاد المهاجر إلى ربه ط عالم الفوائد</label><label>book: 0751IbnQayyimJawziyya.RisalaTabukiyya</label><label>author_lat: Ibn Qayyim Jawziyya</label><label>author_ar: ابن القيم :: أبو عبد الله محمد بن أبي بكر بن أيوب ابن قيم الجوزية (659 - 751)</label><label>date: 0751</label><label>versionUri: 0751IbnQayyimJawziyya.RisalaTabukiyya.Sham19Y0014211-ara1</label>
</div>
</div>
</div>
<a class="nav-link pull-right" href="#menu-toggle" id="menu-toggle" title="Book Chapters">
<i class="btn bi bi-list"></i></a>
</div>
</div>
</nav>
<div class="book-body fixed pt-5">
<div class="row">
<div class="col-12">
<div class="row top-heading-panel content-outer-spacing">
</div>
</div>
<div class="col-12" id="meta">
</div>
</div>
<div class="row justify-content-md-center" id="book-main">
<div class="col-lg-8 col-sm-12" id="content">
</div>
</div>
<div class="row mt-5" id="footer">
<div class="col-md-12">
            The KITAB project is based at the Institute for the Study of Muslim Civilizations (ISMC) at Aga Khan
            University, London, and has received funding from the European Research Council (ERC) under the European
            Union's
            Horizon 2020 research and innovation programme (Grant agreement No. 772989)

          </div>
<div class="col-md-12">
<img alt="Logos" height="50" id="logos" src="../img/AKU-EU-ERC-three-logos.jpg"/>
</div>
</div>
</div>
</div>
</div>
<script>

    var pageSel = document.getElementById("page-select");
    var volSel = document.getElementById("vol-select");
    var thisVolume = "01";
    var volPages = {"01": ["002", "003", "005", "006", "007", "008", "009", "010", "011", "012", "013", "014", "015", "016", "017", "018", "019", "020", "021", "002", "003", "004", "005", "006", "007", "008", "009", "010", "011", "012", "013", "014", "015", "016", "017", "018", "019", "020", "021", "022", "023", "024", "025", "026", "027", "028", "029", "030", "031", "032", "033", "034", "035", "036", "037", "038", "039", "040", "041", "042", "043", "044", "045", "046", "047", "048", "049", "050", "051", "052", "053", "054", "055", "056", "057", "058", "059", "060", "061", "062", "063", "064", "065", "066", "067", "068", "069", "070", "071", "072", "073", "074", "075", "076", "077", "078", "079", "080", "081", "082", "083", "084", "085", "086", "087", "088", "089", "090", "091", "092", "003", "004", "005", "006", "007", "008", "009", "010", "011", "012", "013", "014", "015", "016", "017", "018", "019", "020", "021", "022", "023", "024", "025", "026", "027", "028", "029", "030", "031", "032", "033", "034", "035", "036", "037", "038", "039", "040", "041", "042", "043", "044", "045", "046", "047", "048", "049", "050", "051", "052", "053", "054", "055", "056", "057", "058", "059", "060", "061", "062", "063", "064", "065", "066", "067", "068", "069", "070", "071", "072", "073", "074", "075", "076", "077", "078", "079", "080", "081", "082", "083", "084", "085", "086", "087", "088", "089", "090", "091", "092", "093"]}; /*loaded by html_builder*/

    function goToAnchor(vol, anchorId) {
      if (vol != window.thisVolume) {
        loadVolume(vol, false).then(res => {
          console.log("Volume loaded");
          console.log("Go to anchor " + anchorId);
          /*move the volume page to the element with id=anchorId*/
          /*var targetAnchor = document.getElementById(anchorId);
          targetAnchor.scrollIntoView({block: 'nearest'});  // this does not always work...
          console.log(targetAnchor);*/
          /*window.location.hash = "";
          window.location.hash = anchorId;
          window.location.hash = anchorId;
          console.log("#"+anchorId);*/
          /*//This approach does not work at all: scrolls only main window.
          var targetAnchor = $("#"+anchorId);
          //$("#content").animate(
          $("html, body").animate(
            {scrollTop: targetAnchor.offset().top},
            1000
          );*/
          /*//This approach does not work at all: scrolls only main window.
          var targetAnchor = document.getElementById(anchorId);
          var rect = targetAnchor.getBoundingClientRect();
          console.log(targetAnchor);
          console.log(rect);
          var viewHeight=Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
          window.scroll({
            top: rect.top + rect.height / 2 - viewHeight /2,
            behavior: 'smooth'
          });*/
          /*var targetAnchor = document.getElementById(anchorId);
          var contentDiv = document.getElementsByClassName("book-body")[0];
          var topPos = contentDiv.offsetTop;
          var windowSize = $(window).height();
          console.log("topPos: " + topPos);
          console.log("targetPos: " + targetAnchor.offsetTop);
          console.log("windowSize:" + windowSize)
          console.log("targetAnchor.offsetTop-windowSize/3 = " + (targetAnchor.offsetTop - topPos - windowSize / 2));
          contentDiv.scrollTop = targetAnchor.offsetTop - topPos - windowSize / 2;*/
          var targetAnchor = document.getElementById(anchorId);
          targetAnchor.scrollIntoView({"block": "start"});
        });
      } else {
        /*move the volume page to the element with id=anchorId*/
        /*var targetAnchor = document.getElementById(anchorId);
        targetAnchor.scrollIntoView({block: 'nearest'});  // this does not always work...
        console.log(targetAnchor);*/
        /*window.location.hash = "";
        window.location.hash = anchorId;
        window.location.hash = anchorId;
        console.log("#"+anchorId);*/
        /*//This approach does not work at all: scrolls only main window.
        var targetAnchor = $("#"+anchorId);
        //$("#content").animate(
        $("html, body").animate(
          {scrollTop: targetAnchor.offset().top},
          1000
        );*/
        /*//This approach does not work at all: scrolls only main window.
        var targetAnchor = document.getElementById(anchorId);
        var rect = targetAnchor.getBoundingClientRect();
        console.log(targetAnchor);
        console.log(rect);
        var viewHeight=Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
        window.scroll({
          top: rect.top + rect.height / 2 - viewHeight /2,
          behavior: 'smooth'
        });*/
        /*var targetAnchor = document.getElementById(anchorId);
        var contentDiv = document.getElementsByClassName("book-body")[0];
        var topPos = contentDiv.offsetTop;
        var windowSize = $(window).height();
        console.log("topPos: " + topPos);
        console.log("targetPos: " + targetAnchor.offsetTop);
        console.log("windowSize:" + windowSize)
        console.log("targetAnchor.offsetTop-windowSize/3 = " + (targetAnchor.offsetTop - topPos - windowSize / 2));
        contentDiv.scrollTop = targetAnchor.offsetTop - topPos - windowSize / 2;*/
        var targetAnchor = document.getElementById(anchorId);
        targetAnchor.scrollIntoView({"block": "start"});
      }
    }

    CollapsibleLists.apply();
    console.log("Applied CollapsibleLists");

    $(document).ready(function () {
      console.log("Load initial volume " + thisVolume);
      loadVolume(thisVolume).then(res => {
        console.log("Initial volume loaded");
        $('#loading').hide();
        $('#loading').fadeOut("slow");
      });
      $(window).scroll(function () {
        if ($(this).scrollTop() > 50) {
          $('#back-to-top').fadeIn();
        } else {
          $('#back-to-top').fadeOut();
        }
      });
      // scroll body to 0px on click
      $('#back-to-top').click(function () {
        $('body,html').animate({
          scrollTop: 0
        }, 400);
        return false;
      });
      $("#menu-toggle").click(function (e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled");
      });

      $(".font-default").click(function () {

        $('#wrapper').toggleClass("font-increase", "font-default");
      });

      $(".bi-lightbulb-off").click(function () {
        $('.bi-lightbulb-off').toggleClass("bi-lightbulb", "bi-lightbulb-off");
        $('.page-wrapper').toggleClass("night-mode", "");
        $('.navbar-light').toggleClass("night-mode", "");
        console.log(this);

      });
      $('.toc-item').click(function (event) {
        /*console.log('toc item clicked');*/
        event.preventDefault();
        var clickedElement = event.target;
        /*console.log(clickedElement);*/
        var href = clickedElement.getAttribute("href");
        /*console.log('href: '+href);*/
        var vol = href.substring(0, 2);
        var head = href.split('head').pop();
        var anchorId = "head" + head;
        goToAnchor(vol, anchorId);
        return false;
      });
    });

    function loadPageNumbers(vol, page) {
      /*var pageSel = document.getElementById("page-select");*/
      pageSel.innerHTML = '';
      volPages[vol].forEach(function (p, index) {
        pageSel.options[pageSel.options.length] = new Option(p, p);
      });
      if (page) {
        pageSel.value = page;
      }
    }

    function loadVolumeNumbers(vol) {
      /*var volSel = document.getElementById("vol-select");*/
      volSel.innerHTML = '';
      /*console.log(Object.keys(volPages));*/
      /*console.log(Object.keys(volPages).sort());*/

      Object.keys(volPages).sort().forEach(function (v, index) {
        /*console.log(v);*/
        volSel.options[volSel.options.length] = new Option(v, v);
      });
      volSel.value = vol;
    }

    async function loadVolume(vol) {
      /*Load volume json */
      var page = pageSel.value;
      $('#loading').show();
      console.log("loading volume " + vol);
      await $.getJSON(vol + ".json", function (json) {
        console.log(json)
        $('#content').empty().append(json["content"]);
        /*console.log("json loaded");*/
        window.thisVolume = vol;
        $('#loading').hide();
        $('#loading').fadeOut("slow");
        /*Load volume and page numbers in page-nav form:*/
        loadVolumeNumbers(vol);
        loadPageNumbers(vol, page);
        return true;
      });
    }


    function padWithZeros(number, width) {
      number = number + "";
      if (number.length >= width) {
        return number;
      } else {
        return new Array(width - number.length + 1).join("0") + number;
      }
    }
    document.getElementById("nav-form").addEventListener("submit", function (event) {
      event.preventDefault();
      /*console.log("Clicked Go");*/
      var vol = volSel.value;
      console.log("vol: " + vol);
      /*var targetPage = parseInt(pageSel.value, 10);
      if (page >= 1) {
        page = page-1; //page number is at bottom of page
      }
      var anchor = "v"+vol+"p"+padWithZeros(targetPage, 3);*/
      var targetPage = pageSel.value;
      var pages = volPages[vol];
      var index = pages.indexOf(targetPage);
      if (index > 0) {
        targetPage = pages[index-1];
      }

      console.log("targetPage: " + targetPage);
      var anchor = "v" + vol + "p" + targetPage;
      goToAnchor(vol, anchor);
      return false;
    });

    /*Adapt the page numbers list when the volume number changes:*/
    volSel.addEventListener("change", function (event) {
      var vol = this.value;
      var page = pageSel.value;
      loadPageNumbers(vol, page);
    });


  </script>
</body>
</html>
