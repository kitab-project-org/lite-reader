<html dir="rtl" lang="ar">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta http-equiv="Content-Security-Policy" https:=""/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script crossorigin="anonymous" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js"></script>
<link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" rel="stylesheet"/>
<link href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Amiri&amp;display=swap" rel="stylesheet"/>
<!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css"
        integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous"> -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css" rel="stylesheet"/>
<link crossorigin="anonymous" href="../css/stylev2.css" rel="stylesheet" type="text/css"/>
<script crossorigin="anonymous" src="../js/CollapsibleLists.js" type="application/javascript"></script>
<!-- <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/alpheios-components@latest/dist/style/style-components.min.css" /> -->
<script type="text/javascript">
</script>
</head>
<body>
<div id="loading">
<img alt="Loading..." id="loading-image" src="../img/spinner1.gif"/>
</div>
<div class="page-wrapper toggled" id="wrapper">
<div id="sidebar-wrapper">
<html><body><div class="card-header title-heading">فصول الكتاب</div><ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head0">1 باب الدليل على أن قراءة القرآن ركن في الصلاة وأنها وجبة في كل ركعة منها</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head1">باب الدليل على أن لا صلاة إلا بقراءة وانه إذا انتهى إلى أم القرآن اجزأت عنه لا فرق في ذلك بين الإمام والمأموم والمنفرد</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head2">3 باب الدليل على أن لا صلاة إلا بفاتحة الكتاب يجمع الإمام والمأموم والمنفرد</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head3">4 باب الدليل على أن كل صلاة لم يقرأ فيها بفاتحة الكتاب فهي خداج وبيان قسمة الله تبارك وتعالى صلاة العبد بينه وبين عبده نصفين وان الذي قسمه منها هو قراءة فاتحة الكتاب وفي ذلك دلالة على كونها ركنا فيها حتى سماها باسمها ولم يفرق فيها بين الإمام والمأموم والمنفرد والذي حمل الحديث وهو أعرف بما روى حمل وجوب قراءتها على الجميع وأمر المأموم بقراءتها سرا</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head4">باب سياق رواية من تابع أبا هريرة فيما رواه من قسمة الصلاة وأن صلاة من لم يقرأ فيها بأم القرآن خداج من غير فرق بين الإمام والمأموم والمنفرد</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head5">6 باب الدليل على افتتاح كل مصل قراءته بفاتحة الكتاب وأن لا فرق فيها بين الإمام والمأموم والمنفرد</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head6">باب ذكر أخبار خاصة دالة على وجوب قراءة فاتحة الكتاب على المأموم وبيان المصطفى صلى الله عليه وسلم أن الصلاة لا تجزى دون قراءتها سواء كان المصلى إماما أو مأموما أو منفردا وسواء كانت الصلاة مما يجهر الإمام فيها بالقراءة أو لا يجهر بها</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head7">8 باب ذكر الشواهد التي تشهد لرواية عبادة بن الصامت رضي الله عنه في استثناء قراءة فاتحة الكتاب بالصحة مع استفنائها عن الشواهد</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head8">9 باب ما يستدل به على أن النبي صلى الله عليه وسلم صلى الله عليه وسلم انما نهى المأموم عن الجهر بالقراءة لا عن أصل القراءة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head9">10 باب ما يستدل به على أن المأموم يقرأ بفاتحة الكتاب اذ المصطفى صلى الله عليه وسلم صلى الله عليه وسلم سأل الفتى الذي صلى خلف معاذ بن جبل رضي الله عنه كيف تصنع فأخبره بانه يقرأ بفاتحة الكتاب فلم ينكره عليه ولم يفصل عليه الحال</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head10">11 باب ما يستدل به على أن المأموم يقرأ خلف الإمام وأن المنهي عنه انما هو كلام الناس إذ المصطفى صلى الله عليه وسلم صلى الله عليه وسلم من ( 1 ) تكلم خلفه إن الصلاة لا يصلح فيها شيء من كلام الناس وإنما هي التسبيح والتكبير وتلاوة القرآن ms056 ولم يفصل عليه الحال ولو كانت القراءة منهيا عنها خلفه لنهاه عنها مفصلا كما نهاه عن الكلام في الصلاة جملة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head11">12 باب ما يستدل به على أن المأموم يقرأ خلف الإمام اذ المصطفى صلى الله عليه وسلم صلى الله عليه وسلم قد أخبر أن المصلي يناجي ربه والمناجاة انما تكون بالنطق لا بالسكوت ولم يفصل بين أن يكون إماما أو مأموما أو منفردا</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head12">13 باب ما يستدل به على أن المأموم لابد من القراءة اذ المصطفى صلى الله عليه وسلم صلى الله عليه وسلم أخبر أن كل مصل انما يصلي لنفسه والقراءة بعض الصلاة فلا يكون قراءة الإمام قراءة للمأموم فيكون المأموم قد صلى بعض صلاته بنفسه وبعضها صلاها له الإمام مع ما في التنزيل من قول الله عز وجل @QB@ وأن ليس للإنسان إلا ما سعى وأن سعيه سوف يرى @QE@ وقال @QB@ لتجزى كل نفس بما تسعى @QE@</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head13">14 باب ما يستدل به على وجوب القراءة على المأموم اذ المصطفى صلى الله عليه وسلم صلى الله عليه وسلم علم من لا يحسن القرآن ما يقوم مقامه من الذكر ولم يأمره بالإئتمام حتى يسقط عنه القراءة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head14">15 ذكر ما يؤثر عن أصحاب النبي المصطفى صلى الله عليه وسلم صلى الله عليه وسلم في قراءتهم خلف الإمام وأمرهم بها</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head15">1 ذكر ما روى عن أمير المؤمنين أبي حفص عمر بن الخطاب رضي الله عنه في ذلك</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head16">2 ذكر رواية صحيحة فيه عم أمير المؤمنين أبي الحسن علي بن أبي طالب رضي الله عنه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head17">3 ذكر الرواية فيه عن أبي كعب رضي الله عنه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head18">4 ذكر الرواية فيه عن معاذ بن جبل رضي الله عنه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head19">5 ذكر الرواية فيه عن عبادة بن الصامت رضي الله عنه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head20">6 ذكر الرواية فيه عن عبد الله بن مسعود رضي الله عنه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head21">7 ذكر الرواية فيه عن عبد الله بن عباس رضي الله عنهما</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head22">8 ذكر الرواية فيه عن عبد الله بن عمر بن الخطاب رضي الله عنهما</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head23">9 ذكر الراوية فيه عن عبد الله بن عمرو بن العاص رضي الله عنهما</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head24">10 ذكر الرواية فيه عن أبي هريرة الدوسي رضي الله عنه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head25">11 ذكر الرواية فيه عن أبي هريرة وعائشة بنت الصديق رضي الله عنهم ms068</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head26">12 ذكر الرواية فيه عن هشام بن عامر رضي الله عنه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head27">13 ذكر الرواية فيه عن أبي سعيد الخدري رضي الله عنه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head28">14 ذكر الرواية فيه عن جابر بن عبد الله رضي الله عنه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head29">15 ذكر الرواية فيه عن أبي الدرداء رضي الله عنه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head30">16 ذكر الرواية فيه عن أنس بن مالك رضي الله عنه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head31">17 ذكر الرواية فيه عن عمران بن حصين رضي الله عنه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head32">18 ذكر الرواية فيه عن عبد الله بن مغفل المزني رضي الله عنه</a>
</li>
</ul>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head33">16 ذكر الروايات فيه عن جماعة منهم غير مسمين ms071 ثم عن جماعة من التابعين وأتباعهم بأسمائهم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head34">17 باب ذكر ما احتج به من رأي وجوب القراءة خلف الإمام فيما خافت الإمام فيه بالقراءة دون ما جهر بها فيه</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head35">( ذكر الخبر الذي ورد في الأمر بالإنصات لقراءة الإمام وذلك فيما يحتج به من ذهب إلى قول الشافعي رحمه الله في القديم )</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head36">( ذكر خبر آخر يحتج به من قال بقول الشافعي في القديم )</a>
</li>
</ul>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head37">18 باب ذكر أخبار يحتج بها من زعم أن لا قراءة خلف الإمام بحال</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head38">( ذكر خبر ورد فيه عن جابر بن عبد الله الأنصاري رضي الله عنه وبيان علته )</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head39">ذكر خبر آخر روي فيه عن جابر بن عبد الله الانصاري رضي الله عنه وبيان ضعفه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head40">( ذكر خبر آخر يحتج به من نهى عن القراءة خلف الإمام وبيان ضعفه )</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head41">( ذكر خبر آخر يحتج به من كره القراءة خلف الإمام وبيان علته )</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head42">( ذكر خبر آخر يحتج به بعض من لا يرى القراءة خلف الإمام وبيان تلبيسه وتقصير بعض الرواة بسياق متنه )</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head43">ذكر خبر آخر يحتج به من كره القراءة خلف الإمام وبيان ضعفه وخطأ من أخطأ في رفعه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head44">ذكر خبر آخر يحتج به من كره القراءة خلف الإمام وبيان ضعفه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head45">| ذكر خبر آخر يحتج به من كره القراءة خلف الإمام وبيان ضعفه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head46">ذكر خبر آخر يحتج به من لم ير القراءة خلف الإمام وبيان ضعفه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head47">ذكر خبر آخر يحتج به من لم ير القراءة خلف الإمام وبيان ضعفه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head48">ذكر خبر آخر يحتج به من لم ير القراءة خلف الإمام وبيان ضعفه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head49">( ذكر خبر آخر يحتج به من لا يعلم )</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head50">فصل في ذكر الأقيسة</a>
</li>
</ul>
</li>
</ul>
</body></html></div>
<div class="book body-inner" lang="ara">
<nav class="navbar navbar-expand-lg navbar-light bg-light sticky-top border-bottom" style="direction: ltr;">
<div class="mr-auto d-flex justify-content-left">
<a class="navbar-brand ms-2" href="http://www.kitab-project.org" target="_blank">
<img class="d-inline-block align-top" src="https://cdn.jsdelivr.net/gh/sohailmerchant/kitab-cdn@main/img/kitab-logo.png" width="60px"/>
</a>
</div>
<div class="navbar-nav mx-auto btn-toolbar" style="direction: rtl;">
<div class="d-flex justify-content-center">
<form class="row" id="nav-form" style="margin-bottom: 0px;">
<span class="btn col justify-content-center">ج:</span>
<select class="col form-select pull-left" id="vol-select"></select>
<span class="btn col justify-content-center">ص:</span>
<select class="col form-select pull-left" id="page-select"></select>
<button class="btn col pull-right mx-3" id="nav-submdit-btn" style="width: 100px;" type="submit" value="Go">Go</button>
</form>
</div>
</div>
<div class="btn-toolbar navbar-nav ml-auto d-flex justify-content-right">
<div class="btn-group">
<a class="nav-link pull-right" title="Go to top">
<i class="btn bi bi-arrow-up-circle" id="back-to-top"></i>
</a>
<a class="nav-link pull-right" title="Increase fonts">
<i class="btn bi bi-fonts font-default pull-left"></i>
</a>
<a class="nav-link pull-right" title="Turn light off">
<i class="btn bi bi-lightbulb-off"></i>
</a>
<div class="nav-link pull-right dropdown">
<a aria-expanded="false" aria-haspopup="true" class="" data-bs-toggle="dropdown" id="dropdownMenuButton" role="button" title="Book Metadata">
<i class="btn bi bi-info"></i>
</a>
<div aria-labelledby="dropdownMenuButton" class="dropdown-menu">
<div class="col-12" id="metadata-content"><label>char_length: 208699</label><label>author_lat_full_name: </label><label>author_lat_shuhra: </label><label>author_from_uri: Bayhaqi</label><label>tags: COMPLETED :: CENT0500 :: _AJZA :: _FIQH :: _HADITH :: _MASAIL :: _USUL :: GAL@literature-islamic :: GAL@1000-1258CE :: GAL@hadith :: GAL@literature-arabic :: GAL@period-postclassical :: GAL@persia :: JK@الفقه وأصوله :: JK@كتب الفقه الإسلامي :: JK@مسائل فقهية :: JK@مسائل فقهية وأصولية</label><label>url: https://raw.githubusercontent.com/OpenITI/0475AH/master/data/0458Bayhaqi/0458Bayhaqi.QiraatKhalfaImam/0458Bayhaqi.QiraatKhalfaImam.JK000631-ara1.completed</label><label>tok_length: 53938</label><label>status: pri</label><label>id: JK000631</label><label>ed_info: محمد السعيد بن بسيوني زغلول :: بيروت :: 1405 :: دار الكتب العلمية :: http://www.worldcat.org/oclc/14085475</label><label>title_lat: Qiraat Khalfa Imam</label><label>title_ar: كتاب القراءة خلف الإمام :: القراءة خلف الإمام</label><label>book: 0458Bayhaqi.QiraatKhalfaImam</label><label>author_lat: Bayhaqi</label><label>author_ar: البيهقي :: أحمد بن الحسين بن علي البيهقي أبو بكر</label><label>date: 0458</label><label>versionUri: 0458Bayhaqi.QiraatKhalfaImam.JK000631-ara1</label>
</div>
</div>
</div>
<a class="nav-link pull-right" href="#menu-toggle" id="menu-toggle" title="Book Chapters">
<i class="btn bi bi-list"></i></a>
</div>
</div>
</nav>
<div class="book-body fixed pt-5">
<div class="row">
<div class="col-12">
<div class="row top-heading-panel content-outer-spacing">
</div>
</div>
<div class="col-12" id="meta">
</div>
</div>
<div class="row justify-content-md-center" id="book-main">
<div class="col-lg-8 col-sm-12" id="content">
</div>
</div>
<div class="row mt-5" id="footer">
<div class="col-md-12">
            The KITAB project is based at the Institute for the Study of Muslim Civilizations (ISMC) at Aga Khan
            University, London, and has received funding from the European Research Council (ERC) under the European
            Union's
            Horizon 2020 research and innovation programme (Grant agreement No. 772989)

          </div>
<div class="col-md-12">
<img alt="Logos" height="50" id="logos" src="../img/AKU-EU-ERC-three-logos.jpg"/>
</div>
</div>
</div>
</div>
</div>
<script>

    var pageSel = document.getElementById("page-select");
    var volSel = document.getElementById("vol-select");
    var thisVolume = "01";
    var volPages = {"01": ["011", "012", "013", "014", "015", "016", "017", "018", "019", "020", "021", "022", "023", "024", "025", "026", "027", "028", "029", "030", "031", "032", "033", "034", "035", "036", "037", "038", "039", "040", "041", "042", "043", "044", "045", "046", "047", "048", "049", "050", "051", "052", "053", "054", "055", "056", "057", "058", "059", "060", "061", "062", "063", "064", "065", "066", "067", "068", "069", "070", "071", "072", "073", "074", "075", "076", "077", "078", "079", "080", "081", "082", "083", "084", "085", "086", "087", "088", "089", "090", "091", "092", "093", "094", "095", "096", "097", "098", "099", "100", "101", "102", "103", "104", "105", "106", "107", "108", "109", "110", "111", "112", "113", "114", "115", "116", "117", "118", "119", "120", "121", "122", "123", "124", "125", "126", "127", "128", "129", "130", "131", "132", "133", "134", "135", "136", "137", "138", "139", "140", "141", "142", "143", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "162", "163", "164", "165", "166", "167", "168", "169", "170", "171", "172", "173", "174", "175", "176", "177", "178", "179", "180", "181", "182", "183", "184", "185", "186", "187", "188", "189", "190", "191", "192", "193", "194", "195", "196", "197", "198", "199", "200", "201", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214", "215", "216", "217", "218", "219", "220", "221", "222", "223"]}; /*loaded by html_builder*/

    function goToAnchor(vol, anchorId) {
      if (vol != window.thisVolume) {
        loadVolume(vol, false).then(res => {
          console.log("Volume loaded");
          console.log("Go to anchor " + anchorId);
          /*move the volume page to the element with id=anchorId*/
          /*var targetAnchor = document.getElementById(anchorId);
          targetAnchor.scrollIntoView({block: 'nearest'});  // this does not always work...
          console.log(targetAnchor);*/
          /*window.location.hash = "";
          window.location.hash = anchorId;
          window.location.hash = anchorId;
          console.log("#"+anchorId);*/
          /*//This approach does not work at all: scrolls only main window.
          var targetAnchor = $("#"+anchorId);
          //$("#content").animate(
          $("html, body").animate(
            {scrollTop: targetAnchor.offset().top},
            1000
          );*/
          /*//This approach does not work at all: scrolls only main window.
          var targetAnchor = document.getElementById(anchorId);
          var rect = targetAnchor.getBoundingClientRect();
          console.log(targetAnchor);
          console.log(rect);
          var viewHeight=Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
          window.scroll({
            top: rect.top + rect.height / 2 - viewHeight /2,
            behavior: 'smooth'
          });*/
          /*var targetAnchor = document.getElementById(anchorId);
          var contentDiv = document.getElementsByClassName("book-body")[0];
          var topPos = contentDiv.offsetTop;
          var windowSize = $(window).height();
          console.log("topPos: " + topPos);
          console.log("targetPos: " + targetAnchor.offsetTop);
          console.log("windowSize:" + windowSize)
          console.log("targetAnchor.offsetTop-windowSize/3 = " + (targetAnchor.offsetTop - topPos - windowSize / 2));
          contentDiv.scrollTop = targetAnchor.offsetTop - topPos - windowSize / 2;*/
          var targetAnchor = document.getElementById(anchorId);
          targetAnchor.scrollIntoView({"block": "start"});
        });
      } else {
        /*move the volume page to the element with id=anchorId*/
        /*var targetAnchor = document.getElementById(anchorId);
        targetAnchor.scrollIntoView({block: 'nearest'});  // this does not always work...
        console.log(targetAnchor);*/
        /*window.location.hash = "";
        window.location.hash = anchorId;
        window.location.hash = anchorId;
        console.log("#"+anchorId);*/
        /*//This approach does not work at all: scrolls only main window.
        var targetAnchor = $("#"+anchorId);
        //$("#content").animate(
        $("html, body").animate(
          {scrollTop: targetAnchor.offset().top},
          1000
        );*/
        /*//This approach does not work at all: scrolls only main window.
        var targetAnchor = document.getElementById(anchorId);
        var rect = targetAnchor.getBoundingClientRect();
        console.log(targetAnchor);
        console.log(rect);
        var viewHeight=Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
        window.scroll({
          top: rect.top + rect.height / 2 - viewHeight /2,
          behavior: 'smooth'
        });*/
        /*var targetAnchor = document.getElementById(anchorId);
        var contentDiv = document.getElementsByClassName("book-body")[0];
        var topPos = contentDiv.offsetTop;
        var windowSize = $(window).height();
        console.log("topPos: " + topPos);
        console.log("targetPos: " + targetAnchor.offsetTop);
        console.log("windowSize:" + windowSize)
        console.log("targetAnchor.offsetTop-windowSize/3 = " + (targetAnchor.offsetTop - topPos - windowSize / 2));
        contentDiv.scrollTop = targetAnchor.offsetTop - topPos - windowSize / 2;*/
        var targetAnchor = document.getElementById(anchorId);
        targetAnchor.scrollIntoView({"block": "start"});
      }
    }

    CollapsibleLists.apply();
    console.log("Applied CollapsibleLists");

    $(document).ready(function () {
      console.log("Load initial volume " + thisVolume);
      loadVolume(thisVolume).then(res => {
        console.log("Initial volume loaded");
        $('#loading').hide();
        $('#loading').fadeOut("slow");
      });
      $(window).scroll(function () {
        if ($(this).scrollTop() > 50) {
          $('#back-to-top').fadeIn();
        } else {
          $('#back-to-top').fadeOut();
        }
      });
      // scroll body to 0px on click
      $('#back-to-top').click(function () {
        $('body,html').animate({
          scrollTop: 0
        }, 400);
        return false;
      });
      $("#menu-toggle").click(function (e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled");
      });

      $(".font-default").click(function () {

        $('#wrapper').toggleClass("font-increase", "font-default");
      });

      $(".bi-lightbulb-off").click(function () {
        $('.bi-lightbulb-off').toggleClass("bi-lightbulb", "bi-lightbulb-off");
        $('.page-wrapper').toggleClass("night-mode", "");
        $('.navbar-light').toggleClass("night-mode", "");
        console.log(this);

      });
      $('.toc-item').click(function (event) {
        /*console.log('toc item clicked');*/
        event.preventDefault();
        var clickedElement = event.target;
        /*console.log(clickedElement);*/
        var href = clickedElement.getAttribute("href");
        /*console.log('href: '+href);*/
        var vol = href.substring(0, 2);
        var head = href.split('head').pop();
        var anchorId = "head" + head;
        goToAnchor(vol, anchorId);
        return false;
      });
    });

    function loadPageNumbers(vol, page) {
      /*var pageSel = document.getElementById("page-select");*/
      pageSel.innerHTML = '';
      volPages[vol].forEach(function (p, index) {
        pageSel.options[pageSel.options.length] = new Option(p, p);
      });
      if (page) {
        pageSel.value = page;
      }
    }

    function loadVolumeNumbers(vol) {
      /*var volSel = document.getElementById("vol-select");*/
      volSel.innerHTML = '';
      /*console.log(Object.keys(volPages));*/
      /*console.log(Object.keys(volPages).sort());*/

      Object.keys(volPages).sort().forEach(function (v, index) {
        /*console.log(v);*/
        volSel.options[volSel.options.length] = new Option(v, v);
      });
      volSel.value = vol;
    }

    async function loadVolume(vol) {
      /*Load volume json */
      var page = pageSel.value;
      $('#loading').show();
      console.log("loading volume " + vol);
      await $.getJSON(vol + ".json", function (json) {
        console.log(json)
        $('#content').empty().append(json["content"]);
        /*console.log("json loaded");*/
        window.thisVolume = vol;
        $('#loading').hide();
        $('#loading').fadeOut("slow");
        /*Load volume and page numbers in page-nav form:*/
        loadVolumeNumbers(vol);
        loadPageNumbers(vol, page);
        return true;
      });
    }


    function padWithZeros(number, width) {
      number = number + "";
      if (number.length >= width) {
        return number;
      } else {
        return new Array(width - number.length + 1).join("0") + number;
      }
    }
    document.getElementById("nav-form").addEventListener("submit", function (event) {
      event.preventDefault();
      /*console.log("Clicked Go");*/
      var vol = volSel.value;
      console.log("vol: " + vol);
      /*var targetPage = parseInt(pageSel.value, 10);
      if (page >= 1) {
        page = page-1; //page number is at bottom of page
      }
      var anchor = "v"+vol+"p"+padWithZeros(targetPage, 3);*/
      var targetPage = pageSel.value;
      var pages = volPages[vol];
      var index = pages.indexOf(targetPage);
      if (index > 0) {
        targetPage = pages[index-1];
      }

      console.log("targetPage: " + targetPage);
      var anchor = "v" + vol + "p" + targetPage;
      goToAnchor(vol, anchor);
      return false;
    });

    /*Adapt the page numbers list when the volume number changes:*/
    volSel.addEventListener("change", function (event) {
      var vol = this.value;
      var page = pageSel.value;
      loadPageNumbers(vol, page);
    });


  </script>
</body>
</html>
