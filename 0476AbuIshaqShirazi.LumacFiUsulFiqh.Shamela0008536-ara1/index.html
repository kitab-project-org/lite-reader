<html dir="rtl" lang="ar">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta http-equiv="Content-Security-Policy" https:=""/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script crossorigin="anonymous" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js"></script>
<link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" rel="stylesheet"/>
<link href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Amiri&amp;display=swap" rel="stylesheet"/>
<!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css"
        integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous"> -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css" rel="stylesheet"/>
<link crossorigin="anonymous" href="../css/stylev2.css" rel="stylesheet" type="text/css"/>
<script crossorigin="anonymous" src="../js/CollapsibleLists.js" type="application/javascript"></script>
<!-- <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/alpheios-components@latest/dist/style/style-components.min.css" /> -->
<script type="text/javascript">
</script>
</head>
<body>
<div id="loading">
<img alt="Loading..." id="loading-image" src="../img/spinner1.gif"/>
</div>
<div class="page-wrapper toggled" id="wrapper">
<div id="sidebar-wrapper">
<html><body><div class="card-header title-heading">فصول الكتاب</div><ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head0">مقدمة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head1">الكلام في الأمر والنهي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head2">باب القول في بيان الأمر وصيغته</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head3">2- </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head4">باب ما يقتضي الأمر من الإيجاب</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head5">باب في أن الأمر يقتضي الفعل مرة واحدة أو التكرار</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head6">باب في أن الأمر هل يقتضي الفعل على الفور أم لا</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head7">باب الأمر بأشياء على ms011 جهة التخيير والترتيب</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head8">باب إيجاب ما لا يتم المأمور إلا به</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head9">باب الأمر يدل على إجراء المأمور به</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head10">باب من يدخل في الأمر ومن لا يدخل فيه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head11">باب بيان الفرض والواجب والسنة والندب</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head12">باب القول في النهي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head13">باب القول في العموم والخصوص</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head14">باب بيان ما يصح دعوى العموم فيه وما لا يصح</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head15">باب القول في الخصوص</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head16">باب ذكر ما يجوز تخصيصه وما لا يجوز</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head17">باب بيان الأدلة التي يجوز التخصيص بها وما لا يجوز</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head18">باب القول في اللفظ الوارد على سبب</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head19">باب القول في الاستثناء</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head20">باب التخصيص في الشرط</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head21">باب القول في المطلق والمقيد</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head22">باب القول في مفهوم الخطاب</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head23">الكلام في المجمل والمبين</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head24">باب ذكره وجوه المبين</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head25">باب ذكر وجوه المجمل</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head26">باب الكلام في البيان ووجوهه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head27">باب تأخير البيان</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head28">الكلام في النسخ</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head29">باب بيان النسخ</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head30">باب بيان ما يجوز نسخه من الأحكام وما لا يجوز</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head31">باب بيان وجوه النسخ</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head32">باب ما يجوز به النسخ وما لا يجوز</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head33">باب ms045 ما يعرف به الناسخ من المنسوخ</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head34">باب الكلام في نسخ بعض العبادة والزيادة فيها</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head35">باب القول في شرع من قبلنا وما ثبت في الشرع ولم يتصل بالأمة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head36">باب القول في حروف المعاني</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head37">باب الكلام في أفعال رسول الله صلى الله عليه ms050 وسلم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head38">باب القول في الإقرار والسكت عن الحكم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head39">باب القول في الأخبار</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head40">باب القول في الخبر المتواتر</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head41">باب القول في أخبار الآحاد</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head42">باب القول في المراسيل</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head43">باب صفة الراوي ومن يقبل خبره</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head44">باب القول في الجرح والتعديل</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head45">باب القول في حقيقة الرواية وما يتصل به</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head46">باب بيان ما يرد به خبر الواحد</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head47">باب القول في ترجيح أحد الخبرين على الآخر</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head48">القول في الإجماع</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head49">باب ذكر معنى الإجماع وإثباته</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head50">باب ذكر ما ينعقد به الإجماع وما جعل حجة فيه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head51">باب ما يعرف به الإجماع</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head52">باب ما يصح من الإجماع وما لا يصح ومن يعتبر قوله ومن لا يعتبر</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head53">باب الإجماع بعد الخلاف</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head54">باب القول في اختلاف الصحابة على قولين</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head55">باب القول في قول الواحد من الصحابة وترجيح بعضهم على بعض</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head56">الكلام في القياس</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head57">باب بيان حد القياس</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head58">باب إثبات القياس وما جعل حجة فيه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head59">باب أقسام القياس</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head60">باب الكلام في بيان ما يشتمل القياس عليه على التفصيل</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head61">باب بيان الأصل وما يجوز أن يكون أصلا وما لا يجوز</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head62">باب القول في بيان العلة وما يجوز أن يعلل به وما لا يجوز</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head63">باب بيان الحكم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head64">باب بيان ما يدل على صحة العلة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head65">باب بيان ما يفسد العلة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head66">باب القول في تعارض العلتين</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head67">باب القول في ترجيح إحدى العلتين على الأخرى</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head68">باب القول في الاستحسان</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head69">باب القول فبي بيان الأشياء قبل الشرع واستصحاب الحال والقول بأقل ما قيل وإيجاب الدليل على الباقي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head70">باب في بيان ترتيب استعمال الأدلة واستخراجها</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head71">القول في التقليد</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head72">باب بيان ما يسوغ فيه التقليد وما لا يسوغ</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head73">القول في الاجهاد</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head74">باب القول في أقوال المجتهدين وأن الحق منهما في واحد أو كل مجتهد مصيب</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head75">باب القول في تخريج المجتهد المسألة على قولين</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head76">باب القول في اجتهاد رسول الله صلى الله عليه وسلم والاجتهاد بحضرته</a>
</li>
</ul>
</body></html></div>
<div class="book body-inner" lang="ara">
<nav class="navbar navbar-expand-lg navbar-light bg-light sticky-top border-bottom" style="direction: ltr;">
<div class="mr-auto d-flex justify-content-left">
<a class="navbar-brand ms-2" href="http://www.kitab-project.org" target="_blank">
<img class="d-inline-block align-top" src="https://cdn.jsdelivr.net/gh/sohailmerchant/kitab-cdn@main/img/kitab-logo.png" width="60px"/>
</a>
</div>
<div class="navbar-nav mx-auto btn-toolbar" style="direction: rtl;">
<div class="d-flex justify-content-center">
<form class="row" id="nav-form" style="margin-bottom: 0px;">
<span class="btn col justify-content-center">ج:</span>
<select class="col form-select pull-left" id="vol-select"></select>
<span class="btn col justify-content-center">ص:</span>
<select class="col form-select pull-left" id="page-select"></select>
<button class="btn col pull-right mx-3" id="nav-submdit-btn" style="width: 100px;" type="submit" value="Go">Go</button>
</form>
</div>
</div>
<div class="btn-toolbar navbar-nav ml-auto d-flex justify-content-right">
<div class="btn-group">
<a class="nav-link pull-right" title="Go to top">
<i class="btn bi bi-arrow-up-circle" id="back-to-top"></i>
</a>
<a class="nav-link pull-right" title="Increase fonts">
<i class="btn bi bi-fonts font-default pull-left"></i>
</a>
<a class="nav-link pull-right" title="Turn light off">
<i class="btn bi bi-lightbulb-off"></i>
</a>
<div class="nav-link pull-right dropdown">
<a aria-expanded="false" aria-haspopup="true" class="" data-bs-toggle="dropdown" id="dropdownMenuButton" role="button" title="Book Metadata">
<i class="btn bi bi-info"></i>
</a>
<div aria-labelledby="dropdownMenuButton" class="dropdown-menu">
<div class="col-12" id="metadata-content"><label>char_length: 130885</label><label>author_lat_full_name: </label><label>author_lat_shuhra: </label><label>author_from_uri: Abu Ishaq Shirazi</label><label>tags: CENT0500 :: _FIQH :: _QAWACID :: _SUNNI :: _USUL :: GAL@literature-islamic :: GAL@1000-1258CE :: GAL@literature-arabic :: GAL@period-postclassical :: GAL@shafiis :: GAL@fiqh :: Shamela@أصول الفقه والقواعد الفقهية</label><label>url: https://raw.githubusercontent.com/OpenITI/0500AH/master/data/0476AbuIshaqShirazi/0476AbuIshaqShirazi.LumacFiUsulFiqh/0476AbuIshaqShirazi.LumacFiUsulFiqh.Shamela0008536-ara1</label><label>tok_length: 32244</label><label>status: sec</label><label>id: Shamela0008536</label><label>ed_info: دار الكتب العلمية</label><label>title_lat: Lumac Fi Usul Fiqh</label><label>title_ar: اللمع في أصول الفقه</label><label>book: 0476AbuIshaqShirazi.LumacFiUsulFiqh</label><label>author_lat: Abu Ishaq Shirazi</label><label>author_ar: أبو اسحاق إبراهيم بن علي بن يوسف الشيرازي (المتوفى: 476هـ)</label><label>date: 0476</label><label>versionUri: 0476AbuIshaqShirazi.LumacFiUsulFiqh.Shamela0008536-ara1</label>
</div>
</div>
</div>
<a class="nav-link pull-right" href="#menu-toggle" id="menu-toggle" title="Book Chapters">
<i class="btn bi bi-list"></i></a>
</div>
</div>
</nav>
<div class="book-body fixed pt-5">
<div class="row">
<div class="col-12">
<div class="row top-heading-panel content-outer-spacing">
</div>
</div>
<div class="col-12" id="meta">
</div>
</div>
<div class="row justify-content-md-center" id="book-main">
<div class="col-lg-8 col-sm-12" id="content">
</div>
</div>
<div class="row mt-5" id="footer">
<div class="col-md-12">
            The KITAB project is based at the Institute for the Study of Muslim Civilizations (ISMC) at Aga Khan
            University, London, and has received funding from the European Research Council (ERC) under the European
            Union's
            Horizon 2020 research and innovation programme (Grant agreement No. 772989)

          </div>
<div class="col-md-12">
<img alt="Logos" height="50" id="logos" src="../img/AKU-EU-ERC-three-logos.jpg"/>
</div>
</div>
</div>
</div>
</div>
<script>

    var pageSel = document.getElementById("page-select");
    var volSel = document.getElementById("vol-select");
    var thisVolume = "01";
    var volPages = {"01": ["000", "003", "004", "005", "006", "007", "008", "009", "010", "011", "012", "013", "013", "014", "014", "015", "015", "016", "017", "018", "018", "019", "017", "019", "020", "020", "021", "022", "023", "023", "024", "024", "025", "026", "027", "028", "028", "029", "030", "030", "031", "031", "032", "032", "033", "034", "035", "036", "037", "038", "038", "039", "039", "040", "041", "041", "042", "043", "043", "044", "044", "045", "046", "047", "048", "049", "049", "050", "051", "052", "052", "053", "053", "054", "055", "056", "056", "057", "057", "058", "059", "060", "061", "061", "062", "062", "063", "063", "064", "065", "066", "067", "067", "068", "069", "069", "070", "071", "071", "072", "072", "073", "074", "075", "073", "075", "076", "077", "077", "078", "079", "080", "080", "081", "082", "082", "083", "083", "084", "085", "086", "087", "088", "088", "089", "089", "090", "090", "091", "092", "092", "093", "093", "094", "094", "095", "096", "096", "097", "098", "098", "099", "100", "101", "102", "102", "102", "103", "104", "104", "105", "106", "107", "108", "109", "109", "110", "111", "112", "113", "114", "115", "116", "117", "117", "118", "118", "119", "120", "121", "122", "123", "124", "125", "126", "127", "128", "129", "130", "131", "131", "132", "133", "133", "134"]}; /*loaded by html_builder*/

    function goToAnchor(vol, anchorId) {
      if (vol != window.thisVolume) {
        loadVolume(vol, false).then(res => {
          console.log("Volume loaded");
          console.log("Go to anchor " + anchorId);
          /*move the volume page to the element with id=anchorId*/
          /*var targetAnchor = document.getElementById(anchorId);
          targetAnchor.scrollIntoView({block: 'nearest'});  // this does not always work...
          console.log(targetAnchor);*/
          /*window.location.hash = "";
          window.location.hash = anchorId;
          window.location.hash = anchorId;
          console.log("#"+anchorId);*/
          /*//This approach does not work at all: scrolls only main window.
          var targetAnchor = $("#"+anchorId);
          //$("#content").animate(
          $("html, body").animate(
            {scrollTop: targetAnchor.offset().top},
            1000
          );*/
          /*//This approach does not work at all: scrolls only main window.
          var targetAnchor = document.getElementById(anchorId);
          var rect = targetAnchor.getBoundingClientRect();
          console.log(targetAnchor);
          console.log(rect);
          var viewHeight=Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
          window.scroll({
            top: rect.top + rect.height / 2 - viewHeight /2,
            behavior: 'smooth'
          });*/
          /*var targetAnchor = document.getElementById(anchorId);
          var contentDiv = document.getElementsByClassName("book-body")[0];
          var topPos = contentDiv.offsetTop;
          var windowSize = $(window).height();
          console.log("topPos: " + topPos);
          console.log("targetPos: " + targetAnchor.offsetTop);
          console.log("windowSize:" + windowSize)
          console.log("targetAnchor.offsetTop-windowSize/3 = " + (targetAnchor.offsetTop - topPos - windowSize / 2));
          contentDiv.scrollTop = targetAnchor.offsetTop - topPos - windowSize / 2;*/
          var targetAnchor = document.getElementById(anchorId);
          targetAnchor.scrollIntoView({"block": "start"});
        });
      } else {
        /*move the volume page to the element with id=anchorId*/
        /*var targetAnchor = document.getElementById(anchorId);
        targetAnchor.scrollIntoView({block: 'nearest'});  // this does not always work...
        console.log(targetAnchor);*/
        /*window.location.hash = "";
        window.location.hash = anchorId;
        window.location.hash = anchorId;
        console.log("#"+anchorId);*/
        /*//This approach does not work at all: scrolls only main window.
        var targetAnchor = $("#"+anchorId);
        //$("#content").animate(
        $("html, body").animate(
          {scrollTop: targetAnchor.offset().top},
          1000
        );*/
        /*//This approach does not work at all: scrolls only main window.
        var targetAnchor = document.getElementById(anchorId);
        var rect = targetAnchor.getBoundingClientRect();
        console.log(targetAnchor);
        console.log(rect);
        var viewHeight=Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
        window.scroll({
          top: rect.top + rect.height / 2 - viewHeight /2,
          behavior: 'smooth'
        });*/
        /*var targetAnchor = document.getElementById(anchorId);
        var contentDiv = document.getElementsByClassName("book-body")[0];
        var topPos = contentDiv.offsetTop;
        var windowSize = $(window).height();
        console.log("topPos: " + topPos);
        console.log("targetPos: " + targetAnchor.offsetTop);
        console.log("windowSize:" + windowSize)
        console.log("targetAnchor.offsetTop-windowSize/3 = " + (targetAnchor.offsetTop - topPos - windowSize / 2));
        contentDiv.scrollTop = targetAnchor.offsetTop - topPos - windowSize / 2;*/
        var targetAnchor = document.getElementById(anchorId);
        targetAnchor.scrollIntoView({"block": "start"});
      }
    }

    CollapsibleLists.apply();
    console.log("Applied CollapsibleLists");

    $(document).ready(function () {
      console.log("Load initial volume " + thisVolume);
      loadVolume(thisVolume).then(res => {
        console.log("Initial volume loaded");
        $('#loading').hide();
        $('#loading').fadeOut("slow");
      });
      $(window).scroll(function () {
        if ($(this).scrollTop() > 50) {
          $('#back-to-top').fadeIn();
        } else {
          $('#back-to-top').fadeOut();
        }
      });
      // scroll body to 0px on click
      $('#back-to-top').click(function () {
        $('body,html').animate({
          scrollTop: 0
        }, 400);
        return false;
      });
      $("#menu-toggle").click(function (e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled");
      });

      $(".font-default").click(function () {

        $('#wrapper').toggleClass("font-increase", "font-default");
      });

      $(".bi-lightbulb-off").click(function () {
        $('.bi-lightbulb-off').toggleClass("bi-lightbulb", "bi-lightbulb-off");
        $('.page-wrapper').toggleClass("night-mode", "");
        $('.navbar-light').toggleClass("night-mode", "");
        console.log(this);

      });
      $('.toc-item').click(function (event) {
        /*console.log('toc item clicked');*/
        event.preventDefault();
        var clickedElement = event.target;
        /*console.log(clickedElement);*/
        var href = clickedElement.getAttribute("href");
        /*console.log('href: '+href);*/
        var vol = href.substring(0, 2);
        var head = href.split('head').pop();
        var anchorId = "head" + head;
        goToAnchor(vol, anchorId);
        return false;
      });
    });

    function loadPageNumbers(vol, page) {
      /*var pageSel = document.getElementById("page-select");*/
      pageSel.innerHTML = '';
      volPages[vol].forEach(function (p, index) {
        pageSel.options[pageSel.options.length] = new Option(p, p);
      });
      if (page) {
        pageSel.value = page;
      }
    }

    function loadVolumeNumbers(vol) {
      /*var volSel = document.getElementById("vol-select");*/
      volSel.innerHTML = '';
      /*console.log(Object.keys(volPages));*/
      /*console.log(Object.keys(volPages).sort());*/

      Object.keys(volPages).sort().forEach(function (v, index) {
        /*console.log(v);*/
        volSel.options[volSel.options.length] = new Option(v, v);
      });
      volSel.value = vol;
    }

    async function loadVolume(vol) {
      /*Load volume json */
      var page = pageSel.value;
      $('#loading').show();
      console.log("loading volume " + vol);
      await $.getJSON(vol + ".json", function (json) {
        console.log(json)
        $('#content').empty().append(json["content"]);
        /*console.log("json loaded");*/
        window.thisVolume = vol;
        $('#loading').hide();
        $('#loading').fadeOut("slow");
        /*Load volume and page numbers in page-nav form:*/
        loadVolumeNumbers(vol);
        loadPageNumbers(vol, page);
        return true;
      });
    }


    function padWithZeros(number, width) {
      number = number + "";
      if (number.length >= width) {
        return number;
      } else {
        return new Array(width - number.length + 1).join("0") + number;
      }
    }
    document.getElementById("nav-form").addEventListener("submit", function (event) {
      event.preventDefault();
      /*console.log("Clicked Go");*/
      var vol = volSel.value;
      console.log("vol: " + vol);
      /*var targetPage = parseInt(pageSel.value, 10);
      if (page >= 1) {
        page = page-1; //page number is at bottom of page
      }
      var anchor = "v"+vol+"p"+padWithZeros(targetPage, 3);*/
      var targetPage = pageSel.value;
      var pages = volPages[vol];
      var index = pages.indexOf(targetPage);
      if (index > 0) {
        targetPage = pages[index-1];
      }

      console.log("targetPage: " + targetPage);
      var anchor = "v" + vol + "p" + targetPage;
      goToAnchor(vol, anchor);
      return false;
    });

    /*Adapt the page numbers list when the volume number changes:*/
    volSel.addEventListener("change", function (event) {
      var vol = this.value;
      var page = pageSel.value;
      loadPageNumbers(vol, page);
    });


  </script>
</body>
</html>
