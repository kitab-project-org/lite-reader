<html dir="rtl" lang="ar">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta http-equiv="Content-Security-Policy" https:=""/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script crossorigin="anonymous" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js"></script>
<link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" rel="stylesheet"/>
<link href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Amiri&amp;display=swap" rel="stylesheet"/>
<!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css"
        integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous"> -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css" rel="stylesheet"/>
<link crossorigin="anonymous" href="../css/stylev2.css" rel="stylesheet" type="text/css"/>
<script crossorigin="anonymous" src="../js/CollapsibleLists.js" type="application/javascript"></script>
<!-- <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/alpheios-components@latest/dist/style/style-components.min.css" /> -->
<script type="text/javascript">
</script>
</head>
<body>
<div id="loading">
<img alt="Loading..." id="loading-image" src="../img/spinner1.gif"/>
</div>
<div class="page-wrapper toggled" id="wrapper">
<div id="sidebar-wrapper">
<html><body><div class="card-header title-heading">فصول الكتاب</div><ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head0">1 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head1">: «إن المقيم بها ثلاثة أيام من غير رياء، كمن عبد الله سبعين سنة ما بين الروم </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head2">2 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head3">: «المرابط بها من غير رياء كمن عبد الله سبعين سنة فيما بين الروم والعرب»</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head4">3 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head5">: «المقيم بها ثلاثة أيام من غير رياء بمنزلة من عبد الله تعالى سبعين سنة ما بين الروم </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head6">4 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head7">: «إن الإسكندرية وعسقلان عروسان، والإسكندرية أعظمهما عروسا، وإنها لتأتي يوم القيامة تزف </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head8">5 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head9">: «الإسكندرية وعسقلان عروسان، والإسكندرية أفضلهما، وإنها لتأتي يوم القيامة تزف بأهلها إلى </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head10">6 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head11">: " مدينتان من مدائن القدم، وإنهما سيفتحان على أمتي، إحداهما من مدائن الروم يقال لها: </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head12">7 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head13">8 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head14">9 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head15">10 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head16">11 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head17">12 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head18">13 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head19">: «رأيت أناسا من أمتي في أصلاب الرجال لم تحملهن النساء في أرحامهن، يبعثهم الله عز وجل من </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head20">14 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head21">15 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head22">: «إن في الإسكندرية وقزوين بابين من أبواب الجنة فمن رابط إلى إحداهما ليلة وجبت له </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head23">16 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head24">: «إنهما سيفتحان على أمتي، وإنهما بابان من أبواب الجنة، من رابط فيهما أو في أحدهما ليلة </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head25">17 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head26">: «لأن أبيت ليلة بالإسكندرية على فراش وطيء، وطعام طيب، لا تدخل في رجلي شوكة، ولا ألقى عدوا </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head27">18 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head28">: «أحب الرباط إلى الله تعالى بالإسكندرية لأنها تشرف على الخلائق يوم القيامة في صورة المدينة </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head29">19 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head30">: " في خير أرض وأحبها إلى الله تعالى تعرف بالساهرة وهي أرض فلسطين، وغور الأردن، والإسكندرية، </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head31">20 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head32">21 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head33">: «والذي نفسي بيده لرباط ثلاثة أيام بالإسكندرية أفضل عند الله تعالى من عبادة ألف عام، صيام </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head34">22 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head35">23 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head36">: «سيفتح لكم الشام، ومصر، والإسكندرية، وليرابطن فيها، فليبلغن الشاهد منكم الغائب، إن الله </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head37">24 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head38">: «أحب الرباط إلى الله تعالى الإسكندرية، إنها تشرف على الخلائق يوم القيامة في صورة مدينة من </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head39">25 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head40">26 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head41">: " من صلى أربع ركعات والضحى بعسقلان، أو بقيسارية فلسطين، أو في الإسكندرية، كل يوم عليها </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head42">27 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head43">: «أقمت بها ثلاثة فقصرت الصلاة، والمقصر فيها كمن أتم الصلاة سبعين سنة» .</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head44">28 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head45">29 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head46">30 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head47">: «كل ميت يختم على عمله إلا المرابط في سبيل الله تعالى، فإنه ينمو له عمله إلى يوم القيامة، </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head48">31 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head49">: «من مات مرابطا في سبيل الله أجري عليه عمله الصالح الذي كان يعمله، وأجري عليه رزقه، وأمن من </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head50">32 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head51">: «العلم والسكينة والحج والإيمان والفضل في المغرب، والجفاء والكفر في </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head52">33 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head53">34 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head54">: " صليت ليلة أسري بي على الباب الثالث من أبواب الإسكندرية ومعي جبريل، عليه السلام في ms10 سبعين </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head55">35 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head56">: " يا أبا هريرة طوبى لقوم من أمتي يموتون على ساحل البحر، يخرجون من قبورهم يوم القيامة، يشفع </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head57">36 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head58">37 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head59">: «المرابط في سبيل الله تعالى على ساحل البحر في كل يوم له دعوة مستجابة»</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head60">38 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head61">: «من رابط بها ثلاثة أيام من غير رياء كمن عبد الله تعالى سبعين سنة فيما بين الروم </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head62">39 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head63">40 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head64">: «ستكون لكم مشايخ، وخير مشايخكم في الغرب» .</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head65">41 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head66">42 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head67">43 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head68">: «من كبر بشاطئ بحر الروم تكبيرة ولا يريد بها إلا وجه الله تعالى والدار الآخرة، جعل الله في </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head69">44 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head70">45 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head71">46 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head72">: «إني قد أمددتك بعبد الله بن مطيع في أربعة آلاف من أهل المدينة، وأمرت معن بن يزيد السلمي أن </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head73">47 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head74">: " إني أخاف أن تخرب هذه المنازل إذا كنتم تتعاورونها، فلما كان عند الكريون، قال: سيروا على </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head75">48 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head76">، «أنه افتتح الإسكندرية الفتح الأخير عنوة فسرى في خلافة عثمان بن عفان، رضي الله عنه بعد موت </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head77">49 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head78">«يخيرهم فإن دخلوا في الإسلام فذلك، وإن كرهوا فارددهم إلى قراهم»</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head79">50 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head80">51 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head81">52 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head82">53 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head83">54 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head84">: «المقيم بها ثلاثة أيام من غير رياء بمنزلة من عبد الله تعالى سبعين ألف سنة ما بين الروم </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head85">55 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head86">: «إذا انتاط عدوكم، وكثرت العزائم، واستحلت الغنائم، فخير جهادكم الرباط»</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head87">56 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head88">: «من رابط حارسا وراء المسلمين كان له مثل أجر من خلفه ممن صام وصلى»</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head89">57 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head90">: «ما اغبرت قدما عبد في سبيل الله تعالى فتمسهما النار أبدا»</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head91">58 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head92">: " لا يزال الجهاد حلوا أخضر ما قطرت السماء وأنبتت الأرض، وسينتشئ نشء من قبل المشرق يقولون: </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head93">59 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head94">: «الخيل معقود في نواصيها الخير إلى يوم القيامة، وأهلها معانون عليها كالماد يده بالصدقة لا </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head95">60 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head96">: «كل ميت يختم على عمله، إلا المرابط فإنه يجري عليه عمله حتى يبعثه الله </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head97">61 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head98">: «حرس ليلة في سبيل الله أفضل من ألف ليلة يصوم نهارها، ويقوم ليلها»</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head99">62 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head100">: " من رابط اثني عشر ليلة، أو قال: يوما، في سبيل الله تعالى فليجتهد عباد المساجد ms17 أن يدركوا </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head101">63 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head102">: «رباط يوم وليلة في سبيل الله تعالى خير من صيام شهر وقيامه، فإن مات جرى عليه عمله الذي كان </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head103">64 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head104">: «من تقلد سيفا ليلة جمعة في سبيل الله مرابطا لا يريد بذلك إلا وجه الله تعالى ثم مات بعد </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head105">65 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head106">66 - </a>
</li>
</ul>
</body></html></div>
<div class="book body-inner" lang="ara">
<nav class="navbar navbar-expand-lg navbar-light bg-light sticky-top border-bottom" style="direction: ltr;">
<div class="mr-auto d-flex justify-content-left">
<a class="navbar-brand ms-2" href="http://www.kitab-project.org" target="_blank">
<img class="d-inline-block align-top" src="https://cdn.jsdelivr.net/gh/sohailmerchant/kitab-cdn@main/img/kitab-logo.png" width="60px"/>
</a>
</div>
<div class="navbar-nav mx-auto btn-toolbar" style="direction: rtl;">
<div class="d-flex justify-content-center">
<form class="row" id="nav-form" style="margin-bottom: 0px;">
<span class="btn col justify-content-center">ج:</span>
<select class="col form-select pull-left" id="vol-select"></select>
<span class="btn col justify-content-center">ص:</span>
<select class="col form-select pull-left" id="page-select"></select>
<button class="btn col pull-right mx-3" id="nav-submdit-btn" style="width: 100px;" type="submit" value="Go">Go</button>
</form>
</div>
</div>
<div class="btn-toolbar navbar-nav ml-auto d-flex justify-content-right">
<div class="btn-group">
<a class="nav-link pull-right" title="Go to top">
<i class="btn bi bi-arrow-up-circle" id="back-to-top"></i>
</a>
<a class="nav-link pull-right" title="Increase fonts">
<i class="btn bi bi-fonts font-default pull-left"></i>
</a>
<a class="nav-link pull-right" title="Turn light off">
<i class="btn bi bi-lightbulb-off"></i>
</a>
<div class="nav-link pull-right dropdown">
<a aria-expanded="false" aria-haspopup="true" class="" data-bs-toggle="dropdown" id="dropdownMenuButton" role="button" title="Book Metadata">
<i class="btn bi bi-info"></i>
</a>
<div aria-labelledby="dropdownMenuButton" class="dropdown-menu">
<div class="col-12" id="metadata-content"><label>char_length: 27452</label><label>author_lat_full_name: </label><label>author_lat_shuhra: </label><label>author_from_uri: Ibn Salah Shahrazuri</label><label>tags: CENT0700 :: _HADITH :: _MAKHTUTAT :: GAL@literature-islamic :: GAL@1000-1258CE :: GAL@iraq :: GAL@hadith :: GAL@arabia :: GAL@literature-arabic :: GAL@jazira :: GAL@period-postclassical :: GAL@syria :: Shamela@مخطوطات حديثية</label><label>url: https://raw.githubusercontent.com/OpenITI/0650AH/master/data/0643IbnSalahShahrazuri/0643IbnSalahShahrazuri.AhadithFiFadlIskandariyyaWaCasqalan/0643IbnSalahShahrazuri.AhadithFiFadlIskandariyyaWaCasqalan.Shamela0030242-ara1</label><label>tok_length: 6691</label><label>status: pri</label><label>id: Shamela0030242</label><label>ed_info: مخطوط نشر في برنامج جوامع الكلم المجاني التابع لموقع الشبكة الإسلامية</label><label>title_lat: Ahadith Fi Fadl Iskandariyya Wa Casqalan</label><label>title_ar: أحاديث في فضل الإسكندرية وعسقلان</label><label>book: 0643IbnSalahShahrazuri.AhadithFiFadlIskandariyyaWaCasqalan</label><label>author_lat: Ibn Salah Shahrazuri</label><label>author_ar: عثمان بن عبد الرحمن، أبو عمرو، تقي الدين المعروف بابن الصلاح (المتوفى: 643هـ)</label><label>date: 0643</label><label>versionUri: 0643IbnSalahShahrazuri.AhadithFiFadlIskandariyyaWaCasqalan.Shamela0030242-ara1</label>
</div>
</div>
</div>
<a class="nav-link pull-right" href="#menu-toggle" id="menu-toggle" title="Book Chapters">
<i class="btn bi bi-list"></i></a>
</div>
</div>
</nav>
<div class="book-body fixed pt-5">
<div class="row">
<div class="col-12">
<div class="row top-heading-panel content-outer-spacing">
</div>
</div>
<div class="col-12" id="meta">
</div>
</div>
<div class="row justify-content-md-center" id="book-main">
<div class="col-lg-8 col-sm-12" id="content">
</div>
</div>
<div class="row mt-5" id="footer">
<div class="col-md-12">
            The KITAB project is based at the Institute for the Study of Muslim Civilizations (ISMC) at Aga Khan
            University, London, and has received funding from the European Research Council (ERC) under the European
            Union's
            Horizon 2020 research and innovation programme (Grant agreement No. 772989)

          </div>
<div class="col-md-12">
<img alt="Logos" height="50" id="logos" src="../img/AKU-EU-ERC-three-logos.jpg"/>
</div>
</div>
</div>
</div>
</div>
<script>

    var pageSel = document.getElementById("page-select");
    var volSel = document.getElementById("vol-select");
    var thisVolume = "01";
    var volPages = {"01": ["000", "001"]}; /*loaded by html_builder*/

    function goToAnchor(vol, anchorId) {
      if (vol != window.thisVolume) {
        loadVolume(vol, false).then(res => {
          console.log("Volume loaded");
          console.log("Go to anchor " + anchorId);
          /*move the volume page to the element with id=anchorId*/
          /*var targetAnchor = document.getElementById(anchorId);
          targetAnchor.scrollIntoView({block: 'nearest'});  // this does not always work...
          console.log(targetAnchor);*/
          /*window.location.hash = "";
          window.location.hash = anchorId;
          window.location.hash = anchorId;
          console.log("#"+anchorId);*/
          /*//This approach does not work at all: scrolls only main window.
          var targetAnchor = $("#"+anchorId);
          //$("#content").animate(
          $("html, body").animate(
            {scrollTop: targetAnchor.offset().top},
            1000
          );*/
          /*//This approach does not work at all: scrolls only main window.
          var targetAnchor = document.getElementById(anchorId);
          var rect = targetAnchor.getBoundingClientRect();
          console.log(targetAnchor);
          console.log(rect);
          var viewHeight=Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
          window.scroll({
            top: rect.top + rect.height / 2 - viewHeight /2,
            behavior: 'smooth'
          });*/
          /*var targetAnchor = document.getElementById(anchorId);
          var contentDiv = document.getElementsByClassName("book-body")[0];
          var topPos = contentDiv.offsetTop;
          var windowSize = $(window).height();
          console.log("topPos: " + topPos);
          console.log("targetPos: " + targetAnchor.offsetTop);
          console.log("windowSize:" + windowSize)
          console.log("targetAnchor.offsetTop-windowSize/3 = " + (targetAnchor.offsetTop - topPos - windowSize / 2));
          contentDiv.scrollTop = targetAnchor.offsetTop - topPos - windowSize / 2;*/
          var targetAnchor = document.getElementById(anchorId);
          targetAnchor.scrollIntoView({"block": "start"});
        });
      } else {
        /*move the volume page to the element with id=anchorId*/
        /*var targetAnchor = document.getElementById(anchorId);
        targetAnchor.scrollIntoView({block: 'nearest'});  // this does not always work...
        console.log(targetAnchor);*/
        /*window.location.hash = "";
        window.location.hash = anchorId;
        window.location.hash = anchorId;
        console.log("#"+anchorId);*/
        /*//This approach does not work at all: scrolls only main window.
        var targetAnchor = $("#"+anchorId);
        //$("#content").animate(
        $("html, body").animate(
          {scrollTop: targetAnchor.offset().top},
          1000
        );*/
        /*//This approach does not work at all: scrolls only main window.
        var targetAnchor = document.getElementById(anchorId);
        var rect = targetAnchor.getBoundingClientRect();
        console.log(targetAnchor);
        console.log(rect);
        var viewHeight=Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
        window.scroll({
          top: rect.top + rect.height / 2 - viewHeight /2,
          behavior: 'smooth'
        });*/
        /*var targetAnchor = document.getElementById(anchorId);
        var contentDiv = document.getElementsByClassName("book-body")[0];
        var topPos = contentDiv.offsetTop;
        var windowSize = $(window).height();
        console.log("topPos: " + topPos);
        console.log("targetPos: " + targetAnchor.offsetTop);
        console.log("windowSize:" + windowSize)
        console.log("targetAnchor.offsetTop-windowSize/3 = " + (targetAnchor.offsetTop - topPos - windowSize / 2));
        contentDiv.scrollTop = targetAnchor.offsetTop - topPos - windowSize / 2;*/
        var targetAnchor = document.getElementById(anchorId);
        targetAnchor.scrollIntoView({"block": "start"});
      }
    }

    CollapsibleLists.apply();
    console.log("Applied CollapsibleLists");

    $(document).ready(function () {
      console.log("Load initial volume " + thisVolume);
      loadVolume(thisVolume).then(res => {
        console.log("Initial volume loaded");
        $('#loading').hide();
        $('#loading').fadeOut("slow");
      });
      $(window).scroll(function () {
        if ($(this).scrollTop() > 50) {
          $('#back-to-top').fadeIn();
        } else {
          $('#back-to-top').fadeOut();
        }
      });
      // scroll body to 0px on click
      $('#back-to-top').click(function () {
        $('body,html').animate({
          scrollTop: 0
        }, 400);
        return false;
      });
      $("#menu-toggle").click(function (e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled");
      });

      $(".font-default").click(function () {

        $('#wrapper').toggleClass("font-increase", "font-default");
      });

      $(".bi-lightbulb-off").click(function () {
        $('.bi-lightbulb-off').toggleClass("bi-lightbulb", "bi-lightbulb-off");
        $('.page-wrapper').toggleClass("night-mode", "");
        $('.navbar-light').toggleClass("night-mode", "");
        console.log(this);

      });
      $('.toc-item').click(function (event) {
        /*console.log('toc item clicked');*/
        event.preventDefault();
        var clickedElement = event.target;
        /*console.log(clickedElement);*/
        var href = clickedElement.getAttribute("href");
        /*console.log('href: '+href);*/
        var vol = href.substring(0, 2);
        var head = href.split('head').pop();
        var anchorId = "head" + head;
        goToAnchor(vol, anchorId);
        return false;
      });
    });

    function loadPageNumbers(vol, page) {
      /*var pageSel = document.getElementById("page-select");*/
      pageSel.innerHTML = '';
      volPages[vol].forEach(function (p, index) {
        pageSel.options[pageSel.options.length] = new Option(p, p);
      });
      if (page) {
        pageSel.value = page;
      }
    }

    function loadVolumeNumbers(vol) {
      /*var volSel = document.getElementById("vol-select");*/
      volSel.innerHTML = '';
      /*console.log(Object.keys(volPages));*/
      /*console.log(Object.keys(volPages).sort());*/

      Object.keys(volPages).sort().forEach(function (v, index) {
        /*console.log(v);*/
        volSel.options[volSel.options.length] = new Option(v, v);
      });
      volSel.value = vol;
    }

    async function loadVolume(vol) {
      /*Load volume json */
      var page = pageSel.value;
      $('#loading').show();
      console.log("loading volume " + vol);
      await $.getJSON(vol + ".json", function (json) {
        console.log(json)
        $('#content').empty().append(json["content"]);
        /*console.log("json loaded");*/
        window.thisVolume = vol;
        $('#loading').hide();
        $('#loading').fadeOut("slow");
        /*Load volume and page numbers in page-nav form:*/
        loadVolumeNumbers(vol);
        loadPageNumbers(vol, page);
        return true;
      });
    }


    function padWithZeros(number, width) {
      number = number + "";
      if (number.length >= width) {
        return number;
      } else {
        return new Array(width - number.length + 1).join("0") + number;
      }
    }
    document.getElementById("nav-form").addEventListener("submit", function (event) {
      event.preventDefault();
      /*console.log("Clicked Go");*/
      var vol = volSel.value;
      console.log("vol: " + vol);
      /*var targetPage = parseInt(pageSel.value, 10);
      if (page >= 1) {
        page = page-1; //page number is at bottom of page
      }
      var anchor = "v"+vol+"p"+padWithZeros(targetPage, 3);*/
      var targetPage = pageSel.value;
      var pages = volPages[vol];
      var index = pages.indexOf(targetPage);
      if (index > 0) {
        targetPage = pages[index-1];
      }

      console.log("targetPage: " + targetPage);
      var anchor = "v" + vol + "p" + targetPage;
      goToAnchor(vol, anchor);
      return false;
    });

    /*Adapt the page numbers list when the volume number changes:*/
    volSel.addEventListener("change", function (event) {
      var vol = this.value;
      var page = pageSel.value;
      loadPageNumbers(vol, page);
    });


  </script>
</body>
</html>
