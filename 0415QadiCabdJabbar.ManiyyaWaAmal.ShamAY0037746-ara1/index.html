<html dir="rtl" lang="ar">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta http-equiv="Content-Security-Policy" https:=""/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script crossorigin="anonymous" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js"></script>
<link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" rel="stylesheet"/>
<link href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Amiri&amp;display=swap" rel="stylesheet"/>
<!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css"
        integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous"> -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css" rel="stylesheet"/>
<link crossorigin="anonymous" href="../css/stylev2.css" rel="stylesheet" type="text/css"/>
<script crossorigin="anonymous" src="../js/CollapsibleLists.js" type="application/javascript"></script>
<!-- <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/alpheios-components@latest/dist/style/style-components.min.css" /> -->
<script type="text/javascript">
</script>
</head>
<body>
<div id="loading">
<img alt="Loading..." id="loading-image" src="../img/spinner1.gif"/>
</div>
<div class="page-wrapper toggled" id="wrapper">
<div id="sidebar-wrapper">
<html><body><div class="card-header title-heading">فصول الكتاب</div><ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head0">AUTO مقدمة</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head1">AUTO القاضي عبد الجبار الهمذاني</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head2">AUTO كتبه ومؤلفاته:</a>
</li>
</ul>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head3">AUTO الامام المهدى أحمد بن يحيى بن المرتضى</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head4">AUTO كتبة ومؤلفاته</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head5">AUTO فى ms004 أصول الدين:</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head6">AUTO وفى أصول الفقه:</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head7">AUTO وفى علم النحو:</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head8">AUTO وفى الفقه:</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head9">AUTO وفى الحديث:</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head10">AUTO وفى علم الطريقة:</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head11">AUTO وفى الفرائض:</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head12">AUTO وفى المنطق:</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head13">AUTO وفى التاريخ:</a>
</li>
</ul>
</li>
</ul>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head14">AUTO بيان المؤلفات المصورة على الميكروفيلم من اليمن</a>
</li>
</ul>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head15">AUTO [الجزء الأول] باب ذكر المعتزلة وطبقاتهم</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head16">AUTO [أسماء المعتزلة وبيان أسباب التسمية]</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head17">AUTO وأما أصل المجبرة، فقد بينا فيما سبق أن مذهبهم انما حدث في</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head18">AUTO [الحشوية لا سلف لهم وإنما تمسكوا بظواهر الأخبار]</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head19">AUTO مسألة إجماع المعتزلة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head20">AUTO تعيين طبقات المعتزلة</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head21">AUTO الطبقة الاولى</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head22">AUTO الطبقة الثانية</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head23">AUTO الطبقة الثالثة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head24">AUTO الطبقة الرابعة</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head25">AUTO فرع:</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head26">AUTO فرع:</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head27">AUTO فرع:</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head28">AUTO فرع:</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head29">AUTO فرع:</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head30">AUTO فرع:</a>
</li>
</ul>
</li><li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head31">AUTO [الطبقة الخامسة]</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head32">AUTO الطبقة السادسة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head33">AUTO الطبقة السابعة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head34">AUTO الطبقة الثامنة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head35">AUTO الطبقة التاسعة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head36">AUTO الطبقة العاشرة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head37">AUTO الطبقة الحادية عشرة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head38">AUTO الطبقة الثانية عشرة</a>
</li>
</ul>
</li>
</ul>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head39">AUTO [الجزء الثانى] فلسفة وفرق المعتزلة</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head40">AUTO نشأة الاعتزال وظهوره</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head41">AUTO مميزات رجال المعتزلة:</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head42">AUTO اتفاق المعتزلة:</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head43">AUTO فلسفة المعتزلة</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head44">AUTO أولا: التوحيد</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head45">AUTO 1 - نفى الصفات:</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head46">AUTO 2 - تعريف الله:</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head47">AUTO 3 - ما يترتب على التعريف السابق:</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head48">AUTO 4 - صفات الله هي مجرد اعتبارات ذهنية:</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head49">AUTO 5 - صفات الذات وصفات الأفعال:</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head50">AUTO 6 - لا تشبيه بين الله والمخلوقات:</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head51">AUTO 7 - علم الله:</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l5" href="01.html#head52">AUTO مصدر الفكرة السابقة:</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l5" href="01.html#head53">AUTO هل يجوز كون ما علم الله أنه لا يكون؟</a>
</li>
</ul>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head54">AUTO 8 - قدرة الله:</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l5" href="01.html#head55">AUTO تعريف الصلاح والأصلح</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l5" href="01.html#head56">AUTO هل يقدر الله على الظلم؟</a>
</li>
</ul>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head57">AUTO 9 - إرادة الله:</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head58">AUTO 10 - كلام الله:</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head59">AUTO اعجاز القرآن</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l5" href="01.html#head60">AUTO طريق معرفة القرآن:</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l5" href="01.html#head61">AUTO في اختصاص القرآن:</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l5" href="01.html#head62">AUTO في فصاحة الكلام والقرآن:</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l5" href="01.html#head63">AUTO في تعذر المعارضة للقرآن والرسول:</a>
</li>
</ul>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head64">AUTO رؤية الله تعالى:</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head65">AUTO 14 - برهان المعتزلة على وجود الله</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l5" href="01.html#head66">AUTO البرهان الأول بالعلة الفاعلية:</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l5" href="01.html#head67">AUTO البرهان الثاني، البرهان بالعلة الغائية:</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l6" href="01.html#head68">AUTO 1 - مرور الشيء من الوجود إلى العدم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l6" href="01.html#head69">AUTO 2 - المخلوقات</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l6" href="01.html#head70">AUTO هل الأجسام متحركة عند خلقها؟</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l6" href="01.html#head71">AUTO تعريف الحركة والسكون:</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l6" href="01.html#head72">AUTO كيف تحل الحركة في الجسم:</a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li><li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head73">AUTO اختلاف أهل الأصول:</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l4" href="01.html#head74">AUTO اجماع المعتزلة:</a>
</li>
</ul>
</li>
</ul>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head75">AUTO فرق المعتزلة</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head76">AUTO 1 - الواصلية</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head77">AUTO 2 - الهذيلية</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head78">AUTO 3 - النظامية</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head79">AUTO 4 - الخابطية والحدثية</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head80">AUTO 5 - البشرية</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head81">AUTO 6 - المعمرية</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head82">AUTO 7 - المردارية</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head83">AUTO 8 - الثمامية</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head84">AUTO 9 - الهشامية</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head85">AUTO 10 - الجاحظية</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head86">AUTO 11 - الخياطية والكعبية</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head87">AUTO 12 - الجبائية والبهشمية</a>
</li>
</ul>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head88">AUTO الفهرس</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head89">AUTO فهرس الآيات القرآنية:</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head90">AUTO فهرس الأحاديث الشريفة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head91">AUTO فهرس الشعر</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head92">AUTO فهرس الاعلام المترجم لهم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head93">AUTO الفرق المترجم لها</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l3" href="01.html#head94">AUTO فهرس المواضيع</a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</body></html></div>
<div class="book body-inner" lang="ara">
<nav class="navbar navbar-expand-lg navbar-light bg-light sticky-top border-bottom" style="direction: ltr;">
<div class="mr-auto d-flex justify-content-left">
<a class="navbar-brand ms-2" href="http://www.kitab-project.org" target="_blank">
<img class="d-inline-block align-top" src="https://cdn.jsdelivr.net/gh/sohailmerchant/kitab-cdn@main/img/kitab-logo.png" width="60px"/>
</a>
</div>
<div class="navbar-nav mx-auto btn-toolbar" style="direction: rtl;">
<div class="d-flex justify-content-center">
<form class="row" id="nav-form" style="margin-bottom: 0px;">
<span class="btn col justify-content-center">ج:</span>
<select class="col form-select pull-left" id="vol-select"></select>
<span class="btn col justify-content-center">ص:</span>
<select class="col form-select pull-left" id="page-select"></select>
<button class="btn col pull-right mx-3" id="nav-submdit-btn" style="width: 100px;" type="submit" value="Go">Go</button>
</form>
</div>
</div>
<div class="btn-toolbar navbar-nav ml-auto d-flex justify-content-right">
<div class="btn-group">
<a class="nav-link pull-right" title="Go to top">
<i class="btn bi bi-arrow-up-circle" id="back-to-top"></i>
</a>
<a class="nav-link pull-right" title="Increase fonts">
<i class="btn bi bi-fonts font-default pull-left"></i>
</a>
<a class="nav-link pull-right" title="Turn light off">
<i class="btn bi bi-lightbulb-off"></i>
</a>
<div class="nav-link pull-right dropdown">
<a aria-expanded="false" aria-haspopup="true" class="" data-bs-toggle="dropdown" id="dropdownMenuButton" role="button" title="Book Metadata">
<i class="btn bi bi-info"></i>
</a>
<div aria-labelledby="dropdownMenuButton" class="dropdown-menu">
<div class="col-12" id="metadata-content"><label>char_length: 211399</label><label>author_lat_full_name: </label><label>author_lat_shuhra: </label><label>author_from_uri: Qadi Cabd Jabbar</label><label>tags:  :: ShamAY@الفرق والردود</label><label>url: https://raw.githubusercontent.com/OpenITI/0425AH/master/data/0415QadiCabdJabbar/0415QadiCabdJabbar.ManiyyaWaAmal/0415QadiCabdJabbar.ManiyyaWaAmal.ShamAY0037746-ara1</label><label>tok_length: 49841</label><label>status: pri</label><label>id: ShamAY0037746</label><label>ed_info: الدكتور سامي النشار - الدكتور عصام الدين محمد :: دار المطبوعات الجامعية - الإسكندرية</label><label>title_lat: Maniyya Wa Amal</label><label>title_ar: المنية والأمل :: المنية والأمل ¶ المؤلف: القاضى عبد الجبار بن أحمد بن عبد الجبار الهمذاني المعتزلي (المتوفى: 415 ه) ¶ تحقيق: الدكتور سامي النشار - الدكتور عصام الدين محمد ¶ عدد الأجزاء: 1 ¶ الناشر: دار المطبوعات الجامعية - الإسكندرية ¶ تاريخ الطبع: 1972 م ¶ [ترقيم الكتاب موافق للمطبوع وهو مذيل بالحواشي] ¶ أعده للشاملة: //محمود الجيزي - عفا الله عنه// ¶ ملاحظة: [هذا الكتاب من كتب المستودع بموقع المكتبة الشاملة]</label><label>book: 0415QadiCabdJabbar.ManiyyaWaAmal</label><label>author_lat: Qadi Cabd Jabbar</label><label>author_ar: القاضى عبد الجبار بن أحمد بن عبد الجبار الهمذاني المعتزلي (المتوفى: 415 ه) :: القاضى عبد الجبار :: القاضى عبد الجبار بن أحمد بن عبد الجبار الهمذاني الأسد أبادي، أبو الحسين المعتزلي</label><label>date: 0415</label><label>versionUri: 0415QadiCabdJabbar.ManiyyaWaAmal.ShamAY0037746-ara1</label>
</div>
</div>
</div>
<a class="nav-link pull-right" href="#menu-toggle" id="menu-toggle" title="Book Chapters">
<i class="btn bi bi-list"></i></a>
</div>
</div>
</nav>
<div class="book-body fixed pt-5">
<div class="row">
<div class="col-12">
<div class="row top-heading-panel content-outer-spacing">
</div>
</div>
<div class="col-12" id="meta">
</div>
</div>
<div class="row justify-content-md-center" id="book-main">
<div class="col-lg-8 col-sm-12" id="content">
</div>
</div>
<div class="row mt-5" id="footer">
<div class="col-md-12">
            The KITAB project is based at the Institute for the Study of Muslim Civilizations (ISMC) at Aga Khan
            University, London, and has received funding from the European Research Council (ERC) under the European
            Union's
            Horizon 2020 research and innovation programme (Grant agreement No. 772989)

          </div>
<div class="col-md-12">
<img alt="Logos" height="50" id="logos" src="../img/AKU-EU-ERC-three-logos.jpg"/>
</div>
</div>
</div>
</div>
</div>
<script>

    var pageSel = document.getElementById("page-select");
    var volSel = document.getElementById("vol-select");
    var thisVolume = "01";
    var volPages = {"01": ["001", "002", "003", "004", "005", "006", "007", "008", "009", "010", "001", "002", "003", "004", "005", "006", "007", "008", "009", "010", "011", "012", "013", "014", "015", "016", "017", "018", "019", "020", "021", "022", "023", "024", "025", "026", "027", "028", "029", "030", "031", "032", "033", "034", "035", "036", "037", "038", "039", "040", "041", "042", "043", "044", "045", "046", "047", "048", "049", "050", "051", "052", "053", "054", "055", "056", "057", "058", "059", "060", "061", "062", "063", "064", "065", "066", "067", "068", "069", "070", "071", "072", "073", "074", "075", "076", "077", "078", "079", "080", "081", "082", "083", "084", "085", "086", "087", "088", "089", "090", "091", "092", "093", "094", "095", "096", "097", "098", "099", "100", "101", "103", "104", "105", "106", "109", "110", "111", "112", "113", "114", "115", "116", "117", "118", "119", "120", "121", "122", "123", "124", "125", "126", "127", "128", "129", "130", "131", "132", "133", "134", "135", "136", "137", "138", "139", "140", "141", "142", "143", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "162", "163", "164", "165", "166", "167", "168", "169", "170", "171", "172", "173", "174", "175", "176", "177", "178", "179", "180", "181", "182", "183", "184", "185", "186", "187", "188", "189", "190", "191", "192", "193", "194", "195", "196", "005", "006", "003", "004", "005", "006", "007", "008", "009", "010", "011", "012", "013", "014", "015", "016", "017", "018", "019", "020", "021", "022", "023", "024", "025", "026", "027", "028", "029", "030", "031", "032", "033", "034", "035", "036", "037", "038", "039", "040", "041", "042", "043", "044", "045", "047", "048", "050", "052", "053", "054", "055", "056", "057", "058", "059", "060", "061", "062", "064", "065", "066", "067", "068", "069", "070", "072", "073", "074", "075", "076", "077", "078", "079", "080", "083", "088", "090", "093", "094", "095", "096", "099", "100", "103", "104", "105", "109", "110", "111", "112", "113", "116", "117", "118", "119", "120", "121", "122", "123", "124", "126", "127", "128", "129", "130", "131", "132", "133", "134", "136", "141", "143", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "159", "163", "164", "165", "166", "172", "176"]}; /*loaded by html_builder*/

    function goToAnchor(vol, anchorId) {
      if (vol != window.thisVolume) {
        loadVolume(vol, false).then(res => {
          console.log("Volume loaded");
          console.log("Go to anchor " + anchorId);
          /*move the volume page to the element with id=anchorId*/
          /*var targetAnchor = document.getElementById(anchorId);
          targetAnchor.scrollIntoView({block: 'nearest'});  // this does not always work...
          console.log(targetAnchor);*/
          /*window.location.hash = "";
          window.location.hash = anchorId;
          window.location.hash = anchorId;
          console.log("#"+anchorId);*/
          /*//This approach does not work at all: scrolls only main window.
          var targetAnchor = $("#"+anchorId);
          //$("#content").animate(
          $("html, body").animate(
            {scrollTop: targetAnchor.offset().top},
            1000
          );*/
          /*//This approach does not work at all: scrolls only main window.
          var targetAnchor = document.getElementById(anchorId);
          var rect = targetAnchor.getBoundingClientRect();
          console.log(targetAnchor);
          console.log(rect);
          var viewHeight=Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
          window.scroll({
            top: rect.top + rect.height / 2 - viewHeight /2,
            behavior: 'smooth'
          });*/
          /*var targetAnchor = document.getElementById(anchorId);
          var contentDiv = document.getElementsByClassName("book-body")[0];
          var topPos = contentDiv.offsetTop;
          var windowSize = $(window).height();
          console.log("topPos: " + topPos);
          console.log("targetPos: " + targetAnchor.offsetTop);
          console.log("windowSize:" + windowSize)
          console.log("targetAnchor.offsetTop-windowSize/3 = " + (targetAnchor.offsetTop - topPos - windowSize / 2));
          contentDiv.scrollTop = targetAnchor.offsetTop - topPos - windowSize / 2;*/
          var targetAnchor = document.getElementById(anchorId);
          targetAnchor.scrollIntoView({"block": "start"});
        });
      } else {
        /*move the volume page to the element with id=anchorId*/
        /*var targetAnchor = document.getElementById(anchorId);
        targetAnchor.scrollIntoView({block: 'nearest'});  // this does not always work...
        console.log(targetAnchor);*/
        /*window.location.hash = "";
        window.location.hash = anchorId;
        window.location.hash = anchorId;
        console.log("#"+anchorId);*/
        /*//This approach does not work at all: scrolls only main window.
        var targetAnchor = $("#"+anchorId);
        //$("#content").animate(
        $("html, body").animate(
          {scrollTop: targetAnchor.offset().top},
          1000
        );*/
        /*//This approach does not work at all: scrolls only main window.
        var targetAnchor = document.getElementById(anchorId);
        var rect = targetAnchor.getBoundingClientRect();
        console.log(targetAnchor);
        console.log(rect);
        var viewHeight=Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
        window.scroll({
          top: rect.top + rect.height / 2 - viewHeight /2,
          behavior: 'smooth'
        });*/
        /*var targetAnchor = document.getElementById(anchorId);
        var contentDiv = document.getElementsByClassName("book-body")[0];
        var topPos = contentDiv.offsetTop;
        var windowSize = $(window).height();
        console.log("topPos: " + topPos);
        console.log("targetPos: " + targetAnchor.offsetTop);
        console.log("windowSize:" + windowSize)
        console.log("targetAnchor.offsetTop-windowSize/3 = " + (targetAnchor.offsetTop - topPos - windowSize / 2));
        contentDiv.scrollTop = targetAnchor.offsetTop - topPos - windowSize / 2;*/
        var targetAnchor = document.getElementById(anchorId);
        targetAnchor.scrollIntoView({"block": "start"});
      }
    }

    CollapsibleLists.apply();
    console.log("Applied CollapsibleLists");

    $(document).ready(function () {
      console.log("Load initial volume " + thisVolume);
      loadVolume(thisVolume).then(res => {
        console.log("Initial volume loaded");
        $('#loading').hide();
        $('#loading').fadeOut("slow");
      });
      $(window).scroll(function () {
        if ($(this).scrollTop() > 50) {
          $('#back-to-top').fadeIn();
        } else {
          $('#back-to-top').fadeOut();
        }
      });
      // scroll body to 0px on click
      $('#back-to-top').click(function () {
        $('body,html').animate({
          scrollTop: 0
        }, 400);
        return false;
      });
      $("#menu-toggle").click(function (e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled");
      });

      $(".font-default").click(function () {

        $('#wrapper').toggleClass("font-increase", "font-default");
      });

      $(".bi-lightbulb-off").click(function () {
        $('.bi-lightbulb-off').toggleClass("bi-lightbulb", "bi-lightbulb-off");
        $('.page-wrapper').toggleClass("night-mode", "");
        $('.navbar-light').toggleClass("night-mode", "");
        console.log(this);

      });
      $('.toc-item').click(function (event) {
        /*console.log('toc item clicked');*/
        event.preventDefault();
        var clickedElement = event.target;
        /*console.log(clickedElement);*/
        var href = clickedElement.getAttribute("href");
        /*console.log('href: '+href);*/
        var vol = href.substring(0, 2);
        var head = href.split('head').pop();
        var anchorId = "head" + head;
        goToAnchor(vol, anchorId);
        return false;
      });
    });

    function loadPageNumbers(vol, page) {
      /*var pageSel = document.getElementById("page-select");*/
      pageSel.innerHTML = '';
      volPages[vol].forEach(function (p, index) {
        pageSel.options[pageSel.options.length] = new Option(p, p);
      });
      if (page) {
        pageSel.value = page;
      }
    }

    function loadVolumeNumbers(vol) {
      /*var volSel = document.getElementById("vol-select");*/
      volSel.innerHTML = '';
      /*console.log(Object.keys(volPages));*/
      /*console.log(Object.keys(volPages).sort());*/

      Object.keys(volPages).sort().forEach(function (v, index) {
        /*console.log(v);*/
        volSel.options[volSel.options.length] = new Option(v, v);
      });
      volSel.value = vol;
    }

    async function loadVolume(vol) {
      /*Load volume json */
      var page = pageSel.value;
      $('#loading').show();
      console.log("loading volume " + vol);
      await $.getJSON(vol + ".json", function (json) {
        console.log(json)
        $('#content').empty().append(json["content"]);
        /*console.log("json loaded");*/
        window.thisVolume = vol;
        $('#loading').hide();
        $('#loading').fadeOut("slow");
        /*Load volume and page numbers in page-nav form:*/
        loadVolumeNumbers(vol);
        loadPageNumbers(vol, page);
        return true;
      });
    }


    function padWithZeros(number, width) {
      number = number + "";
      if (number.length >= width) {
        return number;
      } else {
        return new Array(width - number.length + 1).join("0") + number;
      }
    }
    document.getElementById("nav-form").addEventListener("submit", function (event) {
      event.preventDefault();
      /*console.log("Clicked Go");*/
      var vol = volSel.value;
      console.log("vol: " + vol);
      /*var targetPage = parseInt(pageSel.value, 10);
      if (page >= 1) {
        page = page-1; //page number is at bottom of page
      }
      var anchor = "v"+vol+"p"+padWithZeros(targetPage, 3);*/
      var targetPage = pageSel.value;
      var pages = volPages[vol];
      var index = pages.indexOf(targetPage);
      if (index > 0) {
        targetPage = pages[index-1];
      }

      console.log("targetPage: " + targetPage);
      var anchor = "v" + vol + "p" + targetPage;
      goToAnchor(vol, anchor);
      return false;
    });

    /*Adapt the page numbers list when the volume number changes:*/
    volSel.addEventListener("change", function (event) {
      var vol = this.value;
      var page = pageSel.value;
      loadPageNumbers(vol, page);
    });


  </script>
</body>
</html>
