<html dir="rtl" lang="ar">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta http-equiv="Content-Security-Policy" https:=""/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script crossorigin="anonymous" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js"></script>
<link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" rel="stylesheet"/>
<link href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Amiri&amp;display=swap" rel="stylesheet"/>
<!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css"
        integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous"> -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css" rel="stylesheet"/>
<link crossorigin="anonymous" href="../css/stylev2.css" rel="stylesheet" type="text/css"/>
<script crossorigin="anonymous" src="../js/CollapsibleLists.js" type="application/javascript"></script>
<!-- <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/alpheios-components@latest/dist/style/style-components.min.css" /> -->
<script type="text/javascript">
</script>
</head>
<body>
<div id="loading">
<img alt="Loading..." id="loading-image" src="../img/spinner1.gif"/>
</div>
<div class="page-wrapper toggled" id="wrapper">
<div id="sidebar-wrapper">
<html><body><div class="card-header title-heading">فصول الكتاب</div><ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head0">خطبة الكتاب</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head1">الباب الأول: الأمر بلزوم السنة والجماعة.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head2">الباب الثاني: في ذم البدع والمبتدعين.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head3">الباب الثالث: في التحذير من فتن إبليس ومكايده.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head4">الباب الرابع: في معنى التلبيس والغرور.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head5">الباب الخامس: في ذكر تلبيسه في العقائد والديانات.</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head6">ذكر تلبيسه على السوفسطائية.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head7">ذكر تلبيسه على الدهرية</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head8">ذكر تلبيسه على الطبائعيين</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head9">ذكر تلبيسه على الثنوية</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head10">ذكر تلبيسه على الفلاسفة وتابعيهم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head11">ذكر تلبيسه على أصحاب الهياكل"</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head12">ذكر تلبيسه على عباد الأصنام</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head13">ذكر بداية تلبيسه على عباد الأصنام</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head14">ذكر تلبيسه على ms057 عابدي النار والشمس والقمر</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head15">ذكر تلبيسه على الجاهلية</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head16">ذكر تلبيس إبليس على جاحدي النبوات</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head17">ذكر تلبيسه على اليهود</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head18">ذكر تلبيسه على النصارى</a>
</li>
</ul>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head19">ومن تلبيس إبليس على اليهود والنصارى.</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head20">ذكر تلبيسه على الصابئين</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head21">ذكر تلبيس إبليس على المجوس</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head22">ذكر تلبيس إبليس على المنجمين وأصحاب الفلك</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head23">ذكر تلبيس إبليس على جاحدي البعث</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head24">ذكر تلبيسه على القائلين بالتناسخ</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head25">ذكر تلبيس إبليس على أمتنا في العقائد والديانات</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head26">ذكر تلبيس إبليس على الخوارج</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head27">ذكر تلبيسه على الرافضة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head28">ذكر تلبيس إبليس على الباطنية</a>
</li>
</ul>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head29">الباب السادس: في ذكر تلبيس إبليس على العلماء في فنون العلم</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head30">ذكر تلبيسه على القراء</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head31">ذكر تلبيس إبليس على أصحاب الحديث</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head32">ذكر تلبيس إبليس على الفقهاء</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head33">ذكر تلبيسه عليهم بإدخالهم في الجدل كلام الفلاسفة واعتمادهم على تلك الأوضاع.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head34">ذكر تلبيسه على الوعاظ والقصاص</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head35">ذكر تلبيسه على أهل اللغة والأدب</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head36">ذكر تلبيس إبليس على الشعراء</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head37">ذكر تلبيس إبليس على الكاملين من العلماء</a>
</li>
</ul>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head38">الباب السابع: في تلبيس إبليس على الولاة والسلاطين</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head39">الباب الثامن: ذكر تلبيس إبليس على العباد في العبادات</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head40">ذكر تلبيسه عليهم في الاستباطة والحدث</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head41">ذكر تلبيسه عليهم في الوضوء</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head42">ذكر تلبيسه عليهم في الأذان</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head43">ذكر تلبيسه عليهم في الصلاة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head44">ذكر تلبيسه عليهم في قراءة القرآن</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head45">ذكر تلبيسه عليهم في الصوم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head46">ذكر تلبيسه عليهم في الحج</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head47">ذكر تلبيس إبليس على الغزاة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head48">ذكر تلبيسه على الآمرين بالمعروف والناهين عن المنكر</a>
</li>
</ul>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head49">الباب التاسع: في ذكر تلبيس إبليس على الزهاد والعباد</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head50">الباب العاشر: في ذكر تلبيسه على الصوفية من جملة الزهاد</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head51">ذكر تلبيس إبليس في السماع وغيره</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head52">ذكر تلبيس إبليس على الصوفية في الطهارة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head53">ذكر تلبيس إبليس عليهم في الصلاة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head54">ذكر تلبيس إبليس على الصوفية في المساكن</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head55">ذكر تلبيس إبليس على الصوفية في الخروج عن الأموال والتجرد عنها</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head56">ذكر تلبيس إبليس على الصوفية في لباسهم.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head57">ذكر تلبيس إبليس على الصوفية في مطاعمهم ومشاربهم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head58">فصل في ذكر أحاديث تبين خطأهم في أفعالهم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head59">ذكر تلبيس إبليس على الصوفية في السماع والرقص والوجد</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head60">فصل في ذكر الأدلة على كراهية الغناء والنوح والمنع منهما.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head61">فصل في ذكر الشبه التي تعلق بها من أجاز سماع الغناء.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head62">ذكر تلبيس إبليس على الصوفية في الوجد.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head63">ذكر تلبيس إبليس على كثير من الصوفية في صحبة الأحداث.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head64">ذكر تلبيس إبليس على الصوفية في ادعاء التوكل وقطع الأسباب وترك الاحتراز في الأموال.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head65">ذكر تلبيس إبليس على الصوفية في ترك التداوي.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head66">ذكر تلبيس إبليس على الصوفية في ترك الجمعة والجماعة بالوحدة والعزلة.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head67">ذكر تلبيس إبليس على الصوفية في التخشع ومطأطأة الرأس وإقامة الناموس.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head68">ذكر تلبيس إبليس على الصوفية في ترك النكاح.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head69">ذكر تلبيس إبليس على الصوفية في ترك طلب الأولاد.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head70">ذكر تلبيس إبليس على الصوفية في الأسفار والسياحة.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head71">ذكر تلبيسه عليهم في دخول الفلاة بغير زاد.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head72">سياق ما جرى للصوفية في أسفارهم وسياحاتهم من الأفعال المخالفة للشرع.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head73">ذكر تلبيس إبليس على الصوفية إذا اقدموا من السفر.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head74">ذكر تلبيس إبليس على الصوفية إذا مات لهم ميت.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head75">ذكر تلبيس إبليس على الصوفية في ترك التشاغل بالعلم.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head76">ذكر تلبيس إبليس على جماعة من القوم في دفنهم كتب العلم وإلقائها في الماء.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head77">ذكر تلبيس إبليس على الصوفية في إنكارهم من تشاغل بالعلم.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head78">ذكر تلبيس إبليس على الصوفية في كلامهم في العلم ms351.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head79">ذكر نبذة من كلامهم في القرآن.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head80">ذكر تلبيس إبليس في الشطح والدعاوى.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head81">بيان جملة مروية على الصوفية من الأفعال المنكرة.</a>
</li>
</ul>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head82">الباب الحادي عشر: في ذكر تلبيس إبليس على المتدينين بما يشبه الكرامات.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head83">الباب الثاني عشر: في ذكر تلبيس إبليس على العوام.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head84">الباب الثالث عشر: في ذكر إبليس على الناس بطول الأمل</a>
</li>
</ul>
</body></html></div>
<div class="book body-inner" lang="ara">
<nav class="navbar navbar-expand-lg navbar-light bg-light sticky-top border-bottom" style="direction: ltr;">
<div class="mr-auto d-flex justify-content-left">
<a class="navbar-brand ms-2" href="http://www.kitab-project.org" target="_blank">
<img class="d-inline-block align-top" src="https://cdn.jsdelivr.net/gh/sohailmerchant/kitab-cdn@main/img/kitab-logo.png" width="60px"/>
</a>
</div>
<div class="navbar-nav mx-auto btn-toolbar" style="direction: rtl;">
<div class="d-flex justify-content-center">
<form class="row" id="nav-form" style="margin-bottom: 0px;">
<span class="btn col justify-content-center">ج:</span>
<select class="col form-select pull-left" id="vol-select"></select>
<span class="btn col justify-content-center">ص:</span>
<select class="col form-select pull-left" id="page-select"></select>
<button class="btn col pull-right mx-3" id="nav-submdit-btn" style="width: 100px;" type="submit" value="Go">Go</button>
</form>
</div>
</div>
<div class="btn-toolbar navbar-nav ml-auto d-flex justify-content-right">
<div class="btn-group">
<a class="nav-link pull-right" title="Go to top">
<i class="btn bi bi-arrow-up-circle" id="back-to-top"></i>
</a>
<a class="nav-link pull-right" title="Increase fonts">
<i class="btn bi bi-fonts font-default pull-left"></i>
</a>
<a class="nav-link pull-right" title="Turn light off">
<i class="btn bi bi-lightbulb-off"></i>
</a>
<div class="nav-link pull-right dropdown">
<a aria-expanded="false" aria-haspopup="true" class="" data-bs-toggle="dropdown" id="dropdownMenuButton" role="button" title="Book Metadata">
<i class="btn bi bi-info"></i>
</a>
<div aria-labelledby="dropdownMenuButton" class="dropdown-menu">
<div class="col-12" id="metadata-content"><label>char_length: 526520</label><label>author_lat_full_name: </label><label>author_lat_shuhra: </label><label>author_from_uri: Ibn Jawzi</label><label>tags: MARKDOWN :: CENT0600 :: _ADAB :: _ADHKAR :: _AKHLAQ :: _CAQAID :: _MISC :: _RAQAIQ :: _SULUK :: GAL@literature-islamic :: GAL@1000-1258CE :: GAL@polyhistors :: GAL@homiletics :: GAL@literature-arabic :: GAL@paraenetics :: GAL@period-postclassical :: GAL@encyclopaedias :: Shamela@الرقاق والآداب والأذكار</label><label>url: https://raw.githubusercontent.com/OpenITI/0600AH/master/data/0597IbnJawzi/0597IbnJawzi.TalbisIblis/0597IbnJawzi.TalbisIblis.Shamela0011438-ara1.mARkdown</label><label>tok_length: 129356</label><label>status: pri</label><label>id: Shamela0011438</label><label>ed_info: دار الفكر للطباعة والنشر، بيرزت، لبنان</label><label>title_lat: Talbis Iblis</label><label>title_ar: تلبيس إبليس</label><label>book: 0597IbnJawzi.TalbisIblis</label><label>author_lat: Ibn Jawzi</label><label>author_ar: جمال الدين أبو الفرج عبد الرحمن بن علي بن محمد الجوزي (المتوفى: 597هـ)</label><label>date: 0597</label><label>versionUri: 0597IbnJawzi.TalbisIblis.Shamela0011438-ara1</label>
</div>
</div>
</div>
<a class="nav-link pull-right" href="#menu-toggle" id="menu-toggle" title="Book Chapters">
<i class="btn bi bi-list"></i></a>
</div>
</div>
</nav>
<div class="book-body fixed pt-5">
<div class="row">
<div class="col-12">
<div class="row top-heading-panel content-outer-spacing">
</div>
</div>
<div class="col-12" id="meta">
</div>
</div>
<div class="row justify-content-md-center" id="book-main">
<div class="col-lg-8 col-sm-12" id="content">
</div>
</div>
<div class="row mt-5" id="footer">
<div class="col-md-12">
            The KITAB project is based at the Institute for the Study of Muslim Civilizations (ISMC) at Aga Khan
            University, London, and has received funding from the European Research Council (ERC) under the European
            Union's
            Horizon 2020 research and innovation programme (Grant agreement No. 772989)

          </div>
<div class="col-md-12">
<img alt="Logos" height="50" id="logos" src="../img/AKU-EU-ERC-three-logos.jpg"/>
</div>
</div>
</div>
</div>
</div>
<script>

    var pageSel = document.getElementById("page-select");
    var volSel = document.getElementById("vol-select");
    var thisVolume = "01";
    var volPages = {"01": ["003", "004", "005", "007", "008", "009", "010", "011", "012", "013", "014", "015", "016", "017", "018", "019", "020", "021", "022", "023", "024", "025", "026", "027", "028", "029", "030", "031", "032", "033", "034", "035", "036", "037", "038", "039", "040", "040", "041", "041", "042", "042", "043", "043", "044", "045", "046", "047", "047", "048", "049", "049", "049", "050", "051", "052", "053", "054", "055", "056", "057", "057", "058", "058", "059", "060", "060", "061", "062", "063", "064", "065", "065", "066", "067", "067", "067", "068", "068", "069", "069", "070", "071", "071", "072", "073", "073", "074", "074", "075", "076", "077", "078", "079", "080", "081", "081", "082", "083", "084", "085", "086", "087", "087", "088", "089", "090", "091", "091", "092", "093", "094", "095", "096", "097", "098", "099", "100", "101", "102", "103", "103", "104", "105", "106", "103", "107", "108", "109", "110", "111", "111", "112", "113", "113", "114", "115", "115", "115", "116", "117", "118", "119", "120", "121", "122", "122", "123", "123", "123", "124", "125", "126", "127", "128", "128", "129", "129", "130", "130", "131", "131", "132", "132", "133", "134", "135", "136", "137", "138", "139", "140", "141", "142", "143", "144", "145", "146", "147", "148", "149", "150", "151", "152", "152", "153", "154", "155", "156", "156", "157", "157", "158", "158", "159", "160", "161", "162", "163", "164", "165", "166", "167", "167", "168", "169", "170", "171", "172", "173", "174", "175", "176", "177", "178", "179", "180", "181", "182", "183", "184", "184", "185", "186", "187", "188", "189", "190", "191", "192", "194", "195", "196", "195", "196", "197", "198", "198", "199", "200", "201", "202", "203", "204", "205", "206", "206", "207", "208", "209", "210", "211", "211", "212", "213", "214", "215", "216", "217", "218", "219", "220", "221", "222", "223", "223", "224", "225", "226", "227", "228", "229", "230", "231", "232", "233", "234", "235", "236", "236", "237", "238", "239", "240", "241", "242", "243", "244", "245", "246", "247", "247", "248", "249", "250", "251", "252", "253", "254", "255", "255", "256", "256", "257", "257", "258", "259", "260", "260", "261", "262", "263", "263", "264", "264", "265", "265", "266", "267", "269", "269", "269", "270", "271", "272", "273", "274", "275", "276", "277", "278", "279", "280", "281", "281", "282", "282", "283", "283", "284", "285", "286", "287", "288", "288", "289", "290", "290", "291", "292", "292", "293", "293", "294", "295", "296", "297", "298", "299", "300", "301", "301", "302", "303", "304", "305", "306", "307", "308", "309", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321", "322", "323", "324", "325", "326", "327", "328", "329", "330", "331", "332", "333", "334", "335", "336", "337", "338", "339", "340", "341", "342", "343", "344", "345", "346", "347", "348", "349", "350", "351", "352", "353", "354", "355", "356"]}; /*loaded by html_builder*/

    function goToAnchor(vol, anchorId) {
      if (vol != window.thisVolume) {
        loadVolume(vol, false).then(res => {
          console.log("Volume loaded");
          console.log("Go to anchor " + anchorId);
          /*move the volume page to the element with id=anchorId*/
          /*var targetAnchor = document.getElementById(anchorId);
          targetAnchor.scrollIntoView({block: 'nearest'});  // this does not always work...
          console.log(targetAnchor);*/
          /*window.location.hash = "";
          window.location.hash = anchorId;
          window.location.hash = anchorId;
          console.log("#"+anchorId);*/
          /*//This approach does not work at all: scrolls only main window.
          var targetAnchor = $("#"+anchorId);
          //$("#content").animate(
          $("html, body").animate(
            {scrollTop: targetAnchor.offset().top},
            1000
          );*/
          /*//This approach does not work at all: scrolls only main window.
          var targetAnchor = document.getElementById(anchorId);
          var rect = targetAnchor.getBoundingClientRect();
          console.log(targetAnchor);
          console.log(rect);
          var viewHeight=Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
          window.scroll({
            top: rect.top + rect.height / 2 - viewHeight /2,
            behavior: 'smooth'
          });*/
          /*var targetAnchor = document.getElementById(anchorId);
          var contentDiv = document.getElementsByClassName("book-body")[0];
          var topPos = contentDiv.offsetTop;
          var windowSize = $(window).height();
          console.log("topPos: " + topPos);
          console.log("targetPos: " + targetAnchor.offsetTop);
          console.log("windowSize:" + windowSize)
          console.log("targetAnchor.offsetTop-windowSize/3 = " + (targetAnchor.offsetTop - topPos - windowSize / 2));
          contentDiv.scrollTop = targetAnchor.offsetTop - topPos - windowSize / 2;*/
          var targetAnchor = document.getElementById(anchorId);
          targetAnchor.scrollIntoView({"block": "start"});
        });
      } else {
        /*move the volume page to the element with id=anchorId*/
        /*var targetAnchor = document.getElementById(anchorId);
        targetAnchor.scrollIntoView({block: 'nearest'});  // this does not always work...
        console.log(targetAnchor);*/
        /*window.location.hash = "";
        window.location.hash = anchorId;
        window.location.hash = anchorId;
        console.log("#"+anchorId);*/
        /*//This approach does not work at all: scrolls only main window.
        var targetAnchor = $("#"+anchorId);
        //$("#content").animate(
        $("html, body").animate(
          {scrollTop: targetAnchor.offset().top},
          1000
        );*/
        /*//This approach does not work at all: scrolls only main window.
        var targetAnchor = document.getElementById(anchorId);
        var rect = targetAnchor.getBoundingClientRect();
        console.log(targetAnchor);
        console.log(rect);
        var viewHeight=Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
        window.scroll({
          top: rect.top + rect.height / 2 - viewHeight /2,
          behavior: 'smooth'
        });*/
        /*var targetAnchor = document.getElementById(anchorId);
        var contentDiv = document.getElementsByClassName("book-body")[0];
        var topPos = contentDiv.offsetTop;
        var windowSize = $(window).height();
        console.log("topPos: " + topPos);
        console.log("targetPos: " + targetAnchor.offsetTop);
        console.log("windowSize:" + windowSize)
        console.log("targetAnchor.offsetTop-windowSize/3 = " + (targetAnchor.offsetTop - topPos - windowSize / 2));
        contentDiv.scrollTop = targetAnchor.offsetTop - topPos - windowSize / 2;*/
        var targetAnchor = document.getElementById(anchorId);
        targetAnchor.scrollIntoView({"block": "start"});
      }
    }

    CollapsibleLists.apply();
    console.log("Applied CollapsibleLists");

    $(document).ready(function () {
      console.log("Load initial volume " + thisVolume);
      loadVolume(thisVolume).then(res => {
        console.log("Initial volume loaded");
        $('#loading').hide();
        $('#loading').fadeOut("slow");
      });
      $(window).scroll(function () {
        if ($(this).scrollTop() > 50) {
          $('#back-to-top').fadeIn();
        } else {
          $('#back-to-top').fadeOut();
        }
      });
      // scroll body to 0px on click
      $('#back-to-top').click(function () {
        $('body,html').animate({
          scrollTop: 0
        }, 400);
        return false;
      });
      $("#menu-toggle").click(function (e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled");
      });

      $(".font-default").click(function () {

        $('#wrapper').toggleClass("font-increase", "font-default");
      });

      $(".bi-lightbulb-off").click(function () {
        $('.bi-lightbulb-off').toggleClass("bi-lightbulb", "bi-lightbulb-off");
        $('.page-wrapper').toggleClass("night-mode", "");
        $('.navbar-light').toggleClass("night-mode", "");
        console.log(this);

      });
      $('.toc-item').click(function (event) {
        /*console.log('toc item clicked');*/
        event.preventDefault();
        var clickedElement = event.target;
        /*console.log(clickedElement);*/
        var href = clickedElement.getAttribute("href");
        /*console.log('href: '+href);*/
        var vol = href.substring(0, 2);
        var head = href.split('head').pop();
        var anchorId = "head" + head;
        goToAnchor(vol, anchorId);
        return false;
      });
    });

    function loadPageNumbers(vol, page) {
      /*var pageSel = document.getElementById("page-select");*/
      pageSel.innerHTML = '';
      volPages[vol].forEach(function (p, index) {
        pageSel.options[pageSel.options.length] = new Option(p, p);
      });
      if (page) {
        pageSel.value = page;
      }
    }

    function loadVolumeNumbers(vol) {
      /*var volSel = document.getElementById("vol-select");*/
      volSel.innerHTML = '';
      /*console.log(Object.keys(volPages));*/
      /*console.log(Object.keys(volPages).sort());*/

      Object.keys(volPages).sort().forEach(function (v, index) {
        /*console.log(v);*/
        volSel.options[volSel.options.length] = new Option(v, v);
      });
      volSel.value = vol;
    }

    async function loadVolume(vol) {
      /*Load volume json */
      var page = pageSel.value;
      $('#loading').show();
      console.log("loading volume " + vol);
      await $.getJSON(vol + ".json", function (json) {
        console.log(json)
        $('#content').empty().append(json["content"]);
        /*console.log("json loaded");*/
        window.thisVolume = vol;
        $('#loading').hide();
        $('#loading').fadeOut("slow");
        /*Load volume and page numbers in page-nav form:*/
        loadVolumeNumbers(vol);
        loadPageNumbers(vol, page);
        return true;
      });
    }


    function padWithZeros(number, width) {
      number = number + "";
      if (number.length >= width) {
        return number;
      } else {
        return new Array(width - number.length + 1).join("0") + number;
      }
    }
    document.getElementById("nav-form").addEventListener("submit", function (event) {
      event.preventDefault();
      /*console.log("Clicked Go");*/
      var vol = volSel.value;
      console.log("vol: " + vol);
      /*var targetPage = parseInt(pageSel.value, 10);
      if (page >= 1) {
        page = page-1; //page number is at bottom of page
      }
      var anchor = "v"+vol+"p"+padWithZeros(targetPage, 3);*/
      var targetPage = pageSel.value;
      var pages = volPages[vol];
      var index = pages.indexOf(targetPage);
      if (index > 0) {
        targetPage = pages[index-1];
      }

      console.log("targetPage: " + targetPage);
      var anchor = "v" + vol + "p" + targetPage;
      goToAnchor(vol, anchor);
      return false;
    });

    /*Adapt the page numbers list when the volume number changes:*/
    volSel.addEventListener("change", function (event) {
      var vol = this.value;
      var page = pageSel.value;
      loadPageNumbers(vol, page);
    });


  </script>
</body>
</html>
