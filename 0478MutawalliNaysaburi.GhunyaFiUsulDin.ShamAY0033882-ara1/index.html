<html dir="rtl" lang="ar">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta http-equiv="Content-Security-Policy" https:=""/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script crossorigin="anonymous" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js"></script>
<link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" rel="stylesheet"/>
<link href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Amiri&amp;display=swap" rel="stylesheet"/>
<!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css"
        integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous"> -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css" rel="stylesheet"/>
<link crossorigin="anonymous" href="../css/stylev2.css" rel="stylesheet" type="text/css"/>
<script crossorigin="anonymous" src="../js/CollapsibleLists.js" type="application/javascript"></script>
<!-- <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/alpheios-components@latest/dist/style/style-components.min.css" /> -->
<script type="text/javascript">
</script>
</head>
<body>
<div id="loading">
<img alt="Loading..." id="loading-image" src="../img/spinner1.gif"/>
</div>
<div class="page-wrapper toggled" id="wrapper">
<div id="sidebar-wrapper">
<html><body><div class="card-header title-heading">فصول الكتاب</div><ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head0">AUTO مقدمة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head1">AUTO فصل في بيان العبارات المصطلح عليها بين أهل الأصول</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head2">AUTO فصل في حد العلم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head3">AUTO فصل النظر ينقسم إلى صحيح وفاسد</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head4">AUTO فصل لا واجب عند أهل الحق إلا من جهة الشرع والسمع ، ولولا ورود</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head5">AUTO فصل أول ما يجب على العاقل المكلف القصد إلى النظر الصحيح</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head6">AUTO مسألة : العالم محدث مخلوق ، حدث بعد أن لم يكن.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head7">AUTO مسألة : إذا ثبت حدوث العالم يترتب عليه ثبوت الصانع.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head8">AUTO مسألة : إذا ثبت للعالم صانعا فالصانع واحد</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head9">AUTO مسألة : صانع العالم موجود حقيقة.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head10">AUTO مسألة : البارئ تعالى قديم.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head11">AUTO مسألة : البارئ تعالى قائم بنفسه.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head12">AUTO مسألة : البارئ تعالى لا يشبه شيئا ولا يشبهه شيء.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head13">AUTO مسألة : البارئ تعالى ليس بجسم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head14">AUTO مسألة : لا يجوز قيام حادث بذات البارئ تعالى.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head15">AUTO مسألة : البارئ تعالى ليس بجوهر.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head16">AUTO مسألة البارئ تعالى ليس بعرض.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head17">AUTO مسألة : البارئ سبحانه وتعالى قادر.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head18">AUTO مسألة : صانع العالم عالم.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head19">AUTO مسألة : الحق سبحانه وتعالى حي.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head20">AUTO مسألة : البارئ سبحانه وتعالى مريد لأفعاله على الحقيقة.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head21">AUTO مسألة : البارئ تعالى سميع بصير.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head22">AUTO مسألة : البارئ تعالى متكلم.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head23">AUTO مسألة : البارئ تعالى باق.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head24">AUTO مسألة : إذا ثبت أن البارئ قادر ، عالم ، حي ، وعندنا البارئ</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head25">AUTO مسألة : لله تعالى صفة هي الإرادة تتعلق بالمرادات كلها.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head26">AUTO مسألة : ذكرنا أن لله تعالى علما يتعلق بالمعلومات وعلمه صفة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head27">AUTO مسألة : عند أهل الحق البارئ تعالى متكلم بكلام قديم أزلي غير</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head28">AUTO مسألة : كلام ms31 الله تعالى منزل على الحقيقة.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head29">AUTO مسألة : كلام الله تعالى مسموع على الحقيقة.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head30">AUTO مسألة : كلام الله تعالى في المصاحف على الحقيقة ومحفوظ في</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head31">AUTO مسألة : القراءة عندنا أصوات القراء ونغماتهم وهي اكتسابهم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head32">AUTO مسألة : كلام الله تعالى واحد وهو أمر بجميع المأمورات وخبر عن</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head33">AUTO مسألة : صفات البارئ لا توصف بأنها متغايرة وكذلك الذات مع</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head34">AUTO مسألة : ذهب القدماء من أئمتنا إلى أن البقاء للباقي زائدة على</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head35">AUTO مسألة : للبارئ سبحانه وتعالى في الأزل اسم وصفة.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head36">AUTO مسألة : ما ورد السمع بإثبات صفات الله تعالى لا يدل عليها مثل</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head37">AUTO مسألة : مذهب أهل الحق أن لا خالق إلا الله فما يحدث في العالم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head38">AUTO مسألة : مذهب أهل الحق أن العبد قادر على كسبه وله فعل.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head39">AUTO مسألة : مذهب أهل الحق أن الحوادث كلها بقضاء الله وقدره</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head40">AUTO مسألة : التوفيق خلق قدرة الطاعة والخذلان خلق قدرة المعصية ،</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head41">AUTO مسألة : الحسن عند أهل الحق ما ورد الشرع بالثناء على فاعله</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head42">AUTO مسألة : لا واجب على العبد عقلا وإنما طريق الإيجاب الشرع وقبل</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head43">AUTO مسألة : مذهب أهل الحق أن لا واجب على الله تعالى أصلا بل هو</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head44">AUTO مسألة : مذهب أحد الحق : أن البارئ تعالى يصح أن يرى بالإبصار</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head45">AUTO مسألة : مذهب أهل الحق جواز بعث الرسول - صلى الله عليه وسلم -</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head46">AUTO مسألة : المعجزة دالة على صدق الأنبياء.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head47">AUTO مسألة : مذهب أهل الحق جواز ظهور ما يخرق العادة على أيدي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head48">AUTO مسألة : محمد رسول الله - صلى الله عليه وسلم - نبي حق وهو أفضل</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head49">AUTO مسألة : الأنبياء معصومون عما يناقض مدلول المعجزة وهو صدقهم.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head50">AUTO مسألة : حشر الخلائق ونشرهم بعد إقنائهم حق.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head51">AUTO مسألة : عذاب القبر ومسائلة منكر ونكير حق ثابت.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head52">AUTO مسألة : الروح أجسام لطيفة مجتمعة مع الأجسام المحسوسة والله</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head53">AUTO مسألة : الكتب التي تحاسب عليها العباد حق.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head54">AUTO مسألة : الجنة والنار مخلوقتان مدة حياة الدنيا وموجودتان على</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head55">AUTO مسألة : ثواب المطيعين وعقاب العصاة ليس بحتم على الله تعالى أن</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head56">AUTO مسألة : من ارتكب كبيرة ولم يوفق للتوبة لم يستحق اسم الكفر ولا</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head57">AUTO مسألة : شفاعة المصطفى ، عليه السلام ، حق في حق العصاة من أمته.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head58">AUTO مسألة : التوبة في اللغة هي الرجوع.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head59">AUTO مسألة : التوبة واجبة على من عصى الله وخالف أمر الله تعالى.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head60">AUTO مسألة : قبول التوبة لا يجب على الله تعالى عقلا وقالت المعتزلة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head61">AUTO مسألة : تصح التوبة عن بعض الذنوب عندنا مع الإصرار على غيره.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head62">AUTO مسألة : من تاب عن ذنب وصحت توبته ثم عاد إلى الذنب فالتوبة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head63">AUTO مسألة : شرائط الإمامة أن يكون من ينصب إماما رجلا مسلما حرا</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head64">AUTO مسألة : نصب إمامين في عصر واحد.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head65">AUTO مسألة : الخليفة بعد ms68 رسول الله - صلى الله عليه وسلم - ، غير</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head66">AUTO مسألة : الخليفة الحق بعد رسول الله - صلى الله عليه وسلم - ،</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head67">AUTO مسألة : عقد الخلافة لا يشترط فيها اجتماع جميع أهل الحل والعقد</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head68">AUTO مسألة : أفضل الصحابة بعد النبي ، عليه السلام ، وخيرهم أبو بكر</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head69">AUTO مسألة : الخلافة بعد أبي بكر لعمر ، - رضي الله عنهما - ، وطريق</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head70">AUTO مسألة : أمير المؤمنين عثمان - رضي الله عنه - قتل ظلما لأن</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head71">AUTO مسألة : كثير من المطاعن من المبتدعة في أئمة الصحابة.</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head72">AUTO مسألة : يزيد بن معاوية من جملة المؤمنين وحاله في المشيئة إن</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head73">AUTO مسألة : الأمر بالمعروف والنهي عن المنكر واجبان.</a>
</li>
</ul>
</body></html></div>
<div class="book body-inner" lang="ara">
<nav class="navbar navbar-expand-lg navbar-light bg-light sticky-top border-bottom" style="direction: ltr;">
<div class="mr-auto d-flex justify-content-left">
<a class="navbar-brand ms-2" href="http://www.kitab-project.org" target="_blank">
<img class="d-inline-block align-top" src="https://cdn.jsdelivr.net/gh/sohailmerchant/kitab-cdn@main/img/kitab-logo.png" width="60px"/>
</a>
</div>
<div class="navbar-nav mx-auto btn-toolbar" style="direction: rtl;">
<div class="d-flex justify-content-center">
<form class="row" id="nav-form" style="margin-bottom: 0px;">
<span class="btn col justify-content-center">ج:</span>
<select class="col form-select pull-left" id="vol-select"></select>
<span class="btn col justify-content-center">ص:</span>
<select class="col form-select pull-left" id="page-select"></select>
<button class="btn col pull-right mx-3" id="nav-submdit-btn" style="width: 100px;" type="submit" value="Go">Go</button>
</form>
</div>
</div>
<div class="btn-toolbar navbar-nav ml-auto d-flex justify-content-right">
<div class="btn-group">
<a class="nav-link pull-right" title="Go to top">
<i class="btn bi bi-arrow-up-circle" id="back-to-top"></i>
</a>
<a class="nav-link pull-right" title="Increase fonts">
<i class="btn bi bi-fonts font-default pull-left"></i>
</a>
<a class="nav-link pull-right" title="Turn light off">
<i class="btn bi bi-lightbulb-off"></i>
</a>
<div class="nav-link pull-right dropdown">
<a aria-expanded="false" aria-haspopup="true" class="" data-bs-toggle="dropdown" id="dropdownMenuButton" role="button" title="Book Metadata">
<i class="btn bi bi-info"></i>
</a>
<div aria-labelledby="dropdownMenuButton" class="dropdown-menu">
<div class="col-12" id="metadata-content"><label>char_length: 93035</label><label>author_lat_full_name: </label><label>author_lat_shuhra: </label><label>author_from_uri: Mutawalli Naysaburi</label><label>tags:  :: ShamAY@العقيدة</label><label>url: https://raw.githubusercontent.com/OpenITI/0500AH/master/data/0478MutawalliNaysaburi/0478MutawalliNaysaburi.GhunyaFiUsulDin/0478MutawalliNaysaburi.GhunyaFiUsulDin.ShamAY0033882-ara1</label><label>tok_length: 21962</label><label>status: sec</label><label>id: ShamAY0033882</label><label>ed_info: غير معروف</label><label>title_lat: Ghunya Fi Usul Din</label><label>title_ar: المغني للإمام المتولي :: كتاب المغني للإمام المتولي :: المغني للإمام المتولي ¶ المؤلف: الإمام أبو سعيد عبد الرحمن بن محمد المأمون المتولي الشافعي ¶ (المتوفى 478 ه) ¶ الناشر: غير معروف ¶ عدد الأجزاء: 1 ¶ تنبيه: ¶ [ترقيم الكتاب موافق للمطبوع] ¶ جزى الله كاتبه ومن تحمل نفقة الكتابة خير الجزاء وأوفاه. ¶ ملاحظة: [هذا الكتاب من كتب المستودع بموقع المكتبة الشاملة]</label><label>book: 0478MutawalliNaysaburi.GhunyaFiUsulDin</label><label>author_lat: Mutawalli Naysaburi</label><label>author_ar: الإمام أبو سعيد عبد الرحمن بن محمد المأمون المتولي الشافعي :: المتولي، أبو سعد :: عبد الرحمن بن مأمون النيسابوري، أبو سعد</label><label>date: 0478</label><label>versionUri: 0478MutawalliNaysaburi.GhunyaFiUsulDin.ShamAY0033882-ara1</label>
</div>
</div>
</div>
<a class="nav-link pull-right" href="#menu-toggle" id="menu-toggle" title="Book Chapters">
<i class="btn bi bi-list"></i></a>
</div>
</div>
</nav>
<div class="book-body fixed pt-5">
<div class="row">
<div class="col-12">
<div class="row top-heading-panel content-outer-spacing">
</div>
</div>
<div class="col-12" id="meta">
</div>
</div>
<div class="row justify-content-md-center" id="book-main">
<div class="col-lg-8 col-sm-12" id="content">
</div>
</div>
<div class="row mt-5" id="footer">
<div class="col-md-12">
            The KITAB project is based at the Institute for the Study of Muslim Civilizations (ISMC) at Aga Khan
            University, London, and has received funding from the European Research Council (ERC) under the European
            Union's
            Horizon 2020 research and innovation programme (Grant agreement No. 772989)

          </div>
<div class="col-md-12">
<img alt="Logos" height="50" id="logos" src="../img/AKU-EU-ERC-three-logos.jpg"/>
</div>
</div>
</div>
</div>
</div>
<script>

    var pageSel = document.getElementById("page-select");
    var volSel = document.getElementById("vol-select");
    var thisVolume = "01";
    var volPages = {"01": ["001", "001", "002", "003", "004", "005", "006", "007", "008", "009", "010", "011", "012", "013", "014", "015", "016", "017", "018", "019", "020", "021", "022", "023", "024", "025", "026", "027", "028", "029", "030", "031", "032", "033", "034", "035", "036", "037", "038", "039", "040", "041", "042", "043", "044", "045", "046", "047", "048", "049", "050", "051", "052", "053", "054", "055", "056", "057", "058", "059", "060", "061", "062", "063", "064", "065", "066"]}; /*loaded by html_builder*/

    function goToAnchor(vol, anchorId) {
      if (vol != window.thisVolume) {
        loadVolume(vol, false).then(res => {
          console.log("Volume loaded");
          console.log("Go to anchor " + anchorId);
          /*move the volume page to the element with id=anchorId*/
          /*var targetAnchor = document.getElementById(anchorId);
          targetAnchor.scrollIntoView({block: 'nearest'});  // this does not always work...
          console.log(targetAnchor);*/
          /*window.location.hash = "";
          window.location.hash = anchorId;
          window.location.hash = anchorId;
          console.log("#"+anchorId);*/
          /*//This approach does not work at all: scrolls only main window.
          var targetAnchor = $("#"+anchorId);
          //$("#content").animate(
          $("html, body").animate(
            {scrollTop: targetAnchor.offset().top},
            1000
          );*/
          /*//This approach does not work at all: scrolls only main window.
          var targetAnchor = document.getElementById(anchorId);
          var rect = targetAnchor.getBoundingClientRect();
          console.log(targetAnchor);
          console.log(rect);
          var viewHeight=Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
          window.scroll({
            top: rect.top + rect.height / 2 - viewHeight /2,
            behavior: 'smooth'
          });*/
          /*var targetAnchor = document.getElementById(anchorId);
          var contentDiv = document.getElementsByClassName("book-body")[0];
          var topPos = contentDiv.offsetTop;
          var windowSize = $(window).height();
          console.log("topPos: " + topPos);
          console.log("targetPos: " + targetAnchor.offsetTop);
          console.log("windowSize:" + windowSize)
          console.log("targetAnchor.offsetTop-windowSize/3 = " + (targetAnchor.offsetTop - topPos - windowSize / 2));
          contentDiv.scrollTop = targetAnchor.offsetTop - topPos - windowSize / 2;*/
          var targetAnchor = document.getElementById(anchorId);
          targetAnchor.scrollIntoView({"block": "start"});
        });
      } else {
        /*move the volume page to the element with id=anchorId*/
        /*var targetAnchor = document.getElementById(anchorId);
        targetAnchor.scrollIntoView({block: 'nearest'});  // this does not always work...
        console.log(targetAnchor);*/
        /*window.location.hash = "";
        window.location.hash = anchorId;
        window.location.hash = anchorId;
        console.log("#"+anchorId);*/
        /*//This approach does not work at all: scrolls only main window.
        var targetAnchor = $("#"+anchorId);
        //$("#content").animate(
        $("html, body").animate(
          {scrollTop: targetAnchor.offset().top},
          1000
        );*/
        /*//This approach does not work at all: scrolls only main window.
        var targetAnchor = document.getElementById(anchorId);
        var rect = targetAnchor.getBoundingClientRect();
        console.log(targetAnchor);
        console.log(rect);
        var viewHeight=Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
        window.scroll({
          top: rect.top + rect.height / 2 - viewHeight /2,
          behavior: 'smooth'
        });*/
        /*var targetAnchor = document.getElementById(anchorId);
        var contentDiv = document.getElementsByClassName("book-body")[0];
        var topPos = contentDiv.offsetTop;
        var windowSize = $(window).height();
        console.log("topPos: " + topPos);
        console.log("targetPos: " + targetAnchor.offsetTop);
        console.log("windowSize:" + windowSize)
        console.log("targetAnchor.offsetTop-windowSize/3 = " + (targetAnchor.offsetTop - topPos - windowSize / 2));
        contentDiv.scrollTop = targetAnchor.offsetTop - topPos - windowSize / 2;*/
        var targetAnchor = document.getElementById(anchorId);
        targetAnchor.scrollIntoView({"block": "start"});
      }
    }

    CollapsibleLists.apply();
    console.log("Applied CollapsibleLists");

    $(document).ready(function () {
      console.log("Load initial volume " + thisVolume);
      loadVolume(thisVolume).then(res => {
        console.log("Initial volume loaded");
        $('#loading').hide();
        $('#loading').fadeOut("slow");
      });
      $(window).scroll(function () {
        if ($(this).scrollTop() > 50) {
          $('#back-to-top').fadeIn();
        } else {
          $('#back-to-top').fadeOut();
        }
      });
      // scroll body to 0px on click
      $('#back-to-top').click(function () {
        $('body,html').animate({
          scrollTop: 0
        }, 400);
        return false;
      });
      $("#menu-toggle").click(function (e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled");
      });

      $(".font-default").click(function () {

        $('#wrapper').toggleClass("font-increase", "font-default");
      });

      $(".bi-lightbulb-off").click(function () {
        $('.bi-lightbulb-off').toggleClass("bi-lightbulb", "bi-lightbulb-off");
        $('.page-wrapper').toggleClass("night-mode", "");
        $('.navbar-light').toggleClass("night-mode", "");
        console.log(this);

      });
      $('.toc-item').click(function (event) {
        /*console.log('toc item clicked');*/
        event.preventDefault();
        var clickedElement = event.target;
        /*console.log(clickedElement);*/
        var href = clickedElement.getAttribute("href");
        /*console.log('href: '+href);*/
        var vol = href.substring(0, 2);
        var head = href.split('head').pop();
        var anchorId = "head" + head;
        goToAnchor(vol, anchorId);
        return false;
      });
    });

    function loadPageNumbers(vol, page) {
      /*var pageSel = document.getElementById("page-select");*/
      pageSel.innerHTML = '';
      volPages[vol].forEach(function (p, index) {
        pageSel.options[pageSel.options.length] = new Option(p, p);
      });
      if (page) {
        pageSel.value = page;
      }
    }

    function loadVolumeNumbers(vol) {
      /*var volSel = document.getElementById("vol-select");*/
      volSel.innerHTML = '';
      /*console.log(Object.keys(volPages));*/
      /*console.log(Object.keys(volPages).sort());*/

      Object.keys(volPages).sort().forEach(function (v, index) {
        /*console.log(v);*/
        volSel.options[volSel.options.length] = new Option(v, v);
      });
      volSel.value = vol;
    }

    async function loadVolume(vol) {
      /*Load volume json */
      var page = pageSel.value;
      $('#loading').show();
      console.log("loading volume " + vol);
      await $.getJSON(vol + ".json", function (json) {
        console.log(json)
        $('#content').empty().append(json["content"]);
        /*console.log("json loaded");*/
        window.thisVolume = vol;
        $('#loading').hide();
        $('#loading').fadeOut("slow");
        /*Load volume and page numbers in page-nav form:*/
        loadVolumeNumbers(vol);
        loadPageNumbers(vol, page);
        return true;
      });
    }


    function padWithZeros(number, width) {
      number = number + "";
      if (number.length >= width) {
        return number;
      } else {
        return new Array(width - number.length + 1).join("0") + number;
      }
    }
    document.getElementById("nav-form").addEventListener("submit", function (event) {
      event.preventDefault();
      /*console.log("Clicked Go");*/
      var vol = volSel.value;
      console.log("vol: " + vol);
      /*var targetPage = parseInt(pageSel.value, 10);
      if (page >= 1) {
        page = page-1; //page number is at bottom of page
      }
      var anchor = "v"+vol+"p"+padWithZeros(targetPage, 3);*/
      var targetPage = pageSel.value;
      var pages = volPages[vol];
      var index = pages.indexOf(targetPage);
      if (index > 0) {
        targetPage = pages[index-1];
      }

      console.log("targetPage: " + targetPage);
      var anchor = "v" + vol + "p" + targetPage;
      goToAnchor(vol, anchor);
      return false;
    });

    /*Adapt the page numbers list when the volume number changes:*/
    volSel.addEventListener("change", function (event) {
      var vol = this.value;
      var page = pageSel.value;
      loadPageNumbers(vol, page);
    });


  </script>
</body>
</html>
