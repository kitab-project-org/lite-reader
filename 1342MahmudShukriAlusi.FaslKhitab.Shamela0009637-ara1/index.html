<html dir="rtl" lang="ar">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta http-equiv="Content-Security-Policy" https:=""/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script crossorigin="anonymous" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js"></script>
<link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" rel="stylesheet"/>
<link href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Amiri&amp;display=swap" rel="stylesheet"/>
<!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css"
        integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous"> -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css" rel="stylesheet"/>
<link crossorigin="anonymous" href="../css/stylev2.css" rel="stylesheet" type="text/css"/>
<script crossorigin="anonymous" src="../js/CollapsibleLists.js" type="application/javascript"></script>
<!-- <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/alpheios-components@latest/dist/style/style-components.min.css" /> -->
<script type="text/javascript">
</script>
</head>
<body>
<div id="loading">
<img alt="Loading..." id="loading-image" src="../img/spinner1.gif"/>
</div>
<div class="page-wrapper toggled" id="wrapper">
<div id="sidebar-wrapper">
<html><body><div class="card-header title-heading">فصول الكتاب</div><ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head0">[مقدمة الطبعة الأولى] محب الدين الخطيب</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head1">مقدمة محمود شكري الألوسي البغدادي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head2">دعاء الصالحين</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head3">التفرق</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head4">مخالفة ولي الأمر</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head5">التقليد</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head6">الاقتداء بالعالم الفاسق أو العابد الجاهل</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head7">الاحتجاج بما كان عليه الآباء بلا دليل</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head8">الاحتجاج على الحق بقلة أهله</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head9">[الاستدلال على بطلان الشيء بكونه غريبا]</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head10">انخداع أهل القوة والحيلة بقوتهم وحيلتهم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head11">انخداع أهل الثروة بثروتهم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head12">78 - </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head13">الاستخفاف بالحق لضعف أهله</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head14">وصم أنصار الحق بما ليس فيهم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head15">التكبر عن نصرة الحق لأن أنصاره ضعفاء</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head16">استدلالهم على بطلان الشيء بكونهم أولى به لو كان حقا</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head17">جهلهم بالجامع والفارق</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head18">الغلو في الصالحين</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head19">الاعتذار بعدم الفهم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head20">إنكارهم الحق الذي لا تقول به طائفتهم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head21">التمسك بخرافات السحر</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head22">التناقض في الانتساب</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head23">صرف النصوص عن مدلولاتها</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head24">تحريف كتب الدين</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head25">الانصراف عن هداية الدين إلى ما يخالفها</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head26">كفرهم بما مع غيرهم من الحق</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head27">ادعاء كل طائفة حصر الحق فيها</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head28">إنكار ما أقروا أنه من دينهم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head29">المجاهرة بكشف العورات</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head30">التعبد بتحريم الحلال</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head31">الإلحاد في أسماء الله سبحانه وصفاته</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head32">نسبة النقائص إلى الله سبحانه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head33">تنزيههم المخلوق عما نسبوه للخالق</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head34">قولهم بالتعطيل</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head35">الشركة في الملك</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head36">إنكار النبوات</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head37">جحودهم القدر واحتجاجهم به على الله</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head38">مسبة الدهر</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head39">إضافة نعم الله إلى غيره</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head40">الكفر بآيات الله</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head41">اختيار كتب الباطل ونبذ آيات الله</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head42">القدح في حكمة الله تعالى</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head43">الكفر بالملائكة والرسل، والتفريق بينهم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head44">الغلو في الأنبياء والرسل</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head45">الجدال بغير علم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head46">الكلام في الدين بلا علم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head47">الكفر باليوم الآخر</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head48">[التكذيب بآية مالك يوم الدين]</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head49">[التكذيب بآية لا بيع فيه ولا خلة ولا شفاعة]</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head50">الخطأ في معنى الشفاعة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head51">قتل أولياء الله</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head52">الإيمان بالجبت والطاغوت</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head53">لبس الحق بالباطل</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head54">الإقرار بالحق للتوصل إلى دفعه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head55">اتخاذ النبيين أربابا</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head56">تحريف الكلم عن مواضعه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head57">تلقيب أهل الهدى بألقاب غريبة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head58">التكذيب بالحق</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head59">الافتراء على المؤمنين</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head60">رمي المؤمنين بالفساد في الأرض</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head61">رمي المؤمنين بتبديل الدين</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head62">اتهام أهل الحق بالفساد في الأرض</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head63">[تناقض مذهبهم لما تركوا الحق]</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head64">[دعواهم العمل بالحق الذي عندهم]</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head65">[الزيادة في العبادة]</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head66">النقص ms64 من العبادة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head0">تعبدهم بترك الطيبات من الرزق</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head1">تعبدهم بالمكاء والتصدية</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head2">النفاق في ms66 العقيدة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head3">دعاؤهم الناس إلى الضلال بغير علم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head4">دعاؤهم إلى الكفر مع العلم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head5">المكر الكبار</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head6">حالة علمائهم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head7">زعمهم أنهم أولياء الله</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head8">دعوى محبة الله مع ترك شرعه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head9">[تمنيهم على الله تعالى الأماني الكاذبة]</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head10">اتخاذ قبور الصالحين مساجد</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head11">اتخاذ آثار الأنبياء مساجد</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head12">اتخاذ السرج على القبور</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head13">اتخاذ القبور أعيادا</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head14">الذبح عند القبور</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head15">التبرك بآثار المعظمين</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head16">[الفخر بالأحساب]</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head17">[الاستسقاء بالأنواء]</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head18">[الطعن في الأنساب]</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head19">[النياحة]</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head20">تعيير الرجل بفعل أمه وأبيه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head21">الافتخار بولاية البيت</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head22">[الافتخار بكونهم من ذرية الأنبياء]</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head23">الافتخار بالصنائع</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head24">عظمة الدنيا في قلوبهم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head25">ازدراء الفقراء</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head26">إنكارهم الملائكة والوحي والرسالة والبعث</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head27">إيمانهم بالجبت والطاغوت</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head28">كتمان الحق مع العلم به</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head29">القول على الله بلا علم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head30">التناقض</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="02.html#head31">الكهانة وما في حكمها</a>
</li>
</ul>
</body></html></div>
<div class="book body-inner" lang="ara">
<nav class="navbar navbar-expand-lg navbar-light bg-light sticky-top border-bottom" style="direction: ltr;">
<div class="mr-auto d-flex justify-content-left">
<a class="navbar-brand ms-2" href="http://www.kitab-project.org" target="_blank">
<img class="d-inline-block align-top" src="https://cdn.jsdelivr.net/gh/sohailmerchant/kitab-cdn@main/img/kitab-logo.png" width="60px"/>
</a>
</div>
<div class="navbar-nav mx-auto btn-toolbar" style="direction: rtl;">
<div class="d-flex justify-content-center">
<form class="row" id="nav-form" style="margin-bottom: 0px;">
<span class="btn col justify-content-center">ج:</span>
<select class="col form-select pull-left" id="vol-select"></select>
<span class="btn col justify-content-center">ص:</span>
<select class="col form-select pull-left" id="page-select"></select>
<button class="btn col pull-right mx-3" id="nav-submdit-btn" style="width: 100px;" type="submit" value="Go">Go</button>
</form>
</div>
</div>
<div class="btn-toolbar navbar-nav ml-auto d-flex justify-content-right">
<div class="btn-group">
<a class="nav-link pull-right" title="Go to top">
<i class="btn bi bi-arrow-up-circle" id="back-to-top"></i>
</a>
<a class="nav-link pull-right" title="Increase fonts">
<i class="btn bi bi-fonts font-default pull-left"></i>
</a>
<a class="nav-link pull-right" title="Turn light off">
<i class="btn bi bi-lightbulb-off"></i>
</a>
<div class="nav-link pull-right dropdown">
<a aria-expanded="false" aria-haspopup="true" class="" data-bs-toggle="dropdown" id="dropdownMenuButton" role="button" title="Book Metadata">
<i class="btn bi bi-info"></i>
</a>
<div aria-labelledby="dropdownMenuButton" class="dropdown-menu">
<div class="col-12" id="metadata-content"><label>char_length: 114640</label><label>author_lat_full_name: </label><label>author_lat_shuhra: </label><label>author_from_uri: Mahmud Shukri Alusi</label><label>tags: CENT1400 :: _CAQAID :: GAL@nodata :: Shamela@العقيدة</label><label>url: https://raw.githubusercontent.com/OpenITI/1350AH/master/data/1342MahmudShukriAlusi/1342MahmudShukriAlusi.FaslKhitab/1342MahmudShukriAlusi.FaslKhitab.Shamela0009637-ara1</label><label>tok_length: 26267</label><label>status: sec</label><label>id: Shamela0009637</label><label>ed_info: وزارة الشؤون الإسلامية والأوقاف والدعوة والإرشاد - المملكة العربية السعودية</label><label>title_lat: Fasl Khitab</label><label>title_ar: فصل الخطاب في شرح مسائل الجاهلية (مطبوع مع رسالة قطف الثمر لصديق حسن خان)</label><label>book: 1342MahmudShukriAlusi.FaslKhitab</label><label>author_lat: Mahmud Shukri Alusi</label><label>author_ar: أبو المعالي محمود شكري بن عبد الله بن محمد بن أبي الثناء الألوسي (المتوفى: 1342هـ)</label><label>date: 1342</label><label>versionUri: 1342MahmudShukriAlusi.FaslKhitab.Shamela0009637-ara1</label>
</div>
</div>
</div>
<a class="nav-link pull-right" href="#menu-toggle" id="menu-toggle" title="Book Chapters">
<i class="btn bi bi-list"></i></a>
</div>
</div>
</nav>
<div class="book-body fixed pt-5">
<div class="row">
<div class="col-12">
<div class="row top-heading-panel content-outer-spacing">
</div>
</div>
<div class="col-12" id="meta">
</div>
</div>
<div class="row justify-content-md-center" id="book-main">
<div class="col-lg-8 col-sm-12" id="content">
</div>
</div>
<div class="row mt-5" id="footer">
<div class="col-md-12">
            The KITAB project is based at the Institute for the Study of Muslim Civilizations (ISMC) at Aga Khan
            University, London, and has received funding from the European Research Council (ERC) under the European
            Union's
            Horizon 2020 research and innovation programme (Grant agreement No. 772989)

          </div>
<div class="col-md-12">
<img alt="Logos" height="50" id="logos" src="../img/AKU-EU-ERC-three-logos.jpg"/>
</div>
</div>
</div>
</div>
</div>
<script>

    var pageSel = document.getElementById("page-select");
    var volSel = document.getElementById("vol-select");
    var thisVolume = "01";
    var volPages = {"01": ["000", "207", "208", "209", "210", "211", "212", "213", "214", "215", "216", "217", "218", "219", "220", "221", "222", "223", "224", "225", "226", "227", "228", "229", "230", "231", "232", "233", "235", "236", "237", "238", "239", "240", "241", "242", "243", "244", "245", "246", "247", "248", "249", "250", "251", "252", "253", "254", "255", "256", "257", "258", "259", "260", "261", "262", "263", "264", "265", "266", "267", "268", "269", "270", "271", "272", "273", "374"], "02": ["275", "276", "277", "278", "279", "280", "281", "282", "283", "284", "285", "286", "287", "288", "289", "290", "291", "292", "293", "294", "295", "296", "297", "298", "299"]}; /*loaded by html_builder*/

    function goToAnchor(vol, anchorId) {
      if (vol != window.thisVolume) {
        loadVolume(vol, false).then(res => {
          console.log("Volume loaded");
          console.log("Go to anchor " + anchorId);
          /*move the volume page to the element with id=anchorId*/
          /*var targetAnchor = document.getElementById(anchorId);
          targetAnchor.scrollIntoView({block: 'nearest'});  // this does not always work...
          console.log(targetAnchor);*/
          /*window.location.hash = "";
          window.location.hash = anchorId;
          window.location.hash = anchorId;
          console.log("#"+anchorId);*/
          /*//This approach does not work at all: scrolls only main window.
          var targetAnchor = $("#"+anchorId);
          //$("#content").animate(
          $("html, body").animate(
            {scrollTop: targetAnchor.offset().top},
            1000
          );*/
          /*//This approach does not work at all: scrolls only main window.
          var targetAnchor = document.getElementById(anchorId);
          var rect = targetAnchor.getBoundingClientRect();
          console.log(targetAnchor);
          console.log(rect);
          var viewHeight=Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
          window.scroll({
            top: rect.top + rect.height / 2 - viewHeight /2,
            behavior: 'smooth'
          });*/
          /*var targetAnchor = document.getElementById(anchorId);
          var contentDiv = document.getElementsByClassName("book-body")[0];
          var topPos = contentDiv.offsetTop;
          var windowSize = $(window).height();
          console.log("topPos: " + topPos);
          console.log("targetPos: " + targetAnchor.offsetTop);
          console.log("windowSize:" + windowSize)
          console.log("targetAnchor.offsetTop-windowSize/3 = " + (targetAnchor.offsetTop - topPos - windowSize / 2));
          contentDiv.scrollTop = targetAnchor.offsetTop - topPos - windowSize / 2;*/
          var targetAnchor = document.getElementById(anchorId);
          targetAnchor.scrollIntoView({"block": "start"});
        });
      } else {
        /*move the volume page to the element with id=anchorId*/
        /*var targetAnchor = document.getElementById(anchorId);
        targetAnchor.scrollIntoView({block: 'nearest'});  // this does not always work...
        console.log(targetAnchor);*/
        /*window.location.hash = "";
        window.location.hash = anchorId;
        window.location.hash = anchorId;
        console.log("#"+anchorId);*/
        /*//This approach does not work at all: scrolls only main window.
        var targetAnchor = $("#"+anchorId);
        //$("#content").animate(
        $("html, body").animate(
          {scrollTop: targetAnchor.offset().top},
          1000
        );*/
        /*//This approach does not work at all: scrolls only main window.
        var targetAnchor = document.getElementById(anchorId);
        var rect = targetAnchor.getBoundingClientRect();
        console.log(targetAnchor);
        console.log(rect);
        var viewHeight=Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
        window.scroll({
          top: rect.top + rect.height / 2 - viewHeight /2,
          behavior: 'smooth'
        });*/
        /*var targetAnchor = document.getElementById(anchorId);
        var contentDiv = document.getElementsByClassName("book-body")[0];
        var topPos = contentDiv.offsetTop;
        var windowSize = $(window).height();
        console.log("topPos: " + topPos);
        console.log("targetPos: " + targetAnchor.offsetTop);
        console.log("windowSize:" + windowSize)
        console.log("targetAnchor.offsetTop-windowSize/3 = " + (targetAnchor.offsetTop - topPos - windowSize / 2));
        contentDiv.scrollTop = targetAnchor.offsetTop - topPos - windowSize / 2;*/
        var targetAnchor = document.getElementById(anchorId);
        targetAnchor.scrollIntoView({"block": "start"});
      }
    }

    CollapsibleLists.apply();
    console.log("Applied CollapsibleLists");

    $(document).ready(function () {
      console.log("Load initial volume " + thisVolume);
      loadVolume(thisVolume).then(res => {
        console.log("Initial volume loaded");
        $('#loading').hide();
        $('#loading').fadeOut("slow");
      });
      $(window).scroll(function () {
        if ($(this).scrollTop() > 50) {
          $('#back-to-top').fadeIn();
        } else {
          $('#back-to-top').fadeOut();
        }
      });
      // scroll body to 0px on click
      $('#back-to-top').click(function () {
        $('body,html').animate({
          scrollTop: 0
        }, 400);
        return false;
      });
      $("#menu-toggle").click(function (e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled");
      });

      $(".font-default").click(function () {

        $('#wrapper').toggleClass("font-increase", "font-default");
      });

      $(".bi-lightbulb-off").click(function () {
        $('.bi-lightbulb-off').toggleClass("bi-lightbulb", "bi-lightbulb-off");
        $('.page-wrapper').toggleClass("night-mode", "");
        $('.navbar-light').toggleClass("night-mode", "");
        console.log(this);

      });
      $('.toc-item').click(function (event) {
        /*console.log('toc item clicked');*/
        event.preventDefault();
        var clickedElement = event.target;
        /*console.log(clickedElement);*/
        var href = clickedElement.getAttribute("href");
        /*console.log('href: '+href);*/
        var vol = href.substring(0, 2);
        var head = href.split('head').pop();
        var anchorId = "head" + head;
        goToAnchor(vol, anchorId);
        return false;
      });
    });

    function loadPageNumbers(vol, page) {
      /*var pageSel = document.getElementById("page-select");*/
      pageSel.innerHTML = '';
      volPages[vol].forEach(function (p, index) {
        pageSel.options[pageSel.options.length] = new Option(p, p);
      });
      if (page) {
        pageSel.value = page;
      }
    }

    function loadVolumeNumbers(vol) {
      /*var volSel = document.getElementById("vol-select");*/
      volSel.innerHTML = '';
      /*console.log(Object.keys(volPages));*/
      /*console.log(Object.keys(volPages).sort());*/

      Object.keys(volPages).sort().forEach(function (v, index) {
        /*console.log(v);*/
        volSel.options[volSel.options.length] = new Option(v, v);
      });
      volSel.value = vol;
    }

    async function loadVolume(vol) {
      /*Load volume json */
      var page = pageSel.value;
      $('#loading').show();
      console.log("loading volume " + vol);
      await $.getJSON(vol + ".json", function (json) {
        console.log(json)
        $('#content').empty().append(json["content"]);
        /*console.log("json loaded");*/
        window.thisVolume = vol;
        $('#loading').hide();
        $('#loading').fadeOut("slow");
        /*Load volume and page numbers in page-nav form:*/
        loadVolumeNumbers(vol);
        loadPageNumbers(vol, page);
        return true;
      });
    }


    function padWithZeros(number, width) {
      number = number + "";
      if (number.length >= width) {
        return number;
      } else {
        return new Array(width - number.length + 1).join("0") + number;
      }
    }
    document.getElementById("nav-form").addEventListener("submit", function (event) {
      event.preventDefault();
      /*console.log("Clicked Go");*/
      var vol = volSel.value;
      console.log("vol: " + vol);
      /*var targetPage = parseInt(pageSel.value, 10);
      if (page >= 1) {
        page = page-1; //page number is at bottom of page
      }
      var anchor = "v"+vol+"p"+padWithZeros(targetPage, 3);*/
      var targetPage = pageSel.value;
      var pages = volPages[vol];
      var index = pages.indexOf(targetPage);
      if (index > 0) {
        targetPage = pages[index-1];
      }

      console.log("targetPage: " + targetPage);
      var anchor = "v" + vol + "p" + targetPage;
      goToAnchor(vol, anchor);
      return false;
    });

    /*Adapt the page numbers list when the volume number changes:*/
    volSel.addEventListener("change", function (event) {
      var vol = this.value;
      var page = pageSel.value;
      loadPageNumbers(vol, page);
    });


  </script>
</body>
</html>
