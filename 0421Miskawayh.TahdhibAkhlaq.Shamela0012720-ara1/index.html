<html dir="rtl" lang="ar">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta http-equiv="Content-Security-Policy" https:=""/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script crossorigin="anonymous" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js"></script>
<link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" rel="stylesheet"/>
<link href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Amiri&amp;display=swap" rel="stylesheet"/>
<!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css"
        integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous"> -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css" rel="stylesheet"/>
<link crossorigin="anonymous" href="../css/stylev2.css" rel="stylesheet" type="text/css"/>
<script crossorigin="anonymous" src="../js/CollapsibleLists.js" type="application/javascript"></script>
<!-- <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/alpheios-components@latest/dist/style/style-components.min.css" /> -->
<script type="text/javascript">
</script>
</head>
<body>
<div id="loading">
<img alt="Loading..." id="loading-image" src="../img/spinner1.gif"/>
</div>
<div class="page-wrapper toggled" id="wrapper">
<div id="sidebar-wrapper">
<html><body><div class="card-header title-heading">فصول الكتاب</div><ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head0"></a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head1"></a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head2">تعريف النفس&lt;/</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head3"></a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head4"></a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head5">شوق النفس إلى أفعالها الخاصة بها</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head6"></a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head7"></a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head8"></a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head9"></a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head10"></a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head11"></a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head12">{الأقسام التي تحت الحكمة </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head13">الفضائل التي تحت العفة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head14">الفضائل التي تحت الشجاعة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head15">الفضائل التي تحت السخاء</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head16">الفضائل التي تحت العدالة</a>
</li>
</ul>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head17">المقالة الثانية</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head18">الشريعة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head19">الإنسان</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head20">الفلسفة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head21">كمال الإنسان في ms025 الذات المعنوية</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head22">قوى النفس الثلاثاء</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head23">الواجب على العاقل</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head24">النفوس الثلاثاء </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head25">سياسة النفس العاقلة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head26">فصل في تأديب الأحداث والصبيان خاصة نقلت أكثره من كتاب بروسنس</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head27">الملابس</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head28">آداب المطاعم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head29">آداب متنوعة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head30">الأجسام الطبيعية</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head31">مراتب الحيوان</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head32">الشوق إلى المعارف والعلوم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head33">الواجب على الحاكم</a>
</li>
</ul>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head34"></a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head35"></a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head36">أقسام الخير</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head37"></a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head38">رأى المؤلف في السعادة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head39">أول رتب الفضائل</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head40">آخر مراتب الفضائل</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head41">الرتبة الأولى من السعادة الأخيرة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head42">رأى أرسطوطاليس في بقاء النفس</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head43">لذة السعادة</a>
</li>
</ul>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head44">المقالة الرابعة (ظهور الفضائل ممن ليس بسعيد ولا فاضل)</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head45">الحاجة إلى المال واكتسابه بالطرق الشريفة العادلة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head46">العادل</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head47">مواضع العدالة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head48">لزوم الشريعة في المعاملات</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head49">الإمام العادل</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head50">أسباب المضرات</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head51">تقسيم العدالة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head52">ما يجب على الإنسان لخالقه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head53">أسباب الإنقطاع عن الله</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head54">مسألة عويصة أولى</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head55">مسألة عويصة ثانية</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head56">الشريعة تأمر بالعدالة </a>
</li>
</ul>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head57">المقالة الخامسة (التعاون والإتحاد)</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head58">المحبة </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head59">الصداقة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head60">الشريعة تدعو إلى الأنس والمحبة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head61">الخليفة يحرس الدين</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head62">أجناس المحبات وأسبابها</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head63">محبة الأخيار</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head64">نسبة الملك إلى رعيته</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head65">المحبة التي لا تطرأ عليها الآفات</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head66">الشرير</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head67">الخير الفاضل</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head68">الأصدقاء: </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head69">كيف يختار الصديق</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head70">آداب الصداقة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head71">رأى أرسطوطاليس في السعادة التامة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head72">الراحة البدنية ليست من أسباب السعادة</a>
</li>
</ul>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head73">المقالة السادسة دواء النفوس</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head74"></a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head75">اللذة التي تطيقها الشريعة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head76">الملوك</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head77">القناعة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head78">حافظ الصحة على نفسه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head79">معرفة المرء عيوب نفسه</a>
</li>
</ul>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head80">المقالة السابعة رد الصحة على النفس</a>
<ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head81"></a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head82">التهور والجبن</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head83">العجب والإفتخار</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head84">المزاح والتيه والإستهزاء</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head85">الغدر والضيم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head86">المقتنيات والجواهر النفيسة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head87">أسباب الغضب</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head88">الجبن والخور</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head89">الخوف وأسبابه وعلاجه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head90">علاج الخوف من الموت</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l2" href="01.html#head91">علاج الحزن</a>
</li>
</ul>
</li>
</ul>
</body></html></div>
<div class="book body-inner" lang="ara">
<nav class="navbar navbar-expand-lg navbar-light bg-light sticky-top border-bottom" style="direction: ltr;">
<div class="mr-auto d-flex justify-content-left">
<a class="navbar-brand ms-2" href="http://www.kitab-project.org" target="_blank">
<img class="d-inline-block align-top" src="https://cdn.jsdelivr.net/gh/sohailmerchant/kitab-cdn@main/img/kitab-logo.png" width="60px"/>
</a>
</div>
<div class="navbar-nav mx-auto btn-toolbar" style="direction: rtl;">
<div class="d-flex justify-content-center">
<form class="row" id="nav-form" style="margin-bottom: 0px;">
<span class="btn col justify-content-center">ج:</span>
<select class="col form-select pull-left" id="vol-select"></select>
<span class="btn col justify-content-center">ص:</span>
<select class="col form-select pull-left" id="page-select"></select>
<button class="btn col pull-right mx-3" id="nav-submdit-btn" style="width: 100px;" type="submit" value="Go">Go</button>
</form>
</div>
</div>
<div class="btn-toolbar navbar-nav ml-auto d-flex justify-content-right">
<div class="btn-group">
<a class="nav-link pull-right" title="Go to top">
<i class="btn bi bi-arrow-up-circle" id="back-to-top"></i>
</a>
<a class="nav-link pull-right" title="Increase fonts">
<i class="btn bi bi-fonts font-default pull-left"></i>
</a>
<a class="nav-link pull-right" title="Turn light off">
<i class="btn bi bi-lightbulb-off"></i>
</a>
<div class="nav-link pull-right dropdown">
<a aria-expanded="false" aria-haspopup="true" class="" data-bs-toggle="dropdown" id="dropdownMenuButton" role="button" title="Book Metadata">
<i class="btn bi bi-info"></i>
</a>
<div aria-labelledby="dropdownMenuButton" class="dropdown-menu">
<div class="col-12" id="metadata-content"><label>char_length: 186683</label><label>author_lat_full_name: </label><label>author_lat_shuhra: </label><label>author_from_uri: Miskawayh</label><label>tags: COMPLETED :: CENT0500 :: _ADAB :: _ADHKAR :: _AKHLAQ :: _MISC :: _RAQAIQ :: _SULUK :: GAL@historiography :: GAL@literature-islamic :: GAL@1000-1258CE :: GAL@history :: GAL@literature-arabic :: GAL@history-caliphs :: GAL@period-postclassical :: GAL@history-world :: Shamela@الرقاق والآداب والأذكار</label><label>url: https://raw.githubusercontent.com/OpenITI/0425AH/master/data/0421Miskawayh/0421Miskawayh.TahdhibAkhlaq/0421Miskawayh.TahdhibAkhlaq.Shamela0012720-ara1.completed</label><label>tok_length: 42252</label><label>status: pri</label><label>id: Shamela0012720</label><label>ed_info: ابن الخطيب :: مكتبة الثقافة الدينية :: http://www.worldcat.org/oclc/4770203083</label><label>title_lat: Tahdhib Akhlaq</label><label>title_ar: تهذيب الأخلاق وتطهير الأعراق</label><label>book: 0421Miskawayh.TahdhibAkhlaq</label><label>author_lat: Miskawayh</label><label>author_ar: أبو علي أحمد بن محمد بن يعقوب مسكويه (المتوفى: 421هـ)</label><label>date: 0421</label><label>versionUri: 0421Miskawayh.TahdhibAkhlaq.Shamela0012720-ara1</label>
</div>
</div>
</div>
<a class="nav-link pull-right" href="#menu-toggle" id="menu-toggle" title="Book Chapters">
<i class="btn bi bi-list"></i></a>
</div>
</div>
</nav>
<div class="book-body fixed pt-5">
<div class="row">
<div class="col-12">
<div class="row top-heading-panel content-outer-spacing">
</div>
</div>
<div class="col-12" id="meta">
</div>
</div>
<div class="row justify-content-md-center" id="book-main">
<div class="col-lg-8 col-sm-12" id="content">
</div>
</div>
<div class="row mt-5" id="footer">
<div class="col-md-12">
            The KITAB project is based at the Institute for the Study of Muslim Civilizations (ISMC) at Aga Khan
            University, London, and has received funding from the European Research Council (ERC) under the European
            Union's
            Horizon 2020 research and innovation programme (Grant agreement No. 772989)

          </div>
<div class="col-md-12">
<img alt="Logos" height="50" id="logos" src="../img/AKU-EU-ERC-three-logos.jpg"/>
</div>
</div>
</div>
</div>
</div>
<script>

    var pageSel = document.getElementById("page-select");
    var volSel = document.getElementById("vol-select");
    var thisVolume = "01";
    var volPages = {"01": ["000", "009", "010", "013", "014", "015", "016", "017", "018", "019", "020", "021", "022", "023", "024", "025", "026", "027", "028", "029", "030", "031", "032", "033", "034", "035", "036", "037", "038", "039", "041", "042", "043", "044", "045", "046", "047", "048", "049", "050", "051", "052", "053", "054", "055", "056", "057", "058", "059", "060", "061", "062", "063", "064", "065", "066", "067", "068", "069", "070", "071", "072", "073", "074", "075", "076", "077", "078", "079", "080", "081", "082", "083", "084", "087", "088", "089", "090", "091", "092", "093", "094", "095", "096", "097", "098", "099", "100", "101", "102", "103", "104", "105", "106", "107", "108", "109", "110", "111", "112", "113", "114", "115", "117", "118", "119", "120", "121", "122", "123", "124", "125", "126", "127", "128", "129", "130", "131", "132", "133", "134", "135", "136", "137", "138", "139", "140", "141", "142", "143", "144", "145", "147", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "162", "163", "164", "165", "166", "167", "168", "169", "170", "171", "172", "173", "174", "175", "176", "177", "178", "179", "180", "181", "182", "183", "185", "186", "187", "188", "189", "190", "191", "192", "193", "194", "195", "196", "197", "198", "199", "201", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214", "215", "216", "217", "218", "219", "220", "221", "222", "223", "224", "225", "226", "227", "228"]}; /*loaded by html_builder*/

    function goToAnchor(vol, anchorId) {
      if (vol != window.thisVolume) {
        loadVolume(vol, false).then(res => {
          console.log("Volume loaded");
          console.log("Go to anchor " + anchorId);
          /*move the volume page to the element with id=anchorId*/
          /*var targetAnchor = document.getElementById(anchorId);
          targetAnchor.scrollIntoView({block: 'nearest'});  // this does not always work...
          console.log(targetAnchor);*/
          /*window.location.hash = "";
          window.location.hash = anchorId;
          window.location.hash = anchorId;
          console.log("#"+anchorId);*/
          /*//This approach does not work at all: scrolls only main window.
          var targetAnchor = $("#"+anchorId);
          //$("#content").animate(
          $("html, body").animate(
            {scrollTop: targetAnchor.offset().top},
            1000
          );*/
          /*//This approach does not work at all: scrolls only main window.
          var targetAnchor = document.getElementById(anchorId);
          var rect = targetAnchor.getBoundingClientRect();
          console.log(targetAnchor);
          console.log(rect);
          var viewHeight=Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
          window.scroll({
            top: rect.top + rect.height / 2 - viewHeight /2,
            behavior: 'smooth'
          });*/
          /*var targetAnchor = document.getElementById(anchorId);
          var contentDiv = document.getElementsByClassName("book-body")[0];
          var topPos = contentDiv.offsetTop;
          var windowSize = $(window).height();
          console.log("topPos: " + topPos);
          console.log("targetPos: " + targetAnchor.offsetTop);
          console.log("windowSize:" + windowSize)
          console.log("targetAnchor.offsetTop-windowSize/3 = " + (targetAnchor.offsetTop - topPos - windowSize / 2));
          contentDiv.scrollTop = targetAnchor.offsetTop - topPos - windowSize / 2;*/
          var targetAnchor = document.getElementById(anchorId);
          targetAnchor.scrollIntoView({"block": "start"});
        });
      } else {
        /*move the volume page to the element with id=anchorId*/
        /*var targetAnchor = document.getElementById(anchorId);
        targetAnchor.scrollIntoView({block: 'nearest'});  // this does not always work...
        console.log(targetAnchor);*/
        /*window.location.hash = "";
        window.location.hash = anchorId;
        window.location.hash = anchorId;
        console.log("#"+anchorId);*/
        /*//This approach does not work at all: scrolls only main window.
        var targetAnchor = $("#"+anchorId);
        //$("#content").animate(
        $("html, body").animate(
          {scrollTop: targetAnchor.offset().top},
          1000
        );*/
        /*//This approach does not work at all: scrolls only main window.
        var targetAnchor = document.getElementById(anchorId);
        var rect = targetAnchor.getBoundingClientRect();
        console.log(targetAnchor);
        console.log(rect);
        var viewHeight=Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
        window.scroll({
          top: rect.top + rect.height / 2 - viewHeight /2,
          behavior: 'smooth'
        });*/
        /*var targetAnchor = document.getElementById(anchorId);
        var contentDiv = document.getElementsByClassName("book-body")[0];
        var topPos = contentDiv.offsetTop;
        var windowSize = $(window).height();
        console.log("topPos: " + topPos);
        console.log("targetPos: " + targetAnchor.offsetTop);
        console.log("windowSize:" + windowSize)
        console.log("targetAnchor.offsetTop-windowSize/3 = " + (targetAnchor.offsetTop - topPos - windowSize / 2));
        contentDiv.scrollTop = targetAnchor.offsetTop - topPos - windowSize / 2;*/
        var targetAnchor = document.getElementById(anchorId);
        targetAnchor.scrollIntoView({"block": "start"});
      }
    }

    CollapsibleLists.apply();
    console.log("Applied CollapsibleLists");

    $(document).ready(function () {
      console.log("Load initial volume " + thisVolume);
      loadVolume(thisVolume).then(res => {
        console.log("Initial volume loaded");
        $('#loading').hide();
        $('#loading').fadeOut("slow");
      });
      $(window).scroll(function () {
        if ($(this).scrollTop() > 50) {
          $('#back-to-top').fadeIn();
        } else {
          $('#back-to-top').fadeOut();
        }
      });
      // scroll body to 0px on click
      $('#back-to-top').click(function () {
        $('body,html').animate({
          scrollTop: 0
        }, 400);
        return false;
      });
      $("#menu-toggle").click(function (e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled");
      });

      $(".font-default").click(function () {

        $('#wrapper').toggleClass("font-increase", "font-default");
      });

      $(".bi-lightbulb-off").click(function () {
        $('.bi-lightbulb-off').toggleClass("bi-lightbulb", "bi-lightbulb-off");
        $('.page-wrapper').toggleClass("night-mode", "");
        $('.navbar-light').toggleClass("night-mode", "");
        console.log(this);

      });
      $('.toc-item').click(function (event) {
        /*console.log('toc item clicked');*/
        event.preventDefault();
        var clickedElement = event.target;
        /*console.log(clickedElement);*/
        var href = clickedElement.getAttribute("href");
        /*console.log('href: '+href);*/
        var vol = href.substring(0, 2);
        var head = href.split('head').pop();
        var anchorId = "head" + head;
        goToAnchor(vol, anchorId);
        return false;
      });
    });

    function loadPageNumbers(vol, page) {
      /*var pageSel = document.getElementById("page-select");*/
      pageSel.innerHTML = '';
      volPages[vol].forEach(function (p, index) {
        pageSel.options[pageSel.options.length] = new Option(p, p);
      });
      if (page) {
        pageSel.value = page;
      }
    }

    function loadVolumeNumbers(vol) {
      /*var volSel = document.getElementById("vol-select");*/
      volSel.innerHTML = '';
      /*console.log(Object.keys(volPages));*/
      /*console.log(Object.keys(volPages).sort());*/

      Object.keys(volPages).sort().forEach(function (v, index) {
        /*console.log(v);*/
        volSel.options[volSel.options.length] = new Option(v, v);
      });
      volSel.value = vol;
    }

    async function loadVolume(vol) {
      /*Load volume json */
      var page = pageSel.value;
      $('#loading').show();
      console.log("loading volume " + vol);
      await $.getJSON(vol + ".json", function (json) {
        console.log(json)
        $('#content').empty().append(json["content"]);
        /*console.log("json loaded");*/
        window.thisVolume = vol;
        $('#loading').hide();
        $('#loading').fadeOut("slow");
        /*Load volume and page numbers in page-nav form:*/
        loadVolumeNumbers(vol);
        loadPageNumbers(vol, page);
        return true;
      });
    }


    function padWithZeros(number, width) {
      number = number + "";
      if (number.length >= width) {
        return number;
      } else {
        return new Array(width - number.length + 1).join("0") + number;
      }
    }
    document.getElementById("nav-form").addEventListener("submit", function (event) {
      event.preventDefault();
      /*console.log("Clicked Go");*/
      var vol = volSel.value;
      console.log("vol: " + vol);
      /*var targetPage = parseInt(pageSel.value, 10);
      if (page >= 1) {
        page = page-1; //page number is at bottom of page
      }
      var anchor = "v"+vol+"p"+padWithZeros(targetPage, 3);*/
      var targetPage = pageSel.value;
      var pages = volPages[vol];
      var index = pages.indexOf(targetPage);
      if (index > 0) {
        targetPage = pages[index-1];
      }

      console.log("targetPage: " + targetPage);
      var anchor = "v" + vol + "p" + targetPage;
      goToAnchor(vol, anchor);
      return false;
    });

    /*Adapt the page numbers list when the volume number changes:*/
    volSel.addEventListener("change", function (event) {
      var vol = this.value;
      var page = pageSel.value;
      loadPageNumbers(vol, page);
    });


  </script>
</body>
</html>
