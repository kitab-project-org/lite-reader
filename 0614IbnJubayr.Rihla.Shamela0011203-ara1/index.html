<html dir="rtl" lang="ar">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta http-equiv="Content-Security-Policy" https:=""/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script crossorigin="anonymous" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js"></script>
<link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" rel="stylesheet"/>
<link href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Amiri&amp;display=swap" rel="stylesheet"/>
<!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css"
        integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous"> -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css" rel="stylesheet"/>
<link crossorigin="anonymous" href="../css/stylev2.css" rel="stylesheet" type="text/css"/>
<script crossorigin="anonymous" src="../js/CollapsibleLists.js" type="application/javascript"></script>
<!-- <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/alpheios-components@latest/dist/style/style-components.min.css" /> -->
<script type="text/javascript">
</script>
</head>
<body>
<div id="loading">
<img alt="Loading..." id="loading-image" src="../img/spinner1.gif"/>
</div>
<div class="page-wrapper toggled" id="wrapper">
<div id="sidebar-wrapper">
<html><body><div class="card-header title-heading">فصول الكتاب</div><ul class="collapsibleList">
<li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head0">المجلد الأول</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head1">تذكره بالأخبار عن اتفاقات الأسفار</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head2">أهوال البحر</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head3">البشرى بالسلامة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head4">شهر ذي الحجة من السنة المذكورة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head5">ذكر بعض أخبار الإسكندرية وآثارها</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head6">منار الإسكندرية</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head7">منافب الإسكندرية</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head8">ذكر مصر والقاهرة وبعض آثارها العجيبة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head9">ذكر مشاهد أهل البيت رضى الله عنهم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head10">مشاهد الشريفات العلويات رضي الله عنهم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head11">ذكر مشاهد بعض أصحاب رسول الله صلى الله عليه وسلم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head12">مشاهدالأئمة العلماء الزهار رضي الله عنهم أجمعين</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head13">قلعة القاهرة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head14">مستشفى المجانين</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head15">مسجد ابن طولون</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head16">مآثر السلطان ومفاخره</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head17">معجزة البناء</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head18">روضة النيل</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head19">عدل صلاح ms017 الدين</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head20">ذكر ما استدرك خبره مما كان غفل</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head21">رجع الذكر</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head22">مواقف خزي ومهانة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head23">أشنع ما شاهدناه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head24">ما اجتزنا من المواضع</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head25">شهر صفر عرفنا الله يمنه وبركته</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head26">شهر ربيع الأول عرفنا الله بركته</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head27">أحفل مراسي الدنيا</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head28">آفة الحجاج</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head29">أهل عيذاب</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head30">أهل بحر فرعون</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head31">شهر ربيع الآخر عرفنا الله بركته</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head32">صفة جدة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head33">شيع يستغلون الحجاج</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head34">لا إسلام إلا في الغرب</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head35">..... </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head36">الدعوة المؤمنية الموحدية</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head37">من جدة إلى الحرم الشريف</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head38">شهر جمادي الأولى عرفنا الله بركته</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head39">ذكر المسجد الحرام والبيت العتيق كرمه الله وشرفه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head40">ذكر أبواب الحرم الشريف قدسه الله</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head41">… </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head42">ذكر مكة شرفها الله تعالى وآثارها الكريمة وأخبارها الشريفة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head43">ذكر بعض مشاهدها المعظمة وآثارها المقدسة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head44">ذكر ما خص الله تعالى به مكة من الخيرات والبركات</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head45">شهر جمادى الآخرة عرفنا الله يمنه وبركته</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head46">جمال الدين وآثاره السنية</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head47">الأمور المحظورة في الحرم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head48">شهر رجب الفرد عرفنا الله بركته</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head49">العمرة الرجبية</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head50">السرو المائرون</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head51">عود إلى العمرة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head52">عمرة الأكمة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head53">يوم طواف النساء</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head54">غسيل البيت بماء زمزم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head55">شهر شعبان المكرم عرفنا الله بكرته</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head56">زيادة ماء زمزم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head57">ليلة النصف من شعبان</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head58">ليلة النصف من شعبان</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head59">شهر رمضان المعظم عرفنا الله بركته</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head60">سيف الإسلام</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head61">تراويح رمضان</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head62">شهر شوال عرفنا الله بركته</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head63">عيد رمضان</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head64">مناسك الحج</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head65">شهر ذي القعدة عرفنا الله يمنه وبركته</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head66">مسجد مولد النبي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head67">منشأ الإسلام</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head68">شهر ذي الحجة عرفنا الله بركته</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head69">إلى عرفات</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head70">جبل الرحمة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head71">وصول الأمير العراقي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head72">استيفاء حال النفر</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head73">الانحدار إلى مكة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head74">كسوة الأمير العراقي للكعبة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head75">يوم الأعاجم العراقيين</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head76">سوق المسجد الحرام</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head77">يوم الرحيل</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head78">شهر محرم سنة ثمانين وخمسمائة1 عرفنا الله بركته وبركة سنته وخصنا فيه برحمته، وتكفلنا بعصمته</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head79">ذكر مسجد رسول الله صلى الله عليه وسلم،</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head80">ذكر المشاهد المكرمة التي ببقيع الغرقد وصفح جبل أحد</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head81">الخاتون بنت الأمير سعود</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head82">وعظ رئيس العلماء</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head83">من المدينة إلى العراق</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head84">ذكر مدينة الكفوة حرسها الله تعالى</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head85">ذكر مدينة الحلة حرسها الله تعالى</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head86">شهر صفر سنة ثمانين1 عرفنا الله يمنه وبركته</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head87">ذكر مدينة السلام بغداد حرسها الله تعالى</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head88">مجالس علم ووعظ</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head89">دار الخلافة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head90">الحمامات والمساجد والمدارس</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head91">أبواب الشرقية</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head92">من بغداد إلى الموصل</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head93">ذكر مدينة تكريت حرسها الله تعالى</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head94">ذكر مدينة الموصل حرسها الله تعالى</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head95">أحفل المشاهد</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head96">شهر ربيع الأول من سنة ثمانين عرفنا الله بكرته</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head97">ذكر ms161 مدينة نصيبين حرسها الله</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head98">ذكر مدينة دنيصر حرسها الله</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head99">ذكر مدينة رأس العين حرسها الله</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head100">ذكر مدينة حران كلاها الله</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head101">ذكر مدينة منبج حرسها الله</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head102">ذكر بلدة بزاعة كلاها الله عز وجل</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head103">ذكر مدينة حلب حرسها الله تعالى</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head104">ذكر مدينة حماة حماها الله تعالى</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head105">ذكر مدينة حمص حرسها الله تعالى</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head106">شهر ربيع الآخر</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head107">ذكر مدينة دمشق حرسها الله تعالى</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head108">ذكر جامعها المكرم عمره الله تعالى</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head109">ذكر تذريعه ومساحته وعدد أبوابه وشمسياته1</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head110">..... </a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head111">ذكر مشاهده المركمة وآثاره المعظمة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head112">ذكر جمل من أحوال البلد عمره الله بالإسلام</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head113">مرافق الغرباء</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head114">من عجيب أمر المشارقة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head115">نصارى جبل لبنان</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head116">الحرب واتفاق النصارى والمسلمين</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head117">دمشق وآثارها</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head118">من أعظم مناظر الدنيا</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head119">رتبهم في جنائزهم</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head120">حسن سيرة السلطان</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head121">شهر جمادي الآخرة عرفنا الله بركته</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head122">من أعجب الأحاديث</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head123">ذكر مدينة بانياس حماها الله تعالى</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head124">ذكر مدينة عكة دمرها الله وأعادها</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head125">ذكر مدينة صور دمرها الله تعالى</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head126">عرس إفرنجي في صور</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head127">مسلمو عكة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head128">أسرى المسلمين</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head129">سوء الاتفاق</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head130">عكة وصور</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head131">في المركب الشراعي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head132">شهر رجب الفرد عرفنا الله بركته ويمنه</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head133">شهر شعبان المكرم عرفنا الله خيره وبركته</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head134">ثورة الريح الشمالية</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head135">الرياح العاصفة الغربية</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head136">شهر رمضان المعظم عرفنا الله البركة والقبول فيه بمنه وكرمه لا رب غيره</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head137">الإشراف على الغرق</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head138">الزوارق المغيثة</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head139">ذكر مدينة مسنية من جزيرة صقلية أعادها الله تعالى</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head140">المسلمون في صقلية</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head141">الملك غليام وحسن سيرته</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head142">القصر الأبيض</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head143">المسلمون في دولة غليام</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head144">مغادرة صقلية</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head145">ذكر مدينة شفلودي من جزيرة صقلية أعادها الله</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head146">ذكر مدينة ثرمة من الجزيرة المذكورة فتحها الله</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head147">ذكر المدينة التي هي حضرة صقلية أعادها الله</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head148">كنيسة الأنطاكي</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head149">ذكر مدينة أطرابنش من جزيرة صقلية أعادها الله</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head150">شهر شوال عرفنا بمنه وبركته</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head151">شهر ذي القعدة عرفنا الله يمنه وبركته</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head152">شهر ذي الحجة عرفنا الله بمنه وبركته</a>
</li><li class="collapsibleListClosed">
<a class="toc-item l1" href="01.html#head153">شهر محرم سنة إحدى وثمانين عرفنا الله بركتها بمنه</a>
</li>
</ul>
</body></html></div>
<div class="book body-inner" lang="ara">
<nav class="navbar navbar-expand-lg navbar-light bg-light sticky-top border-bottom" style="direction: ltr;">
<div class="mr-auto d-flex justify-content-left">
<a class="navbar-brand ms-2" href="http://www.kitab-project.org" target="_blank">
<img class="d-inline-block align-top" src="https://cdn.jsdelivr.net/gh/sohailmerchant/kitab-cdn@main/img/kitab-logo.png" width="60px"/>
</a>
</div>
<div class="navbar-nav mx-auto btn-toolbar" style="direction: rtl;">
<div class="d-flex justify-content-center">
<form class="row" id="nav-form" style="margin-bottom: 0px;">
<span class="btn col justify-content-center">ج:</span>
<select class="col form-select pull-left" id="vol-select"></select>
<span class="btn col justify-content-center">ص:</span>
<select class="col form-select pull-left" id="page-select"></select>
<button class="btn col pull-right mx-3" id="nav-submdit-btn" style="width: 100px;" type="submit" value="Go">Go</button>
</form>
</div>
</div>
<div class="btn-toolbar navbar-nav ml-auto d-flex justify-content-right">
<div class="btn-group">
<a class="nav-link pull-right" title="Go to top">
<i class="btn bi bi-arrow-up-circle" id="back-to-top"></i>
</a>
<a class="nav-link pull-right" title="Increase fonts">
<i class="btn bi bi-fonts font-default pull-left"></i>
</a>
<a class="nav-link pull-right" title="Turn light off">
<i class="btn bi bi-lightbulb-off"></i>
</a>
<div class="nav-link pull-right dropdown">
<a aria-expanded="false" aria-haspopup="true" class="" data-bs-toggle="dropdown" id="dropdownMenuButton" role="button" title="Book Metadata">
<i class="btn bi bi-info"></i>
</a>
<div aria-labelledby="dropdownMenuButton" class="dropdown-menu">
<div class="col-12" id="metadata-content"><label>char_length: 331032</label><label>author_lat_full_name: </label><label>author_lat_shuhra: </label><label>author_from_uri: Ibn Jubayr</label><label>tags: CENT0700 :: GEO :: PPE :: _BULDAN :: _JUGHRAFIYA :: _MUDHAKKARAT :: _RIHLAT :: _TARIKH :: GAL@geographies :: GAL@literature-islamic :: GAL@1000-1258CE :: GAL@literature-arabic :: GAL@travelogues :: GAL@period-postclassical :: Shamela@البلدان والجغرافيا والرحلات</label><label>url: https://raw.githubusercontent.com/OpenITI/0625AH/master/data/0614IbnJubayr/0614IbnJubayr.Rihla/0614IbnJubayr.Rihla.Shamela0011203-ara1</label><label>tok_length: 73647</label><label>status: sec</label><label>id: Shamela0011203</label><label>ed_info: دار بيروت للطباعة والنشر - بيروت</label><label>title_lat: Rihla</label><label>title_ar: رحلة ابن جبير</label><label>book: 0614IbnJubayr.Rihla</label><label>author_lat: Ibn Jubayr</label><label>author_ar: ابن جبير، محمد بن أحمد بن جبير الكناني الأندلسي، أبو الحسين (المتوفى: 614هـ)</label><label>date: 0614</label><label>versionUri: 0614IbnJubayr.Rihla.Shamela0011203-ara1</label>
</div>
</div>
</div>
<a class="nav-link pull-right" href="#menu-toggle" id="menu-toggle" title="Book Chapters">
<i class="btn bi bi-list"></i></a>
</div>
</div>
</nav>
<div class="book-body fixed pt-5">
<div class="row">
<div class="col-12">
<div class="row top-heading-panel content-outer-spacing">
</div>
</div>
<div class="col-12" id="meta">
</div>
</div>
<div class="row justify-content-md-center" id="book-main">
<div class="col-lg-8 col-sm-12" id="content">
</div>
</div>
<div class="row mt-5" id="footer">
<div class="col-md-12">
            The KITAB project is based at the Institute for the Study of Muslim Civilizations (ISMC) at Aga Khan
            University, London, and has received funding from the European Research Council (ERC) under the European
            Union's
            Horizon 2020 research and innovation programme (Grant agreement No. 772989)

          </div>
<div class="col-md-12">
<img alt="Logos" height="50" id="logos" src="../img/AKU-EU-ERC-three-logos.jpg"/>
</div>
</div>
</div>
</div>
</div>
<script>

    var pageSel = document.getElementById("page-select");
    var volSel = document.getElementById("vol-select");
    var thisVolume = "01";
    var volPages = {"01": ["000", "007", "008", "009", "010", "011", "012", "012", "013", "014", "014", "014", "015", "015", "016", "017", "018", "019", "019", "020", "021", "021", "022", "022", "022", "023", "024", "025", "025", "026", "026", "027", "027", "028", "028", "029", "029", "030", "030", "031", "032", "033", "034", "035", "035", "036", "037", "038", "038", "039", "039", "039", "040", "041", "041", "042", "043", "044", "044", "045", "045", "046", "046", "047", "048", "048", "049", "049", "050", "051", "051", "052", "053", "054", "054", "055", "055", "056", "056", "057", "057", "058", "059", "059", "060", "061", "062", "063", "064", "065", "066", "067", "068", "069", "070", "071", "072", "073", "074", "075", "076", "077", "078", "079", "080", "081", "082", "083", "084", "085", "086", "087", "088", "089", "090", "091", "091", "092", "093", "094", "095", "096", "096", "097", "098", "099", "100", "101", "101", "102", "102", "103", "104", "104", "105", "106", "106", "106", "107", "108", "109", "110", "110", "111", "112", "113", "113", "114", "114", "115", "115", "116", "116", "117", "117", "118", "119", "119", "120", "121", "122", "123", "124", "125", "126", "127", "127", "128", "129", "130", "131", "132", "133", "133", "134", "134", "135", "135", "136", "137", "138", "139", "140", "140", "141", "142", "143", "144", "145", "145", "146", "147", "148", "149", "150", "151", "151", "152", "153", "153", "154", "155", "155", "156", "156", "157", "157", "158", "158", "159", "160", "160", "160", "161", "162", "163", "164", "165", "166", "166", "167", "168", "168", "169", "170", "171", "172", "173", "173", "174", "175", "176", "177", "177", "178", "179", "180", "181", "181", "182", "183", "184", "185", "186", "187", "187", "188", "189", "189", "190", "190", "191", "192", "193", "193", "194", "195", "195", "196", "197", "198", "199", "200", "201", "202", "202", "203", "204", "204", "205", "205", "206", "207", "208", "208", "209", "210", "210", "211", "212", "212", "213", "214", "214", "215", "216", "217", "217", "218", "219", "219", "220", "221", "222", "223", "223", "224", "224", "225", "225", "226", "227", "228", "229", "230", "231", "231", "232", "233", "234", "234", "234", "235", "235", "236", "236", "237", "238", "239", "240", "241", "242", "243", "244", "245", "246", "246", "247", "248", "249", "250", "251", "252", "253", "254", "254", "255", "256", "257", "258", "259", "259", "260", "260", "261", "261", "262", "263", "264", "264", "265", "266", "267", "267", "268", "269", "270", "271", "271", "271", "272", "273", "273", "274", "275", "276", "276", "277", "277", "278", "278", "279", "279", "280", "280", "281", "281", "282", "283", "283", "284", "285", "286", "286", "287", "288", "289", "290", "291", "292", "292", "293", "293", "294", "295", "296", "296", "297", "297", "297", "298", "298", "299", "300", "300", "301", "301", "302", "302", "303", "304", "305", "306", "306", "307", "308", "308", "309", "309", "310", "311", "312", "313", "313", "314", "315", "316", "316", "317", "318", "318", "319", "320"]}; /*loaded by html_builder*/

    function goToAnchor(vol, anchorId) {
      if (vol != window.thisVolume) {
        loadVolume(vol, false).then(res => {
          console.log("Volume loaded");
          console.log("Go to anchor " + anchorId);
          /*move the volume page to the element with id=anchorId*/
          /*var targetAnchor = document.getElementById(anchorId);
          targetAnchor.scrollIntoView({block: 'nearest'});  // this does not always work...
          console.log(targetAnchor);*/
          /*window.location.hash = "";
          window.location.hash = anchorId;
          window.location.hash = anchorId;
          console.log("#"+anchorId);*/
          /*//This approach does not work at all: scrolls only main window.
          var targetAnchor = $("#"+anchorId);
          //$("#content").animate(
          $("html, body").animate(
            {scrollTop: targetAnchor.offset().top},
            1000
          );*/
          /*//This approach does not work at all: scrolls only main window.
          var targetAnchor = document.getElementById(anchorId);
          var rect = targetAnchor.getBoundingClientRect();
          console.log(targetAnchor);
          console.log(rect);
          var viewHeight=Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
          window.scroll({
            top: rect.top + rect.height / 2 - viewHeight /2,
            behavior: 'smooth'
          });*/
          /*var targetAnchor = document.getElementById(anchorId);
          var contentDiv = document.getElementsByClassName("book-body")[0];
          var topPos = contentDiv.offsetTop;
          var windowSize = $(window).height();
          console.log("topPos: " + topPos);
          console.log("targetPos: " + targetAnchor.offsetTop);
          console.log("windowSize:" + windowSize)
          console.log("targetAnchor.offsetTop-windowSize/3 = " + (targetAnchor.offsetTop - topPos - windowSize / 2));
          contentDiv.scrollTop = targetAnchor.offsetTop - topPos - windowSize / 2;*/
          var targetAnchor = document.getElementById(anchorId);
          targetAnchor.scrollIntoView({"block": "start"});
        });
      } else {
        /*move the volume page to the element with id=anchorId*/
        /*var targetAnchor = document.getElementById(anchorId);
        targetAnchor.scrollIntoView({block: 'nearest'});  // this does not always work...
        console.log(targetAnchor);*/
        /*window.location.hash = "";
        window.location.hash = anchorId;
        window.location.hash = anchorId;
        console.log("#"+anchorId);*/
        /*//This approach does not work at all: scrolls only main window.
        var targetAnchor = $("#"+anchorId);
        //$("#content").animate(
        $("html, body").animate(
          {scrollTop: targetAnchor.offset().top},
          1000
        );*/
        /*//This approach does not work at all: scrolls only main window.
        var targetAnchor = document.getElementById(anchorId);
        var rect = targetAnchor.getBoundingClientRect();
        console.log(targetAnchor);
        console.log(rect);
        var viewHeight=Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
        window.scroll({
          top: rect.top + rect.height / 2 - viewHeight /2,
          behavior: 'smooth'
        });*/
        /*var targetAnchor = document.getElementById(anchorId);
        var contentDiv = document.getElementsByClassName("book-body")[0];
        var topPos = contentDiv.offsetTop;
        var windowSize = $(window).height();
        console.log("topPos: " + topPos);
        console.log("targetPos: " + targetAnchor.offsetTop);
        console.log("windowSize:" + windowSize)
        console.log("targetAnchor.offsetTop-windowSize/3 = " + (targetAnchor.offsetTop - topPos - windowSize / 2));
        contentDiv.scrollTop = targetAnchor.offsetTop - topPos - windowSize / 2;*/
        var targetAnchor = document.getElementById(anchorId);
        targetAnchor.scrollIntoView({"block": "start"});
      }
    }

    CollapsibleLists.apply();
    console.log("Applied CollapsibleLists");

    $(document).ready(function () {
      console.log("Load initial volume " + thisVolume);
      loadVolume(thisVolume).then(res => {
        console.log("Initial volume loaded");
        $('#loading').hide();
        $('#loading').fadeOut("slow");
      });
      $(window).scroll(function () {
        if ($(this).scrollTop() > 50) {
          $('#back-to-top').fadeIn();
        } else {
          $('#back-to-top').fadeOut();
        }
      });
      // scroll body to 0px on click
      $('#back-to-top').click(function () {
        $('body,html').animate({
          scrollTop: 0
        }, 400);
        return false;
      });
      $("#menu-toggle").click(function (e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled");
      });

      $(".font-default").click(function () {

        $('#wrapper').toggleClass("font-increase", "font-default");
      });

      $(".bi-lightbulb-off").click(function () {
        $('.bi-lightbulb-off').toggleClass("bi-lightbulb", "bi-lightbulb-off");
        $('.page-wrapper').toggleClass("night-mode", "");
        $('.navbar-light').toggleClass("night-mode", "");
        console.log(this);

      });
      $('.toc-item').click(function (event) {
        /*console.log('toc item clicked');*/
        event.preventDefault();
        var clickedElement = event.target;
        /*console.log(clickedElement);*/
        var href = clickedElement.getAttribute("href");
        /*console.log('href: '+href);*/
        var vol = href.substring(0, 2);
        var head = href.split('head').pop();
        var anchorId = "head" + head;
        goToAnchor(vol, anchorId);
        return false;
      });
    });

    function loadPageNumbers(vol, page) {
      /*var pageSel = document.getElementById("page-select");*/
      pageSel.innerHTML = '';
      volPages[vol].forEach(function (p, index) {
        pageSel.options[pageSel.options.length] = new Option(p, p);
      });
      if (page) {
        pageSel.value = page;
      }
    }

    function loadVolumeNumbers(vol) {
      /*var volSel = document.getElementById("vol-select");*/
      volSel.innerHTML = '';
      /*console.log(Object.keys(volPages));*/
      /*console.log(Object.keys(volPages).sort());*/

      Object.keys(volPages).sort().forEach(function (v, index) {
        /*console.log(v);*/
        volSel.options[volSel.options.length] = new Option(v, v);
      });
      volSel.value = vol;
    }

    async function loadVolume(vol) {
      /*Load volume json */
      var page = pageSel.value;
      $('#loading').show();
      console.log("loading volume " + vol);
      await $.getJSON(vol + ".json", function (json) {
        console.log(json)
        $('#content').empty().append(json["content"]);
        /*console.log("json loaded");*/
        window.thisVolume = vol;
        $('#loading').hide();
        $('#loading').fadeOut("slow");
        /*Load volume and page numbers in page-nav form:*/
        loadVolumeNumbers(vol);
        loadPageNumbers(vol, page);
        return true;
      });
    }


    function padWithZeros(number, width) {
      number = number + "";
      if (number.length >= width) {
        return number;
      } else {
        return new Array(width - number.length + 1).join("0") + number;
      }
    }
    document.getElementById("nav-form").addEventListener("submit", function (event) {
      event.preventDefault();
      /*console.log("Clicked Go");*/
      var vol = volSel.value;
      console.log("vol: " + vol);
      /*var targetPage = parseInt(pageSel.value, 10);
      if (page >= 1) {
        page = page-1; //page number is at bottom of page
      }
      var anchor = "v"+vol+"p"+padWithZeros(targetPage, 3);*/
      var targetPage = pageSel.value;
      var pages = volPages[vol];
      var index = pages.indexOf(targetPage);
      if (index > 0) {
        targetPage = pages[index-1];
      }

      console.log("targetPage: " + targetPage);
      var anchor = "v" + vol + "p" + targetPage;
      goToAnchor(vol, anchor);
      return false;
    });

    /*Adapt the page numbers list when the volume number changes:*/
    volSel.addEventListener("change", function (event) {
      var vol = this.value;
      var page = pageSel.value;
      loadPageNumbers(vol, page);
    });


  </script>
</body>
</html>
